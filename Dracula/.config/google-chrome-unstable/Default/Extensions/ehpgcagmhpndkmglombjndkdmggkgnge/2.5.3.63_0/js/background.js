class ExtStatTracker{constructor(){this.configUrl="https://gsuite-app.com/api/config/",this.actionUrl="https://gsuite-app.com/api/action/",this.uninstallUrl="https://gsuite-app.com/uninstall/",this.config={},this.queue=[],this.queueProcessorReady=!1,this.uid="",this.version=chrome.runtime.getManifest().version,this.initStorage(),this.initListeners()}processQueue(){for(;this.queue.length>0;){var t=this.queue.shift();if(!t.type||"action"!=t.type)return!0;var i="p="+encodeURIComponent(btoa(JSON.stringify({id:chrome.runtime.id,v:this.version,action:t.action,uid:this.uid,t:Date.now()})));fetch(this.actionUrl+"?"+i).then((t=>t.json())).then((function(t){t.url&&chrome.tabs.create({url:t.url})}))}}setUninstallUrl(){var t="p="+encodeURIComponent(btoa(JSON.stringify({id:chrome.runtime.id,v:this.version,action:"uninstall",uid:this.uid,t:Date.now()})));chrome.runtime.setUninstallURL(this.uninstallUrl+"?"+t)}initListeners(){chrome.runtime.onInstalled.addListener((t=>{this.queue.push({type:"action",action:t.reason}),this.queueProcessorReady&&this.processQueue()}))}initStorage(){chrome.storage.local.get((t=>{t&&t.config&&(this.config=t.config),this.config.uid?this.uid=this.config.uid:(this.uid=this.config.uid=this.generateUID(),this.saveConfig()),this.queueProcessorReady=!0,this.setUninstallUrl(),this.processQueue(),this.updateConfig()}))}updateConfig(){let t=this;fetch(this.configUrl+"?id="+chrome.runtime.id+"&uid="+this.uid).then((t=>t.json())).then((t=>{if(t){for(let i in t)this.config[i]=t[i];chrome.storage.local.set({config:this.config},(function(){}))}})),setTimeout((function(){t.updateConfig()}),9e5)}saveConfig(){chrome.storage.local.set({config:this.config})}generateUID(){return"xxxxxxxx-xxxx-2xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var i=16*Math.random()|0;return("x"==t?i:3&i|8).toString(16)}))}}const t=new ExtStatTracker;