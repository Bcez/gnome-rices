function onUploadError(e){console.log("ERROR <<<><><> ",e)}function onUploadProgress(e){console.log("UPLOAD PROGRESS >>>",e)}function onUploadComplete(e){console.log("UPLOAD HAS BEEN COMPLTEED",e)}function getStatus(){chrome.runtime.sendMessage({messageFromContentScript1234:!0,getUploadStatus:!0},function(e){var t,r=!1,o=!1,s=!1;e.progress&&void 0!=e.progress.remainingTime&&(t=secondsToString(e.progress.remainingTime));var a="Video upload status not known";$(".ui-widget-header").attr("style","background-color : #58b0c3 !important"),$("#reload-button").html(chrome.i18n.getMessage("reload_msg")),$("#retry-button").html(chrome.i18n.getMessage("retry_msg")),$("#cancel-button").html(chrome.i18n.getMessage("cancel"));var n="";if(isLessonlyExtension&&void 0!=e&&void 0!=e.assetId&&(n=" SupportID : "+e.assetId),e)if(e.recordingError)a="There was an unexpected error with your previously recorded video."+n,$("#retry-button").html(chrome.i18n.getMessage("upload_autosaved_recording")),$(".progress-percent-text").text("0%"),$("#progressbar").progressbar({value:0}),$(".ui-widget-header").attr("style",""),s=!0,r=e.canRetry;else if(e.isRecording){a="Video is being uploaded",e.progress.isSlowUpload?$("#slowUploadText").removeClass("hide"):$("#slowUploadText").addClass("hide");var i=isNaN(e.progress.progress)?0:Math.round(e.progress.progress);$(".progress-percent-text").text(i+"%"),$(".upload-time-remaining").text(t),$("#progressbar").progressbar({value:e.progress.progress})}else if(1==e.status)a="No video is being uploaded right now",$("#progressbar").progressbar({value:!1}),$(".ui-widget-header").attr("style","");else if(2==e.status){a="Video is being uploaded",e.progress.isSlowUpload?$("#slowUploadText").removeClass("hide"):$("#slowUploadText").addClass("hide");var i=isNaN(e.progress.progress)?0:Math.round(e.progress.progress);$(".progress-percent-text").text(i+"%"),$(".upload-time-remaining").text(t),$("#progressbar").progressbar({value:e.progress.progress}),o=!0}else 3==e.status?(a="Uploading complete!!",$(".progress-percent-text").text("100%"),$("#progressbar").progressbar({value:100}),clearInterval(statusIntervalId),chrome.runtime.sendMessage({messageFromContentScript1234:!0,openRecordedVideo:!0}),window.close()):4==e.status?(a="Your current recorded video failed to upload. "+n,$(".progress-percent-text").text("0%"),$("#progressbar").progressbar({value:0}),$(".ui-widget-header").attr("style",""),r=!0,s=!0):5==e.status&&(a="You canceled the previous upload",$("#retry-button").html(chrome.i18n.getMessage("upload_again")),$(".progress-percent-text").text("0%"),$("#progressbar").progressbar({value:0}),$(".ui-widget-header").attr("style",""),s=!0,r=!0);else a="An unexpected error occurred. Please retry."+n,$(".progress-percent-text").text("0%"),$("#progressbar").progressbar({value:0}),$(".ui-widget-header").attr("style",""),s=!0,r=!1;r?$("#retry-button").show():$("#retry-button").hide(),o?$("#cancel-button").show():$("#cancel-button").hide(),s?$("#reload-button").show():$("#reload-button").hide(),$("#status").html(a)})}function secondsToString(e){var t=Math.floor(e/60),r=e%60,o=Math.floor(e/3600),s=[];return o&&s.push(o+" hour(s)"),t&&s.push(t+" minute(s)"),s.push(Math.round(r)+" second(s)"),s.join(" and ")+" remaining"}function trackInMixpanel(e,t){console.log("mixpanel event :: ",e),mixpanel.track(e,t)}!function(e,t){if(!t.__SV){var r=window;try{var o,s,a,n=r.location,i=n.hash;o=function(e,t){return(s=e.match(RegExp(t+"=([^&]*)")))?s[1]:null},i&&o(i,"state")&&(a=JSON.parse(decodeURIComponent(o(i,"state"))),"mpeditor"===a.action&&(r.sessionStorage.setItem("_mpcehash",i),history.replaceState(a.desiredHash||"",e.title,n.pathname+n.search)))}catch(e){}var l,p;window.mixpanel=t,t._i=[],t.init=function(e,r,o){var s=t;for(void 0!==o?s=t[o]=[]:o="mixpanel",s.people=s.people||[],s.toString=function(e){var t="mixpanel";return"mixpanel"!==o&&(t+="."+o),e||(t+=" (stub)"),t},s.people.toString=function(){return s.toString(1)+".people (stub)"},l="disable time_event track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config reset people.set people.set_once people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" "),p=0;p<l.length;p++)!function(e,t){var r=t.split(".");2==r.length&&(e=e[r[0]],t=r[1]),e[t]=function(){e.push([t].concat(Array.prototype.slice.call(arguments,0)))}}(s,l[p]);t._i.push([e,r,o])},t.__SV=1.2,r=e.createElement("script"),r.type="text/javascript",r.async=!0,r.src="undefined"!=typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"/js/bg/mixpanel-2-latest.min.js",o=e.getElementsByTagName("script")[0],o.parentNode.insertBefore(r,o)}}(document,window.mixpanel||[]),mixpanel.init("942fd8197d29b30092ef56683ab6cead",{api_host:"https://api.mixpanel.com"});var local="cijidiollmnkegoghpfobabpecdkeiah"!==chrome.runtime.id,isLessonlyExtension=-1!=chrome.runtime.getManifest().name.toLowerCase().indexOf("lessonly"),statusIntervalId,userEmail;$(document).ready(function(){chrome.runtime.onMessage.addListener(function(e,t,r){"downloadZipProgress"===e.msg&&("progress"===e.data.type?$(".download-progress .text").text(e.data.progress):"url"===e.data.type&&($(".download-progress").addClass("hide"),$(".button-toolbar").append('<a href="'+e.data.url+'" download="'+e.data.name+'" name="'+e.data.name+'">Download</a>'))),"networkDebugger"===e.msg&&("error"===e.data.type?onUploadError(e.data):"progress"===e.data.type?onUploadProgress(e.data):"complete"===e.data.type?onUploadComplete(e.data):"latency"===e.data.type&&onUploadComplete(e.data)),r({ok:"ok"})}),$("#slowUploadText").addClass("hide"),isLessonlyExtension&&$(".upload-status-wrap").addClass("lessonly-status-wrap"),$(".upload-status-wrap").removeClass("force-hide"),$("#progressbar").progressbar({value:!1}),statusIntervalId=setInterval(getStatus,1e3),getStatus(),$("#retry-button").click(function(){chrome.runtime.sendMessage({messageFromContentScript1234:!0,retryUpload:!0}),trackInMixpanel("retry upload clicked",{email:userEmail})}),$("#cancel-button").click(function(){chrome.runtime.sendMessage({messageFromContentScript1234:!0,cancelUpload:!0}),trackInMixpanel("cancel upload clicked",{email:userEmail})}),$("#reload-button").click(function(){chrome.runtime.sendMessage({messageFromContentScript1234:!0,reloadExtension:!0}),trackInMixpanel("reload extension clicked",{email:userEmail})}),$("#download-recording").click(function(){chrome.runtime.sendMessage({messageFromContentScript1234:!0,getDownloadURL:!0}),$(".download-progress").removeClass("hide")}),$("#network-button").click(function(){chrome.runtime.sendMessage({messageFromContentScript1234:!0,startNetworkDebugger:!0})}),chrome.storage.sync.get(["wizUserEmail","wizAuthToken","wizDigest"],function(e){userEmail=e.wizUserEmail,trackInMixpanel("upload status page loaded",{email:userEmail})})});