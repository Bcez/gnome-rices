var injectedAlready=document.getElementById("hippowiz-outreach-injected"),shareUrl,isRecording=!1,waitingForUrl=!1,guestUrl,recordingConfiguration,assetId,copyToClipboard=void 0,mergFieldMappings={address:"{{address_street2}}",city:"{{city}}",companyname:"{{company}}",companyindustry:"{{company_industry}}",companynaturalname:"{{company_natural}}",country:"{{country}}",degree:"{{degree}}",email:"{{email}}",facebookurl:"{{facebook}}",firstname:"{{first_name}}",gender:"{{gender}}",githuburl:"{{github}}",googleplusurl:"{{google_plus}}",graduationdate:"{{graduation_date}}",homephone:"{{home_phone}}",jobstartdate:"{{job_start_date}}",lastname:"{{last_name}}",linkedinurl:"{{linked_in}}",middlename:"{{middle_name}}",phonenumber:"{{mobile_phone}}",name:"{{name}}",nickname:"{{nickname}}",occupation:"{{occupation}}",otherphone:"{{other_phone}}",ownername:"{{owner}}",personalnote:"{{personal_note2}}",prospectstage:"{{stage}}",region:"{{region}}",school:"{{school}}",score:"{{score}}",stackoverflowurl:"{{stack_overflow}}",state:"{{state}}",title:"{{title}}",twitterurl:"{{twitter}}",voipphone:"{{voip_phone}}",website:"{{website3}}",workphone:"{{work_phone}}",zippostalcode:"{{address_zip}}"},HTML_CONTENT={hippo_button:"<div class='hv-embed-main-container' style='display:inline; position: relative;'> <button data-ref='hv-embed-main-container' data-type='record_and_library' class='toolbar-action-component toggle text-editor-extension hint--top hv-embed-main-icon' type='button'><img src='https://hippolms-wiz-static.s3.amazonaws.com/images/gmail_add_on/video-icon-orange.svg' height='24px' width='20px' style='margin-bottom: -5px; margin-right: -1px; width: 19px;'></button><span class='tooltiptext'>Hippo Video</span></div>"},REPORT_HTML={hippo_report_button:"<div class='hv-embed-main-container-report hv-integration-reports-button' style='display:inline;'> <button data-ref='hv-embed-main-container-report' data-type='record_and_library' class='hv-integration-reports hint--bottom' data-hint='Hippo Video: Reports and insights' type='button'><img src='"+chrome.extension.getURL("/images/injected/hv-integration-reports.svg")+"' height='24px' width='20px' style='margin-bottom: -5px;'> </button></div>"};if(!injectedAlready){var hippoCsInjected='<input type=hidden id="hippowiz-outreach-injected" value=true />',copyToClipboardBtn='<button class="copy-to-clipboard" data-clipboard-target="#copy-to-clipboard-btn" style="display:none;"></button>';$(hippoCsInjected).appendTo("body"),$(copyToClipboardBtn).appendTo("body");var injectToProspect=!1,port;console.log("injected outreach script"),$(document).ready(function(){function e(e){var t=document.getElementById(e);if(t&&t.getAttribute("value"))return t.getAttribute("value")}function t(){return{serviceName:g.serviceName,windowId:g.windowId,tabId:g.tabId}}function o(e,t){return $("#copyLinkWithThumbnailTarget").remove(),$("body").append('<div id="copyLinkWithThumbnailTarget" aria-hidden="true" tabindex="-1" >'+n(e,t)+"</div>"),document.querySelector("#copyLinkWithThumbnailTarget")}function n(e,t){return'<a href="'+e+'" target="_blank" tabindex="-1"><img src="'+t+'" alt="'+e+'" style="cursor: pointer;" width="360" height="200"></a><div style="padding-top: 7px;"><a href="'+e+'" target="_blank" tabindex="-1" style="cursor: pointer;">Watch Video</a></div><div><br></div>'}function a(){var e=t();e.messageFromContentScript1234=!0,e.messageType="outreach-dynamic",e.injectIframeHandler=!0,g.port.postMessage(e)}function i(){$(".header-component__right").prepend($(REPORT_HTML.hippo_report_button)),$(".hv-integration-reports").off("click").on("click",m)}function r(e){var t="<div class='nXR7WkUkDlVG_TxczKCKW _3-2GnY01sWrX2nfipf1tL0'>"+HTML_CONTENT.hippo_button+"</div>";0==$(e).parent().parent().find(".hv-embed-main-container").length&&($(e).parent().before($(t)),$(".hv-embed-main-icon").off("click"),$(".hv-embed-main-icon").on("click",c))}function d(e){var o=p(),n=t();n.messageFromContentScript1234=!0,n.initWorkflowPop=!0,n.msgType="workflow",n.payload={logPrefix:g.logPrefix,popType:"sales",popId:"hvOutreachPop",assetContent:{mfFormValues:{Email:o}},popConfig:{showEditOption:!0,showTemplatesOption:!1,showContactsOption:!1,showVideoPageLibrary:!0,addSalesUtmParams:!1,popReinitConditions:[],showMfForm:e,fetchMfInVideo:!0,mandatoryEmailMf:!0,insertVideoText:"COPY TO CLIPBOARD",showCustomizeComponent:!0,showTelePrompter:!0,showLandingPageComponent:!0,isMailFlow:e}},g.port.postMessage(n)}function s(e){var o=e.workflowConfig,n=t();n.messageFromContentScript1234=!0,n.messageType="outreach_dynamic",n.getUTMToken=!0,n.popId=o.popId,n.content=o,n.serviceName=g.serviceName,g.port.postMessage(n)}function c(e){if($("#hvOutreachPop").remove(),e){d(h(e.currentTarget))}else d()}function p(){var e="";return $(".contact.email").length>0&&(e=""==$(".contact.email").text()?"":$(".contact.email").text()),e}function l(e){var o="",n="";window.location.href.includes("outreach.io/prospects/")&&(o=""==$(".contact.email").text()?"":$(".contact.email").text(),n=""==$(".about h3").text()?"":$(".about h3").text());var a=t();a.messageFromContentScript1234=!0,a.initReportPop=!0,a.randomId=e,a.msgType="workflow",a.reportBtn="hv-integration-reports",a.contactEmail=o,a.contactName=n,a.payload={popId:"hvOutreachReportPop",logPrefix:g.logPrefix},g.port.postMessage(a)}function m(e){$("#hvOutreachReportPop").remove();var t=u();$(e.currentTarget).attr("data-random-id",t),$(".hv-integration-reports").attr("disabled",!0),l(t)}function u(){return Math.random().toString(36).substr(2,5)+Date.now()}function h(e){var t=!1;return $(e).parents(".dialog-content-component").length>0&&0==$('[data-pendo-id="slate-text-editor-preview"]').length&&(t=!0),t}var g=function(){var t={};return t.serviceName=e("hvIntegName"),t.windowId=Number(e("hvWindowId")),t.tabId=Number(e("hvTabId")),t.logPrefix=" OUTREACH_DYNAMIC :: ",t.port=chrome.extension.connect({name:t.serviceName+"::"+t.windowId+"::"+t.tabId}),t}();!function(){var e=t();e.messageFromContentScript1234=!0,e.injectHvWorkflowScripts=!0,g.port.postMessage(e)}(),g.port.onMessage.addListener(function(e,t,n){if(msgFromPort=e.backgroundRecordingMessage,"insertFromWorkflowPop"==msgFromPort&&e.data.serviceName==g.serviceName&&e.data.tabId==g.tabId&&s(e.data),"insertVideoInOutreachMailBox"==msgFromPort&&e.data.serviceName==g.serviceName&&e.data.tabId==g.tabId){var a=e.data.content.popConfig.isMailFlow,i=e.data.track_id,r=e.data.status,d=e.data.content.assetContent,c=d.videoShareUrl,p=d.thumbnailShareUrl;if(r&&null!=i&&a)c+=c.includes("?")?"&track_id="+i:"?track_id="+i,p+=p.includes("?")?"&track_id="+i:"?track_id="+i;else if(d.mfInVideo.length>0){var l="";if(d.mfInVideo.includes("email")||d.mfInVideo.includes("Email")||d.mfInVideo.push("Email"),a)for(var m=0;m<d.mfInVideo.length;m++)m>0&&(l+="&"),l+=d.mfInVideo[m]+"="+d.mfFormValues[d.mfInVideo[m]];else for(var m=0;m<d.mfInVideo.length;m++)mergFieldMappings.hasOwnProperty(d.mfInVideo[m].toLowerCase().replace(/[^a-zA-Z]/g,""))&&(m>0&&(l+="&"),l+=d.mfInVideo[m]+"="+mergFieldMappings[d.mfInVideo[m].toLowerCase().replace(/[^a-zA-Z]/g,"")]);""!=l&&(c+=c.includes("?")?"&"+l:"?"+l,p+=p.includes("?")?"&"+l:"?"+l)}else if(a)c+=c.includes("?")?"&Email="+$(".contact.email").text():"?Email="+$(".contact.email").text(),p+=p.includes("?")?"&Email="+$(".contact.email").text():"?Email="+$(".contact.email").text();else{var l="Email="+mergFieldMappings.email;c+=c.includes("?")?"&"+l:"?"+l,p+=p.includes("?")?"&"+l:"?"+l}copyToClipboard&&copyToClipboard.destroy(),jQuery(function(){jQuery(".copy-to-clipboard").click()}),copyToClipboard=new ClipboardJS(".copy-to-clipboard",{target:function(){return o(c,p)}}),copyToClipboard.on("success",function(e){$("#copyLinkWithThumbnailTarget").hide()}),$("#hvOutreachPop").remove()}}),window.addEventListener("message",function(e){e.data.type&&"hv_init_workflow_pop"==e.data.type&&c()}),MutationObserver=window.MutationObserver||window.WebKitMutationObserver,new MutationObserver(function(e,t){for(var o in e){var n=e[o],d=window.location.href;d.includes("/prospects/")&&0==$(".hv-embed-main-container-report").length&&i(),d.includes("/prospects/")||$(".hv-embed-main-container-report").remove(),$(n.target).hasClass("_1WX1K1jJl7MGK_kVN-wLhK")&&$(n.target).parent().parent().hasClass("_2kI-valCGIITo3shV-kKs5")&&r($(n.target)),"IFRAME"==$(n.target).children().prop("tagName")&&"Template"==$(n.target).children().attr("title")&&($("iframe").on("load",function(){a()}),a())}}).observe(document,{subtree:!0,childlist:!0,attributes:!0})})}