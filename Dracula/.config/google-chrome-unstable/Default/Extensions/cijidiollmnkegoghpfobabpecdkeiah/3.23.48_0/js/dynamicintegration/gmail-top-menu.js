document.getElementById("hippowiz-gmail-top-menu-injected")||($('<input type=hidden id="hippowiz-gmail-top-menu-injected" value=true />').appendTo("body"),$(document).ready(function(){function i(){$(".G-atb").css("z-index",1)}function t(i,t){N.port.postMessage({showGmailBannerAlert:!0,messageType:"gmail",integType:"gmail",scriptName:N.scriptName,payload:{windowId:N.hvWindowId,tabId:N.hvTabId,isError:t,message:i},messageFromContentScript1234:!0})}function n(){var i=$("div[hippo-user-profile-dom]"),t=$(i).find(".hippo-top-menu-container");0==$(t).length&&($(y.topMenu).prependTo($(i)),e(),o(),N.port.postMessage({getNotificationBatchCount:!0,messageType:"gmail",integType:"gmail",data:{notification_type:10},scriptName:N.scriptName,payload:{windowId:N.hvWindowId,tabId:N.hvTabId},messageFromContentScript1234:!0}))}function e(){var i={"hv-notification":{enter:"bell-icon-white.svg",leave:"bell-icon.svg"},gmailStatsIconWrapper:{enter:"reports-white.svg",leave:"reports-orange.svg"},vidCampReportsIconWrapper:{enter:"settings-white.svg",leave:"settings-orange.svg"}};C($("#hv-notification,#gmailStatsIconWrapper,#vidCampReportsIconWrapper"),"mouseenter",function(t){$(t.currentTarget).parent().css("background-color","#f47a58"),$(t.currentTarget).find("img").attr("src",chrome.extension.getURL("/images/injected/"+i[$(t.currentTarget).attr("id")].enter))}),C($("#hv-notification,#gmailStatsIconWrapper,#vidCampReportsIconWrapper"),"mouseleave",function(t){var n="hv-notification"==$(t.currentTarget).attr("id")&&0!==$(".recent-notifications-container").length&&$(".recent-notifications-container").is(":visible");n=n||"gmailStatsIconWrapper"==$(t.currentTarget).attr("id")&&0!==$("#hvEmailReports").length&&$("#hvEmailReports").is(":visible"),(n=n||"vidCampReportsIconWrapper"==$(t.currentTarget).attr("id")&&0!==$("#hvEmailSettings").length&&$("#hvEmailSettings").is(":visible"))||($(t.currentTarget).parent().css("background-color","#ffffff"),$(t.currentTarget).find("img").attr("src",chrome.extension.getURL("/images/injected/"+i[$(t.currentTarget).attr("id")].leave)))})}function o(){C($("#hvNotificationIconContainer"),"click",function(i){var t=$("#hvNotificationIconContainer").parent().find(".recent-notifications-container");$(t).length>0?($("#hvNotificationIconContainer").parent().find(".recent-notifications-container").remove(),$("#hvNotificationIconContainer").parent().find(".hv-notifications-right-arrow").remove()):g("fetchNotifications"),u(" Notifications Button Clicked")}),C($("#gmailStatsIconContainer"),"click",function(i){var t=$(i.target).attr("id");if(t&&("gmailStatsIconWrapper"==t||"gmailStatsIconContainer"==t||"gmailStatsIcon"==t)){$("#gmailStatsIconContainer").find("#hvEmailReports").is(":visible")?$("#gmailStatsIconContainer").find("#hvEmailReports").hide():g("showGmailReports")}u(" Email Reports Button Clicked")}),C($("#vidCampReportsIcon"),"click",function(i){var t=$(i.target).attr("id");if(t&&("vidCampReportsIconWrapper"==t||"vidCampReportsIcon"==t||"vidCampReportsIconImg"==t)){$("#vidCampReportsIcon").find("#hvVidCampReportsPop").is(":visible")?$("#vidCampReportsIcon").find("#hvVidCampReportsPop").hide():g("showCampaignReports")}u(" Settings Button Clicked")})}function a(){N.port.postMessage({showGmailReports:!0,messageType:"gmail",integType:"gmail",scriptName:N.scriptName,payload:{windowId:N.hvWindowId,tabId:N.hvTabId},messageFromContentScript1234:!0})}function s(){N.port.postMessage({showCampaignReports:!0,messageType:"gmail",integType:"gmail",scriptName:N.scriptName,payload:{windowId:N.hvWindowId,tabId:N.hvTabId},messageFromContentScript1234:!0})}function c(i){N.port.postMessage({fetchNotifications:!0,messageType:"gmail",integType:"gmail",data:{notification_type:10,from:parseInt(i),to:parseInt(i)+10-1},scriptName:N.scriptName,payload:{windowId:N.hvWindowId,tabId:N.hvTabId},messageFromContentScript1234:!0}),$("#view-notification-loader").show()}function r(i){if(10==i.notification.notification_type){var t=$("#hvNotificationIconContainer").parent().find(".hippo_notification_count");$(t).text(i.notification.type_count).removeClass("hide-button"),p()}}function d(i){if("success"==i.status&&parseInt(i.count)>0){var t=$("#hvNotificationIconContainer").find(".hippo_notification_count");$(t).text(i.count).removeClass("hide-button"),p()}}function p(){var i=$("#hvNotificationIconContainer");$(i).find(".hippo-notification-icon").addClass("ring-anim"),$(i).find(".hippo_notification_count").addClass("pop-anim"),setTimeout(function(){$(i).find(".hippo-notification-icon").removeClass("ring-anim"),$(i).find(".hippo_notification_count").removeClass("pop-anim")},5e3)}function l(i,t){i&&i.from&&1!=i.from?m(t.notifications.data,i.from):($(y.notificationsNotch).appendTo($("#hvNotificationIconContainer").parent()),$(y.notificationPop).appendTo($("#hvNotificationIconContainer").parent()),$(".recent-notifications-container").css("display","flex"),m(t.notifications.data,1)),t.notifications.unread_messages&&($("#hippo-notification-text").text("Notifications ("+t.notifications.unread_messages+")"),$("#hippo-notification-text").attr("unread_messages",t.notifications.unread_messages));var n=$("#hvNotificationIconContainer").find(".hippo_notification_count.notification-view");$(n).addClass("hide-button")}function m(i,t){if(i.length<10)$(".view-all-box").hide();else{var n=$("#view-all-notifications")[0],e=parseInt(t)+i.length;n.setAttribute("next_start",e.toString()),C($("#view-all-notifications"),"click",function(i){c($(i.currentTarget).attr("next_start"))})}for(var o in i){var a=i[o],s="";switch(a.type){case 0:s="<img class='thumb-pic notification-view' src='"+chrome.extension.getURL("/images/injected/hippo-wiz-tiny-icon.png")+"'>";break;case 1:s="<div class='initial-box notification-view'>"+a.user_name+"</div>";break;case 2:s="<img class='thumb-pic notification-view' src='"+chrome.extension.getURL("/images/injected/hippo-wiz-tiny-icon.png")+"'>";break;case 3:s="<img class='thumb-pic notification-view' src='"+chrome.extension.getURL("/images/injected/notification-views.svg")+"'>";break;case 4:s="<img class='thumb-pic notification-view' src='"+chrome.extension.getURL("/images/injected/notifications_export.svg")+"'>";break;case 5:s="<img class='thumb-pic notification-view' src='"+chrome.extension.getURL("/images/injected/notifications_reactions.svg")+"'>";break;default:s="<img class='thumb-pic notification-view' src='"+chrome.extension.getURL("/images/injected/hippo-wiz-tiny-icon.png")+"'>"}var r=0==a.viewed?"":"reed",d='<div class="notifications-video-list notification-view '+r+'" id="notification_video_id-'+a.notification_id+'"><a class="msg-inner-list notification-view" href="'+a.link+'"><div class="notification-list-box  notification-view '+a.type+'" id="notification_id-'+a.notification_id+'" notification_id="'+a.notification_id+'" notification_link="'+a.link+'">'+s+'<div class="msg-box notification-view"><p title="'+a.message+'">'+a.message+'</p></div><div class="time-box notification-view">'+a.created_at+"</div></div></a></div>";$(d).appendTo($("#recentNotificationList"))}$("#recentNotificationList").show(),1==parseInt(t)&&i.length<1&&($(".notification-empty").show(),$(".notifications-list-item").empty(),$(".view-all-box").hide()),C($(".notification-list-box"),"click",function(i){v(i)})}function v(i){var t=$(i.currentTarget).attr("notification_id");if(!$("#notification_video_id-"+t).hasClass("reed")){N.port.postMessage({markReadNotifications:!0,messageType:"gmail",integType:"gmail",scriptName:N.scriptName,data:{notification_id:t},payload:{windowId:N.hvWindowId,tabId:N.hvTabId},messageFromContentScript1234:!0}),$("#notification_video_id-"+t).addClass("reed");var n=$("#hippo-notification-text").attr("unread_messages");n&&($("#hippo-notification-text").text("Notifications ("+(parseInt(n)-1)+")"),$("#hippo-notification-text").attr("unread_messages",parseInt(n)-1))}f(i.currentTarget.attributes.notification_link.nodeValue)}function f(i){window.open(i,"_self")}function g(i,t,n){N.port.postMessage({checkAuthForGmail:!0,messageType:"gmail",integType:"gmail",scriptName:N.scriptName,payload:{sucessCallbackFnName:i,successCallbackFnParams:n,failureCallbackFnName:t,windowId:N.hvWindowId,tabId:N.hvTabId},messageFromContentScript1234:!0})}function h(i){N.port.postMessage({showSignUpPop:!0,messageType:"gmail",integType:"gmail",scriptName:N.scriptName,payload:{windowId:N.hvWindowId,tabId:N.hvTabId,authData:i},messageFromContentScript1234:!0})}function u(i){N.port.postMessage({trackDynamicIntegActivity:!0,integType:"gmail",scriptName:N.scriptName,actionName:i,payload:{tabId:N.hvTabId,windowId:N.hvWindowId},messageFromContentScript1234:!0})}function w(){I(T.refreshPage,!0,T.refresh)}function I(i,t,n,e){var o=$(y.gmailAlertMsgEle);$(o).find(".bAq").text(i),$(o).find("#hvGmailAlertActionBtn").text(n),$(o).find("#hvGmailAlertActionBtn").attr("is-refresh",t),$(o).find("#hvGmailAlertActionBtn").attr("link-url",e),$(".b8.UC .vh").empty().append($(o)),$(".b8.UC").addClass("bAp"),setTimeout(function(i){$(".b8.UC").removeClass("bAp")},1e4),$("#hvGmailAlertActionBtn").off("click").on("click",function(i){if("true"==$("#hvGmailAlertActionBtn").attr("is-refresh"))window.location.reload();else{var t=$("#hvGmailAlertActionBtn").attr("link-url");t&&window.open(t)}})}function b(i){"Extension context invalidated."==i.message?w():console.log(i)}function C(i,t,n){$(i).off(t).on(t,function(i){try{n(i)}catch(i){b(i)}})}var N=function(){var i={hvTabId:void 0,hvWindowId:void 0},t=document.getElementById("hvTabId"),n=document.getElementById("hvWindowId");return t&&t.getAttribute("value")&&(i.hvTabId=t.getAttribute("value")),n&&n.getAttribute("value")&&(i.hvWindowId=n.getAttribute("value")),i}();N.scriptName="gmail-top-menu",N.port=chrome.extension.connect({name:N.scriptName+":"+N.hvWindowId+":"+N.hvTabId});var T={notificationError:"Unable to fetch notifications.",somethingWentWrong:"Something went wrong!",refreshPage:"We've released cool new updates. Please reload the page to view them.",refresh:"REFRESH"};N.port.onMessage.addListener(function(e,o,p){e&&"showLiveNotifications"==e.backgroundRecordingMessage&&r(e.data);var m=e.data?e.data.payload||{}:{};m&&m.windowId==N.hvWindowId&&m.tabId==N.hvTabId&&("insertTopMenuInGmail"==e.backgroundRecordingMessage&&n(),e.data.scriptName==N.scriptName&&"gmailAuthCheckResponse"==e.backgroundRecordingMessage&&(e.data.status?"fetchNotifications"==m.sucessCallbackFnName?c(1):"showGmailReports"==m.sucessCallbackFnName?a():"showCampaignReports"==m.sucessCallbackFnName&&s():e.data.error?t(T.somethingWentWrong,!0):h(e.data.authData)),"fetchNotificationsResponse"==e.backgroundRecordingMessage&&(i(),e.data.status?(l(e.data.input,e.data.response),$("#view-notification-loader").hide()):($("#view-notification-loader").hide(),t(T.notificationError,!0))),"notificationBatchCountResponse"==e.backgroundRecordingMessage&&e.data.status&&d(e.data.response))});var y={topMenu:'<div class="hippo-top-menu-container"><table><tr><td class="notifications-td" id="hvNotificationIconContainer"><div id="hv-notification" class="hippo-notifications-container notification-view"><sup class="hippo_notification_count hide-button notification-view">5</sup><img id="hv-notification-icon" class="hippo-notification-icon notification-view"  data-tooltip="Hippo Video Notifications" src="'+chrome.extension.getURL("/images/injected/bell-icon.svg")+'"></div></td><td id="gmailStatsIconContainer" class="gmail-stats-icon-container"><div data-tooltip="Email Reports" id="gmailStatsIconWrapper" class="gmail-stats-icon-wrapper"><img id="gmailStatsIcon" class="gmail-stats-icon" src="'+chrome.extension.getURL("/images/injected/reports-orange.svg")+'"></div></td><td id="vidCampReportsIcon" class="hv-camp-reports-icon-td"><div  data-tooltip="Settings" id="vidCampReportsIconWrapper" class="vid-camp-reports-icon-wrapper"><img id="vidCampReportsIconImg" class="vid-camp-reports-icon-img" src="'+chrome.extension.getURL("/images/injected/settings-orange.svg")+'"></div></td></tr></table></div>',notificationsNotch:'<img class="hv-notifications-right-arrow notification-view" src="'+chrome.runtime.getURL("/images/injected/drop-down-arrow-orange.svg")+'">',notificationPop:'<div class="recent-notifications-container notification-view"><div id="hippo-notification-menu" class="notificatio-menu notification-view"><h5 id="hippo-notification-text" class="notification-view">Notifications</h5></div><div class="notification-empty notification-view" hidden><center><img class="notification-view" src="'+chrome.extension.getURL("/images/injected/notification-empty-bell.svg")+'" width="320"></center><h4 class="notification-view">Check back again for recent video activities.</h4></div><div class="msg-list-box notification-view"><div id="recentNotificationList" class="notification-view"></div></div><div class="view-notification-loader" id="view-notification-loader"><div class="bar-loading"><div></div><div></div><div></div><div></div></div></div><div class="view-all-box notification-view"><span id="view-all-notifications" class="notification-view"><h3 class="notification-view">View More Notifications</h3></span></div></div>',gmailAlertMsgEle:'<span class="aT"><span class="bAq"></span><span class="bAo">&nbsp;&nbsp;<span class="ag a8k" id="hvGmailAlertActionBtn" tabindex="0" role="link"></span></span></span>'}}));