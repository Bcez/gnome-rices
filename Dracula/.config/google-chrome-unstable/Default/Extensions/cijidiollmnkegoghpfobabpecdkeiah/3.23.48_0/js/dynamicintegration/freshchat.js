var injectedAlready=document.getElementById("hippowiz-freshchat-dynamic-injected"),HTML_CONTENT={hippo_button:"<div class='hv-embed-main-container'><button id='hippo_video_button' class='hv-embed-main-icon' type='button'><img src='https://hippolms-wiz-static.s3.amazonaws.com/images/gmail_add_on/video-icon-orange.svg' class='icon_image'  height='24px' width='22px' > </button><span class='tooltiptext'>Hippo Video</span></div>"};if(!injectedAlready){var hippoCsInjected='<input type=hidden id="hippowiz-freshchat-dynamic-injected" value=true />';$(hippoCsInjected).appendTo("body"),console.log("injected freshchat-dynamic script"),$(document).ready(function(){function e(e){var t=document.getElementById(e);if(t&&t.getAttribute("value"))return t.getAttribute("value")}function t(){return{serviceName:p.serviceName,windowId:p.windowId,tabId:p.tabId}}function n(e,t){if(e.fireEvent)e.fireEvent("on"+t);else{var n=document.createEvent("Events");n.initEvent(t,!0,!1),e.dispatchEvent(n)}}function o(e){var t=e.track_id,n=e.content.assetContent.videoShareUrl,o=e.content.assetContent.thumbnailShareUrl;if(e.status)n+=n.includes("?")?"&track_id="+t:"?track_id="+t,o+=o.includes("?")?"&track_id="+t:"?track_id="+t;else{var i=e.content.assetContent.mfInVideo,a=e.content.assetContent.mfFormValues;if(i.includes("Email")||i.push("Email"),i.includes("First Name")||i.push("First Name"),i.length>0){for(var r="",s=0;s<i.length;s++)r+=encodeURIComponent(i[s])+"="+encodeURIComponent(a[i[s]]),r+=s<i.length-1?"&":"";""!=r&&(n+=n.includes("?")?"&"+r:"?"+r,o+=o.includes("?")?"&"+r:"?"+r)}}return n+=n.includes("?")?"&_="+Date.now():"?_="+Date.now()}function i(e){var n=t();n.messageFromContentScript1234=!0,n.msgType="workflow",n.payload={playUrl:e},n.urlToBeShortened=e,n.fetchShortenUrl=!0,p.port.postMessage(n)}function a(e){r("<p>"+e+"</p><p><br></p>"),$("#hvFreshchatPop").remove()}function r(e){$(".medium-editor-element").length>0&&($(".medium-editor-element").append(e),n($(".medium-editor-element")[0],"focus"),n($(".medium-editor-element")[0],"keydown"),n($(".medium-editor-element")[0],"keyup"),n($(".send-actions-container")[0],"click"))}function s(e){0==$(e.target).find(".hv-embed-main-container").length&&($(HTML_CONTENT.hippo_button).appendTo($(e.target).find($(".send-actions-container"))),$(".hv-embed-main-icon").off("click").on("click",m))}function d(){var e=$(".user-basic-info").find(".email-field").text().trim(),n=$(".user-info").find(".user-name ").text().trim(),o=t();o.messageFromContentScript1234=!0,o.initWorkflowPop=!0,o.msgType="workflow",o.payload={logPrefix:p.logPrefix,popType:"sales",popId:"hvFreshchatPop",assetContent:{mfFormValues:{Email:e,"First Name":n}},popConfig:{showEditOption:!0,showTemplatesOption:!1,showContactsOption:!1,showVideoPageLibrary:!0,addSalesUtmParams:!1,popReinitConditions:[],showMfForm:!0,fetchMfInVideo:!0,mandatoryEmailMf:!1,showCustomizeComponent:!0,showLandingPageComponent:!0,showTelePrompter:!0}},p.port.postMessage(o)}function c(e){var n=e.workflowConfig,o=t();o.messageFromContentScript1234=!0,o.messageType="freshchat_dynamic",o.getUTMToken=!0,o.popId=n.popId,o.content=n,o.serviceName=p.serviceName,p.port.postMessage(o)}function m(e){$("#hvFreshchatPop").remove(),d()}var p=function(){var t={};return t.serviceName=e("hvIntegName"),t.windowId=Number(e("hvWindowId")),t.tabId=Number(e("hvTabId")),t.logPrefix=" FRESHCHAT_DYNAMIC :: ",t.port=chrome.extension.connect({name:t.serviceName+"::"+t.windowId+"::"+t.tabId}),t}();!function(){var e=t();e.messageFromContentScript1234=!0,e.injectHvWorkflowScripts=!0,p.port.postMessage(e)}(),p.port.onMessage.addListener(function(e,t,n){if(msgFromPort=e.backgroundRecordingMessage,"insertFromWorkflowPop"==msgFromPort&&e.data.serviceName==p.serviceName&&e.data.tabId==p.tabId&&c(e.data),"insertVideoInFreshchatChatBox"==msgFromPort&&e.data.serviceName==p.serviceName&&e.data.tabId==p.tabId){i(o(e.data))}"fetchShortenUrlResponse"==msgFromPort&&e.data.serviceName==p.serviceName&&e.data.tabId==p.tabId&&a(e.data.shortenUrl)}),MutationObserver=window.MutationObserver||window.WebKitMutationObserver,new MutationObserver(function(e,t){for(var n in e){var o=e[n];$(o.target).hasClass("chat-actions")&&s(o)}}).observe(document,{subtree:!0,childlist:!0,attributes:!0})})}