var injectedAlready=document.getElementById("hv-workflow-teleprompter-injected");if(!injectedAlready){var teleprompterInjected='<input type=hidden id="hv-workflow-teleprompter-injected" value=true />';$(teleprompterInjected).appendTo("body");var isTelepromperRenderd=!1,isTelepromperFetched=!1,wasUnsignedUser=!1,mergeFieldMapping={"Prospect Name":"Prospect Name","Prospect Email":"Prospect Email","Prospect Company Name":"Prospect Company Name","Lead Name":"Lead Name","Lead Email":"Lead Email","Lead Company Name":"Lead Company Name"},all_scripts_container=null,my_scripts_container=null,shared_scripts_container=null,script_default_config={lineHeight:1,fontSize:20,speed:50,maxLineHeight:5,minLineHeight:1,maxFontSize:40,minFontSize:20},scrollTimerDown=null,promptTop=null,nextStep=1,promptCompleted=!1,promptTop=null,promptHeight=null,scriptSelected=!1,lastLineHeight=60,scrollTimeout=script_default_config.speed,promptStarted=!1,isAllowedToShow=!1,isRecording=!1,script_current_config=null;$(document).ready(function(){function e(e){var t=document.getElementById(e);if(t&&t.getAttribute("value"))return t.getAttribute("value")}function t(){return{serviceName:L.serviceName,windowId:L.windowId,tabId:L.tabId,screenName:L.screenName}}function i(){scrollTimerDown=null,promptTop=null,nextStep=1,promptCompleted=!1,promptheight=null,promptTop=null,scriptSelected=!1,lastLineHeight=60,isTelepromperRenderd=!1,isAllowedToShow=!1,isRecording=!1,script_current_config=null,T(),$("#hv-dyna-video-crompter-container").addClass("hide")}function r(e,t){return e.replace("{id}",t)}function n(){if(isRecording&&isAllowedToShow&&scriptSelected){var e=r(N.teleprompter_template,"hv-dyna-video-recording-container");$(e).insertBefore("#hv-iframe-wrapper"),function(){$("#teleprompterOnRecord").text(d($("#teleprompterId").text())),$("#teleprompterOnRecord").css({"line-height":script_current_config.lineHeight,"font-size":script_current_config.fontSize+"px"})}(),S(!0)}}function o(){try{return document.getElementById("hvTeleprompterBtn").dataset.logPrefix}catch(e){}return""}function s(e){if(e.workflowConfig.popConfig.showTelePrompter){if(0==$("#hvTeleprompterBtn").length){var t=document.createElement("div");t.id="hvTeleprompterBtn",t.classList.add("gradient-btn"),t.dataset.popID=e.popId,t.dataset.logPrefix=e.workflowConfig.logPrefix;var i=document.createElement("span");i.innerText="ENABLE TELEPROMPTER",t.appendChild(i),t.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),$("#hvTeleprompterBtn span").text(isTelepromperRenderd?"ENABLE TELEPROMPTER":"DISABLE TELEPROMPTER"),p()}),$(t).insertBefore("#hvStartWebcamRecBtn"),$(".hv-create-video-container .start-recording-btn").addClass("teleprompter-btn-added")}else $("#hvTeleprompterBtn").show(),$("#hvTeleprompterBtn span").text("ENABLE TELEPROMPTER"),$(".hv-create-video-container .start-recording-btn").addClass("teleprompter-btn-added");window.addEventListener("keyup",a)}isTelepromperFetched||(P(),isTelepromperFetched=!isTelepromperFetched)}function a(e){32==e.which&&0==promptCompleted&&(promptStarted?(isRecording?$("#telepromterColumnContainerOnRecord").removeClass("disable-teleprompt-scroll"):($("#teleprompterId").attr("contenteditable","true"),$("#promptPropertiesId .font-size").removeClass("disable-teleprompt-options"),$("#promptPropertiesId .linespace-container").removeClass("disable-teleprompt-options"),$("#promptPropertiesId .font-size").removeClass("show-tooltip"),$("#promptPropertiesId .linespace-container").removeClass("show-tooltip"),$("#telepromterColumnContainer").removeClass("disable-teleprompt-scroll")),C(isRecording),promptStarted=!1,promptCompleted=!1):(b(isRecording),promptStarted=!0,isRecording&&$("#telepromterColumnContainerOnRecord").addClass("disable-teleprompt-scroll")))}function p(){if(isTelepromperRenderd)scriptSelected=!1,$("#hv-dyna-video-crompter-container").addClass("hide");else{0==$("#hv-dyna-video-crompter-container").length&&($(".record-preview-screen .left-container").append(N.wrapper_template),shared_scripts_container&&$("#sharedScripts").replaceWith($(shared_scripts_container)),my_scripts_container&&$("#myVideoScripts").replaceWith($(my_scripts_container)),all_scripts_container&&$("#allVideoScripts").replaceWith($(all_scripts_container)),delete shared_scripts_container,delete my_scripts_container,delete all_scripts_container,v()),$("#hv-dyna-video-crompter-container").removeClass("hide");try{var e=new Event("click");if($("#avs")[0].dispatchEvent(e),wasUnsignedUser){wasUnsignedUser=!1;var e=new Event("click");$("#refreshPrompterPages")[0].dispatchEvent(e)}}catch(e){}}isTelepromperRenderd=!isTelepromperRenderd,R({action:o()+(isTelepromperRenderd?" Enabled Video Script":" Disabled Video Script")})}function c(e){$("#hv-dyna-video-crompter-container").addClass("hide"),isAllowedToShow=!e.screenRecord}function l(e){try{$(" #hv-dyna-video-crompter-container #refreshPrompterPages").removeClass("refreshing")}catch(e){}var t=e.user_profile||{},i=t.userFirstName||"",r=t.userLastName||"",n=(i+" "+r).trim();mergeFieldMapping={"Lead Name":n,"Lead Email":t.orgUserEmail,"Lead Company Name":e.company_name},h(e)}function d(e){for(var t in mergeFieldMapping){var i=mergeFieldMapping[t];if(i){var r="\\${"+t+"}";e=e.replace(new RegExp(r,"g"),i)}}return e}function m(e){return document.getElementById(e)||function(e){var t=document.createElement("div");return t.id=e,t.classList.add("content"),t}(e)}function h(e){all_scripts_container=m("allVideoScripts"),my_scripts_container=m("myVideoScripts"),shared_scripts_container=m("sharedScripts"),$(shared_scripts_container).empty(),$(my_scripts_container).empty(),$(all_scripts_container).empty(),e.all_scripts.forEach(function(e){var t=document.createElement("div");t.id=e.id,t.dataset.text=e.script_text,t.dataset.visibilityType=e.visibility_type,t.innerText=e.title,t.classList.add("script-list"),all_scripts_container.appendChild(t),t.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),x(this.dataset)})}),e.my_scripts.forEach(function(e){var t=document.createElement("div");t.id=e.id,t.dataset.text=e.script_text,t.dataset.visibilityType=e.visibility_type,t.innerText=e.title,t.classList.add("script-list"),my_scripts_container.appendChild(t),t.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),x(this.dataset)})}),e.shared_scripts.forEach(function(e){var t=document.createElement("div");t.id=e.id,t.dataset.text=e.script_text,t.dataset.visibilityType=e.visibility_type,t.innerText=e.title,t.classList.add("script-list"),shared_scripts_container.appendChild(t),t.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),x(this.dataset)})}),0==e.all_scripts.length&&$(all_scripts_container).append('<div class="width-12 columns text-center vpr-empty-state">                 <img class="empty-state-img" src='+chrome.extension.getURL("/images/extension/teleprompter.svg")+' width="60">                 <h4>'+k.allScriptEmptyStateText+'</h4>                 <a class="button wiz-primary-btn addNewScriptFromPrompt">'+k.addNewScript+"</a>              </div>"),0==e.my_scripts.length&&$(my_scripts_container).append('<div class="width-12 columns text-center vpr-empty-state">                 <img class="empty-state-img" src='+chrome.extension.getURL("/images/extension/teleprompter.svg")+' width="60">                 <h4>'+k.myScriptEmptyStateText+'</h4>                 <a class="button wiz-primary-btn addNewScriptFromPrompt">'+k.addNewScript+"</a>              </div>"),0==e.shared_scripts.length&&$(shared_scripts_container).append('<div class="width-12 columns text-center vpr-empty-state">                 <img class="empty-state-img" src='+chrome.extension.getURL("/images/extension/teleprompter.svg")+' width="60">                 <h4>'+k.sharedEmptyStateText+'</h4>                 <a class="button wiz-primary-btn addNewScriptFromPrompt">'+k.addNewScript+"</a>              </div>")}function v(){function e(e){e.forEach(function(e){$("#"+e).hide()})}function t(e){e.forEach(function(e){$("#"+e).removeClass("active")})}var i={avs:"allVideoScripts",mvs:"myVideoScripts",svs:"sharedScripts"};["avs","mvs","svs"].forEach(function(r){$("#"+r).off("click").on("click",function(n){n.stopPropagation(),n.preventDefault(),e(Object.values(i)),t(Object.keys(i)),$("#"+i[r]).show(),$("#"+r).addClass("active")})}),$(".addNewScriptFromPrompt").off("click").on("click",function(e){e.stopPropagation(),e.preventDefault(),E()}),$("#changeScriptId").off("click").on("click",function(e){e.stopPropagation(),e.preventDefault(),T()}),$("#textSizeDecrease").off("click").on("click",function(e){e.stopPropagation(),e.preventDefault(),g(!1)}),$("#textSizeIncrease").off("click").on("click",function(e){e.stopPropagation(),e.preventDefault(),g(!0)}),$("#lineSpaceDecrease").off("click").on("click",function(e){e.stopPropagation(),e.preventDefault(),u(!1)}),$("#lineSpaceIncrease").off("click").on("click",function(e){e.stopPropagation(),e.preventDefault(),u(!0)}),$("#speedDecreaseId").off("click").on("click",function(e){e.stopPropagation(),e.preventDefault(),_("Decrease")}),$("#speedIncreaseId").off("click").on("click",function(e){e.stopPropagation(),e.preventDefault(),_("Increase")}),$("#refreshPrompterPages").off("click").on("click",function(e){e.stopPropagation(),e.preventDefault(),$(this).addClass("refreshing"),P()})}function u(e){function t(){script_current_config.lineHeight>=script_default_config.maxLineHeight?$("#lineSpaceIncrease").addClass("in-active"):$("#lineSpaceIncrease").removeClass("in-active"),script_current_config.lineHeight<=script_default_config.minLineHeight?$("#lineSpaceDecrease").addClass("in-active"):$("#lineSpaceDecrease").removeClass("in-active")}if(e&&script_current_config.lineHeight>=script_default_config.maxLineHeight||!e&&script_current_config.lineHeight<=script_default_config.minLineHeight)return void t();script_current_config.lineHeight=script_current_config.lineHeight+.5*(e?1:-1),$("#teleprompterId").css({"line-height":script_current_config.lineHeight}),t()}function g(e){function t(){script_current_config.fontSize>=script_default_config.maxFontSize?$("#textSizeIncrease").addClass("in-active"):$("#textSizeIncrease").removeClass("in-active"),script_current_config.fontSize<=script_default_config.minFontSize?$("#textSizeDecrease").addClass("in-active"):$("#textSizeDecrease").removeClass("in-active")}if(e&&script_current_config.fontSize>=script_default_config.maxFontSize||!e&&script_current_config.fontSize<=script_default_config.minFontSize)return void t();script_current_config.fontSize=script_current_config.fontSize+2*(e?1:-1),$("#teleprompterId").css({"font-size":script_current_config.fontSize+"px"}),t()}function f(){script_current_config.speed=scrollTimeout=10*~~($("#speedSliderId").attr("max")-$("#speedSliderId").attr("value")),S()}function _(e){var t,i,r=~~$("#speedSliderId").attr("min"),n=~~$("#speedSliderId").attr("max"),o=~~$("#speedSliderId").attr("value");if("Increase"==e){if(i=o+1,o>=n)return;t=o+1,$("#speedSliderId").attr("value",t).text(t),i>=n&&$(".slider-plus-container").addClass("in-active"),$(".slider-minus-container").removeClass("in-active"),f()}else if("Decrease"==e){if(i=o-1,o<=r)return;t=o-1,$("#speedSliderId").attr("value",t).text(t),i<=r&&$(".slider-minus-container").addClass("in-active"),$(".slider-plus-container").removeClass("in-active"),f()}else{var s=script_default_config.speed/10;$("#speedSliderId").attr("value",s).text(s),$(".slider-plus-container").removeClass("in-active"),$(".slider-minus-container").removeClass("in-active")}}function S(e){promptStarted=!0,promptCompleted=!1,w(e),b(e)}function w(e){C(e),e?$("#teleprompterOnRecordDiv").animate({top:0}):$("#teleprompterSiblingDiv").animate({top:0}),e?$("#telepromterColumnContainerOnRecord").scrollTop(0):$("#telepromterColumnContainer").scrollTop(0)}function C(e){if(scrollTimerDown){clearTimeout(scrollTimerDown);const t=~~promptTop-nextStep;var i=-1*t;(e?$("#teleprompterOnRecord").outerHeight()-89:$("#teleprompterId").outerHeight()-89)<=i&&(promptCompleted=!0)}}function y(e){promptheight=e?$("#teleprompterOnRecord").height():$("#teleprompterId").height(),promptTop=e?$("#teleprompterOnRecordDiv").css("top"):$("#teleprompterSiblingDiv").css("top");var t=e?$("#teleprompterOnRecord").outerHeight(!0):$("#teleprompterId").outerHeight(!0);$("#teleprompterOnRecordDiv").css("min-height",t),promptTop="auto"==promptTop?e?$("#teleprompterOnRecordDiv").position().top:$("#teleprompterSiblingDiv").position().top:~~promptTop.substr(0,promptTop.length-2)}function b(e){if(scriptSelected)if(y(e),~~promptTop>=-1*promptheight+lastLineHeight){e?$("#teleprompterOnRecordDiv").css("top",~~promptTop-nextStep):($("#promptPropertiesId .font-size").addClass("disable-teleprompt-options"),$("#promptPropertiesId .linespace-container").addClass("disable-teleprompt-options"),$("#promptPropertiesId .font-size").addClass("show-tooltip"),$("#promptPropertiesId .linespace-container").addClass("show-tooltip"),$("#telepromterColumnContainer").addClass("disable-teleprompt-scroll"),$("#teleprompterId").attr("contenteditable","false"),$("#teleprompterSiblingDiv").css("top",~~promptTop-nextStep));var t=-1*(parseInt(promptTop)-nextStep);setTimeout(function(){e?$("#telepromterColumnContainerOnRecord").scrollTop(t):$("#telepromterColumnContainer").scrollTop(t)},1),scrollTimerDown&&C(e),scrollTimerDown=setTimeout(function(){b(e)},scrollTimeout)}else e||($("#teleprompterId").attr("contenteditable","true"),$("#promptPropertiesId .font-size").removeClass("disable-teleprompt-options"),$("#promptPropertiesId .linespace-container").removeClass("disable-teleprompt-options"),$("#promptPropertiesId .font-size").removeClass("show-tooltip"),$("#promptPropertiesId .linespace-container").removeClass("show-tooltip"),$("#telepromterColumnContainer").removeClass("disable-teleprompt-scroll")),C(e)}function x(e){$("#teleprompterId").text(d(e.text)),$("#promptSettingsContainer").removeClass("hide"),$("#scriptTypesId").addClass("hide"),$("#scriptListId").addClass("hide"),function(){_(),scrollTimeout=script_default_config.speed,$("#teleprompterId").css({"line-height":script_default_config.lineHeight,"font-size":script_default_config.fontSize+"px"}),script_current_config=JSON.parse(JSON.stringify(script_default_config))}(),scriptSelected=!0,R({action:o()+" Video Script Selected"})}function T(){$("#promptSettingsContainer").addClass("hide"),$("#scriptTypesId").removeClass("hide"),$("#scriptListId").removeClass("hide"),R({action:o()+" Revoke Video Script Selection"}),scriptSelected=!1}function I(e){return e.screenName==L.screenName&&e.tabId==L.tabId&&e.windowId==L.windowId}function P(){var e=t();e.messageFromContentScript1234=!0,e.msgType="workflow",e.fetchTeleprompterData=!0,L.port.postMessage(e)}function E(){var e=t();e.messageFromContentScript1234=!0,e.openUrl=!0,e.url=D+"/settings/video-script",L.port.postMessage(e),R({action:o()+" Add New Video Script"})}function R(e){var i=t();i.msgType="workflow",i.messageFromContentScript1234=!0,i.trackAction=!0,i.actionPerformed=e.action,L.port.postMessage(i)}var L=function(){var t={};return t.serviceName=e("hvIntegName"),t.windowId=Number(e("hvWindowId")),t.tabId=Number(e("hvTabId")),t.screenName="hv-teleprompter",t.port=chrome.extension.connect({name:t.serviceName+"::"+t.windowId+"::"+t.tabId+"::"+t.screenName}),t}(),D="cijidiollmnkegoghpfobabpecdkeiah"===chrome.runtime.id?"https://www.hippovideo.io":"dnebjjdbjiikcmihpkcanphpbibhofkh"===chrome.runtime.id?"https://stage.hippowiz.com":"http://localhost:3000",k={allScripts:"All scripts",myScripts:"My scripts",shared:"Shared",enablePrompt:"Enable Teleprompter",disablePrompt:"Disable Teleprompter",prompt:"Teleprompter",selectScript:"-Select Script-",changeScript:"Change script",speedLabel:"Speed",addNewScript:"Add New Script",textSizeChange:"Text Size",lineSpaceChange:"Line Space",sharedEmptyStateText:"No video scripts shared with you currently.",myScriptEmptyStateText:"Click here to add new script.",allScriptEmptyStateText:"No scripts shared with you currently. Click here to add new script.",notePrefix:"Note: Press ",spaceBar:"Space",notePostfix:"to Play/Pause video prompting"},N={wrapper_template:'<div class="vpr-whole-wrap hide" id="hv-dyna-video-crompter-container">             <div class="width-12 columns large-centered video-prompter-container">                <ul class="tabs vpr-tab" data-tab="" id="scriptTypesId">                   <li id="avs" class="tab-title active"><a href="#">'+k.allScripts+'</a></li>                   <li id="mvs"class="tab-title"><a href="#">'+k.myScripts+'</a></li>                   <li id="svs" class="tab-title"><a href="#">'+k.shared+'</a></li>                   <a id="refreshPrompterPages" class="refresh"><img src='+chrome.extension.getURL("/images/extension/refresh.svg")+'></a>                  <a class="hp-border-btn addNewScriptFromPrompt"><img src='+chrome.extension.getURL("/images/extension/plus-ico-blue.svg")+">"+k.addNewScript+'</a>                </ul>               <div class="tabs-content sf-tab-content" id="scriptListId">                   <div class="content active" id="allVideoScripts">                   </div>                   <div class="content" id="myVideoScripts">                   </div>                   <div class="content" id="sharedScripts">                   </div>                </div>                <div id="testelement"></div>                <div class="display-video-prompt hide" id="promptSettingsContainer">                   <div class="width-12 columns prompt-settings" id="promptPropertiesId">                      <div class="width-3 columns font-size text-left right-bar"  hv-tooltip="You can change the text size and line spacing only when you pause the teleprompter by pressing the space bar">                         <h6>'+k.textSizeChange+'</h6>                         <label id="textSizeDecrease" class="minus in-active"><img src='+chrome.extension.getURL("/images/extension/minus-ico-white.svg")+' width="10"></label>                        <label id="textSizeIncrease" class="plus"><img src='+chrome.extension.getURL("/images/extension/plus-ico-white.svg")+' width="10"></label>                      </div>                      <div class="columns width-3 right-bar linespace-container" hv-tooltip="You can change the text size and line spacing only when you pause the teleprompter by pressing the space bar">                         <h6>'+k.lineSpaceChange+'</h6>                         <label class="minus in-active" id="lineSpaceDecrease"><img  src='+chrome.extension.getURL("/images/extension/minus-ico-white.svg")+' width="10"></label>                        <label class="plus" id="lineSpaceIncrease"><img  src='+chrome.extension.getURL("/images/extension/plus-ico-white.svg")+' width="10"></label>                      </div>                      <div class="width-4 columns slider right-bar">                         <div class="width-3 columns">                            <h6>'+k.speedLabel+'</h6>                         </div>                         <div class="width-1 columns text-right slider-minus-container"><img id="speedDecreaseId" class="minus" src='+chrome.extension.getURL("/images/extension/minus-ico-white.svg")+' width="10"></div>                         <div class="width-7 columns text-center slider-input-container"><span id="speedSliderId" type="range" min="1" max="10" value="5" step="10" class="vp-slider vp-cedit">5<span/></div>                         <div class="width-1 columns text-left slider-plus-container"><img id="speedIncreaseId" class="plus" src='+chrome.extension.getURL("/images/extension/plus-ico-white.svg")+' width="10"></div>                      </div>                      <div class="width-2 columns change-script-container"><a id="changeScriptId" class="change-script">'+k.changeScript+'</a></div>                   </div>                   <div class="width-12 columns telepromterColumnContainer" id="telepromterColumnContainer">                      <div id="teleprompterId" contenteditable="true" class="width-6 width-offset-3 columns video-teleprompter" style="line-height: 1;"></div>                      <div id="teleprompterSiblingDiv" style="top: 0px;"></div>                   </div>                </div>             </div>          </div>',teleprompter_template:'<div class="vpr-whole-wrap vpr-whole-wrap-overlay" id="{id}">          <div class="width-12 columns large-centered video-prompter-container">             <div class="display-video-prompt" id="promptPlayContainer">                <div class="width-12 columns telepromterColumnContainer" id="telepromterColumnContainerOnRecord">                   <div id="teleprompterOnRecord" class="width-6 width-offset-3 columns video-teleprompter" style="line-height: 1;"></div>                   <div id="teleprompterOnRecordDiv" style="top: 0px;"></div>                </div>             </div>          </div>       </div>'};L.port.onMessage.addListener(function(e,t,r){var o=e.backgroundRecordingMessage,a=e.data||{};if("popScreenSwitch"==o&&"create"==a.mode&&s(a),a.markRecordingStatus&&"workflow"==a.msgType&&$("#hv-dyna-video-crompter-container").addClass("hide"),"startCountDown"==o&&c(a),"recording_data_started"==o&&n(),"MarkupToolEnabled"==o&&(isRecording=a.isRecording),"stopped_recording"!=o&&"cancelFromWorkflowPop"!=o&&"record_aborted"!=o||i(),I(a)&&("initTeleprompter"==o&&s(a),"fetchTeleprompterData"==o)){var p=a.response.not_signed_in;p?wasUnsignedUser=p:a.status&&a.response.status&&l(a.response)}})})}