function addLinkToDoc(e){var t=$(".goog-menuitem-label[aria-label='Link... l']").parent().parent()[0];eventFire(t,"mousedown"),setTimeout(function(){eventFire(t,"mouseup"),setTimeout(function(){eventFire($(".docs-link-insertlinkbubble-text")[0],"focus"),$(".docs-link-insertlinkbubble-text").val("Video Link"),eventFire($(".docs-link-urlinput-url")[0],"focus"),$(".docs-link-urlinput-url").val(e),setTimeout(function(){eventFire($(".docs-link-urlinput-url")[0],"input")},500)},500)},100)}function disableCreateVideoBtn(){isRecording=!0,$("#hv-embed-main-btn").hasClass("jfk-button-disabled")||($("#hv-embed-main-btn").addClass("jfk-button-disabled"),$(".hv-embed-btn-img").css("opacity","0.5"))}function hideWidget(){$("#hv-embed-main-btn").removeClass("jfk-button-checked jfk-button-clear-outline"),$(".hv-widget-container").fadeOut(function(){$(".hv-widget-container").remove()}),$(".kix-page-content-wrapper").css("z-index","22"),$(".kix-lineview-content").css("z-index","15")}function startRecording(){recordConfiguration.fromPopup=!0,recordConfiguration.initiator="google-document",recordConfiguration.tabRecording=!1,recordConfiguration.separateLayer=!1,recordConfiguration.systemAudio=!0,port.postMessage({doBackgroundRecording:!0,config:recordConfiguration,currentUrl:location.href,messageFromContentScript1234:!0}),hideWidget(),disableCreateVideoBtn()}function getParameterByName(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var i=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),n=i.exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}function eventFire(e,t){if(e.fireEvent)e.fireEvent("on"+t);else{var i=document.createEvent("Events");i.initEvent(t,!0,!1),e.dispatchEvent(i)}}var injectedAlready=document.getElementById("hippowiz-gs-injected"),isRecording=!1,waitingForUrl=!1,recordingConfiguration,assetId;if(!injectedAlready){var hippoCsInjected='<input type=hidden id="hippowiz-gs-injected" value=true />';$(hippoCsInjected).appendTo("body");var port;console.log("injected google slide script"),$(document).ready(function(){function e(){isRecording=!1,$("#hv-embed-main-btn").hasClass("jfk-button-disabled")&&($("#hv-embed-main-btn").removeClass("jfk-button-disabled"),$(".hv-embed-btn-img").css("opacity","1"))}function t(e){if(("hv-embed-create-video-text"==$(e.target).attr("id")||"hv-icon-img"==$(e.target).attr("id"))&&!isRecording){$(".hv-widget-container").length>0?hideWidget():i("hv-embed-main-container",$(e.currentTarget).attr("data-type"))}}function i(e,t){if(0==$("#"+e).has(".hv-widget-container").length){$('<div class="hv-widget-container hv-gd-widget-block"></div>').appendTo($("#"+e))}n(e,"hv-widget-container",t)}function n(e,t,i){currentWidgetId=t;var n=$("#"+e).find("."+t);n.empty().load(chrome.extension.getURL("html/injected/record-library-widget.html"),function(){for(var e=$(n),t=0;t<e.length;t++){var o=e[t],r=o.innerHTML.toString(),a=r.replace(/__MSG_(\w+)__/g,function(e,t){return t?chrome.i18n.getMessage(t):""});a!=r&&(o.innerHTML=a)}var d='<img class="hv-embed-dom-click hv-embed-widget-top-right-arrow" src="'+chrome.runtime.getURL("/images/injected/widget-top-arrow.png")+'">';$(d).appendTo(n),n.find(".hv-embed-record-button").off("click"),n.find(".hv-embed-record-button").on("click",startRecording),n.find(".hv-embed-widget").show(),n.find(".hv-embed-widget-top-right-arrow").show(),checkAndShowWidget(i)})}port=chrome.extension.connect({name:"googledocumentscript"}),port.postMessage({askToInsertRecordLibraryScript:!0,messageFromContentScript1234:!0});var o=document.getElementById("docs-docos-commentsbutton");if(o){var r=o.className;if(!document.getElementById("hv-embed-main-btn")){var a='<div id="hv-embed-main-container" data-type="record">\t\t\t\t\t<span class="goog-inline-block hv-embed-icon-img">\t\t\t\t\t\t<img id="hv-icon-img" class="hv-embed-btn-img" style="position: relative;top: 6px;margin-right: 3px;" src="'+chrome.runtime.getURL("/images/injected/hippo-grey-logo.png")+'"/>\t\t\t\t\t\t&nbsp;\t\t\t\t\t</span>\t\t\t\t\t<div role="button" id="hv-embed-main-btn" data-ref="hv-embed-main-container" data-type="record" class="'+r.replace("jfk-button-disabled","")+'" aria-disabled="false" style="margin-right:10px;user-select: none;top:2px;">\t\t\t\t\t<span id="hv-embed-create-video-text" class="create-video-text">Create Video</span>\t\t\t\t\t</div></div>';$(".docs-titlebar-buttons > div:nth-child(1)").after(a),$("#hv-embed-main-container").off("click"),$("#hv-embed-main-container").on("click",t),port.postMessage({insertPreviewPopupScript:!0,messageFromContentScript1234:!0})}}waitingForUrl=!0,port.postMessage({getShareUrl:!0,initiator:"google-document",messageFromContentScript1234:!0}),port.onMessage.addListener(function(t,i,n){"currentstate"==t.backgroundRecordingMessage&&(isRecording=!(!t.data.isRecording&&!t.data.isPaused))&&disableCreateVideoBtn(),"recording_cancelled"==t.backgroundRecordingMessage&&(isRecording=!1,e()),"bothstarted-popup"==t.backgroundRecordingMessage&&(isRecording=!0,disableCreateVideoBtn()),"bothstarted-google-document"==t.backgroundRecordingMessage&&(port.postMessage({startCountDownGeneral:!0,messageFromContentScript1234:!0}),isRecording=!0,disableCreateVideoBtn()),"stopped_recording"==t.backgroundRecordingMessage&&(t.data&&"google-document"==t.data.initiator&&(recordingConfiguration=t.data.recordConfiguration,assetId=recordingConfiguration.assetId,$("#hv-embed-iframe-container").show()),isRecording=!1,e()),"google-document-share-link"==t.backgroundRecordingMessage&&void 0!=t.data.shareLink&&1==waitingForUrl&&(addLinkToDoc(t.data.shareLink),waitingForUrl=!1),"add-share-link-to-page"==t.backgroundRecordingMessage&&void 0!=t.data.shareUrl&&"google-document"==t.data.initiator&&(addLinkToDoc(t.data.shareUrl),$("#hv-embed-iframe-container").fadeOut(function(){$("#hv-embed-iframe-container").remove(),port.postMessage({insertPreviewPopupScript:!0,messageFromContentScript1234:!0})}),waitingForUrl=!1),"close-preview-popup"==t.backgroundRecordingMessage&&"google-document"==t.data.initiator&&$("#hv-embed-iframe-container").fadeOut(function(){$("#hv-embed-iframe-container").remove(),port.postMessage({insertPreviewPopupScript:!0,messageFromContentScript1234:!0})}),"preprocess_complete"==t.backgroundRecordingMessage&&(void 0!=recordingConfiguration&&void 0!=assetId&&(recordingConfiguration.projectJson=t.data,messageEmbeddedFrame("hv_record_completed",{recording_configuration:recordingConfiguration,asset_id:assetId}),messageEmbeddedFrame("hv_preprocess_complete",{project_json:t.data}),messageEmbeddedFrame("dynamic_integ_data",{initiator:recordingConfiguration.initiator,share_url:recordingConfiguration.recordedURL})),recordingConfiguration=void 0,assetId=void 0)}),$(document).click(function(e){"hv-embed-create-video-text"===e.target.id||"hv-icon-img"===e.target.id||$(e.target).hasClass("hv-embed-dom-click")||hideWidget()})})}