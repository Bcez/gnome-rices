var injectedAlready=document.getElementById("hippowiz-gclassroom-injected"),isRecording=!1,widgetRefCount=0,currentWidgetId,classRoomName,assignmentName,teacherName,postType,postReference,waitingForUrl=!1,popupAlreadyOpen=!1,alreadyAskedVideoUrl=!1,isRequester=!1,recordingConfiguration,assetId,HTML_CONTENT={hippo_button:"<div class='hv-embed-main-container'> <button id='hippo_video_button' data-ref='hv-embed-main-container' data-type='record_and_library' class='toolbar-action-component toggle text-editor-extension hint--top hv-embed-main-icon' data-hint='Hippo Video' type='button'><img src='https://hippolms-wiz-static.s3.amazonaws.com/images/gmail_add_on/video-icon-orange.svg' class='icon_image'></button><span class='tooltiptext'>Hippo Video</span></div>"};if(!injectedAlready){var hippoCsInjected='<input type=hidden id="hippowiz-gclassroom-injected" value=true />';$(hippoCsInjected).appendTo("body");var port;console.log("injected google classroom script"),$(document).ready(function(){function e(e){var t=document.getElementById(e);if(t&&t.getAttribute("value"))return t.getAttribute("value")}function t(){return{serviceName:s.serviceName,windowId:s.windowId,tabId:s.tabId}}function n(e,t,n){$(e).append($(HTML_CONTENT.hippo_button)),n&&$(e).find(".hv-embed-main-container").addClass(n),"left"==t?$(e).find(".hv-embed-main-container").addClass("hv-dir-left"):$(e).find(".hv-embed-main-container").addClass("hv-dir-top"),$(".hv-embed-main-icon").off("click"),$(".hv-embed-main-icon").on("click",r),$(".rich-text-editor-component button.primary-button.save").addClass("hv-tool-bar-quill-override")}function a(){var e=t();e.messageFromContentScript1234=!0,e.initWorkflowPop=!0,e.msgType="workflow",e.payload={logPrefix:s.logPrefix,popType:"sales",popId:"hvGClassroomPop",assetContent:{},popConfig:{showEditOption:!0,showTemplatesOption:!1,showContactsOption:!1,showVideoPageLibrary:!0,addSalesUtmParams:!1,popReinitConditions:[],showMfForm:!0,fetchMfInVideo:!0,mandatoryEmailMf:!1,showCustomizeComponent:!0,showTelePrompter:!0,showLandingPageComponent:!0}},s.port.postMessage(e)}function o(e){var n=e.workflowConfig,a=t();a.messageFromContentScript1234=!0,a.messageType="google_classroom_dynamic",a.getUTMToken=!0,a.popId=n.popId,a.content=n,a.serviceName=s.serviceName,s.port.postMessage(a)}function r(e){$(".hv-insert-ref").removeClass("hv-insert-ref");var t;"comment"==$(e.currentTarget).parent().attr("data-hvref")&&(t=$(e.currentTarget).parent().parent().find(".editable")),"post"==$(e.currentTarget).parent().attr("data-hvref")&&(t=$(".hqfVKd.tL9Q4c")),"assignment"==$(e.currentTarget).parent().attr("data-hvref")&&(t=$(".Y6Mzcf.Wic03c").find('textarea[aria-label="Instructions (optional)"]')),$(t).addClass("hv-insert-ref"),$("#hvGClassroomPop").remove(),a()}function i(e,t){if(e.fireEvent)e.fireEvent("on"+t);else{var n=document.createEvent("Events");n.initEvent(t,!0,!1),e.dispatchEvent(n)}}var s=function(){var t={};return t.serviceName=e("hvIntegName"),t.windowId=Number(e("hvWindowId")),t.tabId=Number(e("hvTabId")),t.logPrefix=" GOOGLE_CLASSROOM_DYNAMIC :: ",t.port=chrome.extension.connect({name:t.serviceName+"::"+t.windowId+"::"+t.tabId}),t}();!function(){var e=t();e.messageFromContentScript1234=!0,e.injectHvWorkflowScripts=!0,s.port.postMessage(e)}(),s.port.onMessage.addListener(function(e,t,n){if(msgFromPort=e.backgroundRecordingMessage,"insertFromWorkflowPop"==msgFromPort&&"google-classroom"==e.data.serviceName&&e.data.tabId==s.tabId)if(e.data.workflowConfig.assetContent.mfInVideo.length>0)o(e.data);else{var a=e.data.workflowConfig.assetContent,r=a.videoShareUrl,d="";d=$(".hv-insert-ref")[0].innerHTML,d.length>0?(d+="\n",d+=r,$(".hv-insert-ref")[0].innerHTML=d):$(".hv-insert-ref")[0].innerHTML=r,i($(".hv-insert-ref")[0],"keydown"),i($(".hv-insert-ref")[0],"keyup"),i($(".hv-insert-ref")[0],"input"),$("#hvGClassroomPop").remove()}if("insertVideoInGClassroomPost"==msgFromPort&&e.data.tabId==s.tabId){var a=e.data.content.assetContent,r=a.videoShareUrl,m=e.data.track_id;if(e.data.content.assetContent.mfInVideo.length>0)if(1==e.data.status)r.includes("?")?r+"&track_id="+m:r+"?track_id="+m;else{var c=e.data.content.assetContent.mfFormValues,p="",v=1;for(mf_d in c)p=1==v?p+encodeURIComponent(mf_d)+"="+encodeURIComponent(c[mf_d]):p+"&"+encodeURIComponent(mf_d)+"="+encodeURIComponent(c[mf_d]),v++;r.includes("?")?r+"&"+p:r+"?"+p}var d="";d=$(".hv-insert-ref")[0].innerHTML,d.length>0?(d+="\n",d+=r,$(".hv-insert-ref")[0].innerHTML=d):$(".hv-insert-ref")[0].innerHTML=r,i($(".hv-insert-ref")[0],"keydown"),i($(".hv-insert-ref")[0],"keyup"),i($(".hv-insert-ref")[0],"input"),$("#hvGClassroomPop").remove()}}),MutationObserver=window.MutationObserver||window.WebKitMutationObserver,new MutationObserver(function(e,t){for(var a in e){var o=e[a];if($(o.target).hasClass("hqfVKd")&&$(o.target).hasClass("tL9Q4c")){var r=$(".QRiHXd.w1v75b .larTwb").parent();if($(".QRiHXd.w1v75b .larTwb").length>0&&0==$(r).find(".hv-embed-main-container").length){var i=$(r);n(i,"top"),$(r).find(".hv-embed-main-container").attr("data-hvref","post")}}if($(o.target).hasClass("O98Lj")&&0==$(o.target).find(".hv-embed-main-container").length){var i=$(o.target);n(i,"left","hv-in-comment-pos"),$(o.target).find(".hv-embed-main-container").attr("data-hvref","comment")}if($(o.target).hasClass("RdyDwe")&&$(o.target).hasClass("snByac")&&"Create"==$(o.target).text()&&$(o.target).parent().parent().hasClass("bVp04e")){var i=$(o.target).parent().parent().parent();n(i,"top"),$(o.target).parent().parent().parent().find(".hv-embed-main-container").attr("data-hvref","assignment")}}}).observe(document,{subtree:!0,childlist:!0,attributes:!0})})}