document.getElementById("hippowiz-gmail-injected")||($('<input type=hidden id="hippowiz-gmail-injected" value=true />').appendTo("body"),$(document).ready(function(){function e(e){var t=document.getElementById(e);if(t&&t.getAttribute("value"))return t.getAttribute("value")}function t(){return{serviceName:be.serviceName,windowId:be.windowId,tabId:be.tabId}}function i(e){be.port.postMessage({insertTopMenuInGmail:!0,integType:"gmail",scriptName:be.serviceName,messageType:"gmail",payload:{tabId:be.tabId,windowId:be.windowId},messageFromContentScript1234:!0})}function n(e){return e.data&&e.data.serviceName==be.serviceName&&e.data.tabId==be.tabId&&e.data.windowId==be.windowId}function a(e){if($(e.target).find("#hippovideoAddon").length>0){var t=$("#hippovideoAddon").find('img[title="Create Video"]');$(t).attr("event-added")||($(t).parent().removeAttr("data-click"),$(t).attr("event-added",!0),$(t).off("click").on("click",function(e){we=!0,de()}))}else $(e.target).find(".btV").length>0&&$(e.target).find(".btv").attr("id","hippovideoAddon")}function o(e){r(e,"compose")}function s(e){r(e,"reply")}function r(e,t){try{chrome.storage.sync.get(["placeIconInGmailToolbox"],function(i){var n=void 0!=i.placeIconInGmailToolbox&&i.placeIconInGmailToolbox;d(e,t,n)})}catch(i){d(e,t,!1)}}function d(e,t,i){var n=$(e.target).attr("id");if($(".aDh.inboxsdk__compose_statusbar")&&$(pe(n+"_hvBottomMenu")).length>1&&$(".aDh.inboxsdk__compose_statusbar").find(pe(n+"_hvBottomMenu")).remove(),0==$(pe(n+"_hvBottomMenu")).length){if(_e&&_e.composeType===t)return m(n),void(_e=void 0);$(pe(n)).attr("compose-type",t);var a=$(e.target).find(".iN tbody").first();if($(a).length>0){var o=i?$(a).find(".gU.Up"):$(a).find(".aDh"),s=i?$(Te.bottomMenuTypeTwo):$(Te.bottomMenuTypeOne);i?$(s).find(".hv-bottom-menu").addClass("hv-menu-type-two-"+t).attr("id",n+"_hvBottomMenu").attr("mail-type",t).attr("compose-id",n):$(s).addClass("hv-menu-type-one-"+t).attr("id",n+"_hvBottomMenu").attr("mail-type",t).attr("compose-id",n),$($(s).find(".hv-bottom-menu-option")[0]).attr("id",n+"_hvCreateOneToOneSalesVideo"),$($(s).find(".hv-bottom-menu-option")[1]).attr("id",n+"_hvCreatePersonalizedVideo"),"reply"===t&&($(s).find(pe(n+"_hvCreatePersonalizedVideo")).remove(),$(a).find(".aDg").css("height","100px"),$(a).find(".aDj").css("height","100px")),i?$(o).after($(s)):$(o).prepend($(s)),p(n,!0),me($(pe(n+"_hvBottomMenu")).find(".hv-bottom-menu-option"),"click",u),Ce&&(Ce=!1,$(pe(n+"_hvCreatePersonalizedVideo")).click()),we&&(we=!1,$(pe(n+"_hvCreateOneToOneSalesVideo")).click());var r=$(o).find(".btA").attr("id");$(pe(r)).length>0&&($(pe(r)).attr("compose-id",n),me($(pe(r)),"click",function(e){se(e)})),c(n),setTimeout(function(){if($(".yesware-composer-enabled").length>0){var e=$(o).attr("style")||"",t=$(a).find(".aDj").attr("style")||"";e+="height: auto !important;",t+="height: auto !important;",$(o).attr("style",e),$(a).find(".aDj").attr("style",t)}},200)}}else _e&&_e.composeType===t&&(m(n),_e=void 0)}function c(e){var t=$(pe(e)).find(".iN tbody").first(),i=$(t).find(".ZyRVue").find(".Ar.Au").find(".Am").attr("id");$(pe(i)).attr("compose-id",e),$(pe(i)).off("mouseup").on("mouseup",l),$(pe(i)).off("keyup").on("keyup",l)}function l(e){var t=window.getSelection(),i=t.anchorNode;$(e.currentTarget).parent().find(".hv-current-cursor").removeClass("hv-current-cursor").removeAttr("anchor-offset");var n;1==i.nodeType?n=$(i):3==i.nodeType&&(n=$(i.parentElement)),$(n).addClass("hv-current-cursor").attr("anchor-offset",t.anchorOffset)}function p(e,t){var i=$(pe(e+"_hvBottomMenu"));t?$(i).show():$(i).hide()}function m(e){var t={};t.popType="sales",t.composeId=e,t.assetId=_e.assetId;var i=_e.shareUrl,n=_e.customerHost;if(i){var a=i.split("?")[0].split("/");a=a[a.length-1],t.deliveryToken=a;var o=n+"/video/play/"+a,s=n+"/video/thumbnail/"+a;t.html='<div><a href="'+o+'" target="_blank"><img style="max-height: 200px; max-width: 360px;" alt="'+o+'" src="'+s+'"></a></div>',t.videoTitle=_e.videoTitle||"New Recording",y("hvGmailPersonalizationPop",t)}}function u(e){var t=$(e.currentTarget).attr("action"),i=$(e.currentTarget).parent().attr("compose-id"),n=$(e.currentTarget).parent().attr("mail-type"),a=$(e.currentTarget).attr("action");"sales"==a||"campaign"==a?(f(t,i,n),ge($(e.currentTarget).attr("id").includes("_hvCreateOneToOneSalesVideo")?" Send 1-1 Video Button Clicked":" Send Personalized Video Button Clicked")):"edit"==a?Z("hvGmailPersonalizationPop",i):"delete"==a&&X("hvGmailPersonalizationPop",i)}function f(e,i,n){var a=t();a.messageFromContentScript1234=!0,a.initWorkflowPop=!0,a.msgType="workflow";var o=g(i),s="sales"==e,r=$(pe(i)).find("form").attr("id"),d=le(r),c=U(d,"to"),l={};"sales"==e&&c.length>0&&(l.Email=c[0]),a.payload={logPrefix:be.logPrefix,popType:e,popId:"hvGmailPersonalizationPop",assetContent:{composeId:i,popType:e,mfFormValues:l},assetContentContainerId:i,popConfig:{showEditOption:!0,showTemplatesOption:!0,showContactsOption:"campaign"==e,showVideoPageLibrary:!0,popReinitConditions:["popType","composeId"],showMfForm:"sales"==e&&"compose"==n,defaultHtmlContent:o.html,defaultContentSubject:C(i),mandatoryEmailMf:s,showCustomizeComponent:!0,showLandingPageComponent:!0,showTelePrompter:!0,signatureContent:o.signatureContent}},be.port.postMessage(a)}function v(e){var t=$(pe(e)+" input[name=rt]").val(),i=$(pe(e)+" input[name=draft]").val();return{thread_id:t,legacy_thread_id:$(pe(e)+" input[name=lts]").val(),message_id:i}}function g(e){var t=$(pe(e)).find(".iN tbody").first(),i=$(t).find(".ZyRVue").find(".Ar.Au").find(".Am.Al.editable.LW-avf").attr("id"),n=$(pe(i)).clone();$(n).find(".hippo-video").replaceWith("${Video Url}");var a=$(n)[0].innerHTML,o=h(n);if(o){a.includes("-- <br>")&&(a=a.replace("-- <br>",""),$(pe(i))[0].innerHTML=a,_(i,"<div>--</div>")),n=$(pe(i)).clone(),o=h(n),b(n),a=$(n)[0].innerHTML}return a=a.replace(new RegExp("<div>","g"),"<p>"),a=a.replace(new RegExp("<div ","g"),"<p "),a=a.replace(new RegExp("</div>","g"),"</p>"),{html:a,signatureContent:o}}function h(e){var t=null;return $(e).find(".gmail_signature").length>0?t=$("<div />").append($(e).find(".gmail_signature")).html():$(e).find("[data-smartmail='gmail_signature']").length>0?t=$("<div />").append($(e).find("[data-smartmail='gmail_signature']")).html():$(e).find("[title='User signature']").length>0&&(t=$("<div />").append($(e).find("[title='User signature']")).html()),t}function b(e){return $(e).find(".gmail_signature").remove(),$(e).find("[data-smartmail='gmail_signature']").remove(),$(e).find("[title='User signature']").remove(),e}function _(e,t){var i=null;$(pe(e)).find(".gmail_signature").length>0?i=$(pe(e)).find(".gmail_signature"):$(pe(e)).find("[data-smartmail='gmail_signature']").length>0?i=$(pe(e)).find("[data-smartmail='gmail_signature']"):$(pe(e)).find("[title='User signature']").length>0&&(i=$(pe(e)).find("[title='User signature']")),i&&$(i).prepend($(t))}function w(e){for(var t=$(pe(e)).find(".hippo-video").next();$(t).length>0&&"<br>"==$(t)[0].innerHTML;)$($(t)[0]).remove(),t=$(pe(e)).find(".hippo-video").next();var i=null;if($(pe(e)).find(".gmail_signature").length>0?i=$(pe(e)).find(".gmail_signature"):$(pe(e)).find("[data-smartmail='gmail_signature']").length>0?i=$(pe(e)).find("[data-smartmail='gmail_signature']"):$(pe(e)).find("[title='User signature']").length>0&&(i=$(pe(e)).find("[title='User signature']")),i)for(prevSpace=$(i).prev();$(prevSpace).length>0&&"<br>"==$(prevSpace)[0].innerHTML;)$($(prevSpace)[0]).remove(),prevSpace=$(i).prev()}function C(e){var t=$(pe(e)).find("form").attr("id");return $(pe(t)).find("input[name=subject]").val()}function x(e){var t=e.workflowConfig.assetContent,i=t.composeId;$("#"+e.workflowConfig.popId).attr("compose-id",e.workflowConfig.assetContent.composeId),$("#"+e.workflowConfig.popId).attr("pop-type",e.workflowConfig.popType),$(pe(i)).data("workflowConfig",e.workflowConfig),t.signatureContent=e.workflowConfig.popConfig.signatureContent,y(e.workflowConfig.popId,t)}function y(e,t){var i=t.popType,n="sales"===i&&t.mfInVideo&&t.mfInVideo.length>0,a=t.composeId;if("sales"!==i||t.utm_content||n){var o=t.videoShareUrl,s=t.thumbnailShareUrl;if(t.utm_content&&(o+=o.includes("?")?"&utm_source=gmail&utm_content="+t.utm_content:"?utm_source=gmail&utm_content="+t.utm_content,t.thumbnailPersonalised||t.isPage?s+=s.includes("?")?"&utm_source=gmail&utm_content="+t.utm_content:"?utm_source=gmail&utm_content="+t.utm_content:t.isPage||t.customPageDetails?s+=s.includes("?")?"&utm_source=gmail&utm_content="+t.utm_content:"?utm_source=gmail&utm_content="+t.utm_content:s=t.thumbnail_url),"sales"===i&&n){var r=t.mfFormValues||{},d=[],c={};c.Email=r.Email;var l=[];for(var m in r)c[m.toLowerCase()]=r[m],l.push(m);d.push(c),t.toEmails=[r.Email],t.importType=4,t.manualcontacts=d,t.vidAndThumbMfs=l}ie(a,t);var u=$(pe(a)).find(".iN tbody").first(),f=$(u).find(".ZyRVue").find(".Ar.Au").find(".Am.Al.editable.LW-avf").attr("id"),g=$(pe(a)).find("form").attr("id");if("sales"==i){var h=t.mfFormValues.Email;if(h){var b=le(g);if(!U(b,"to").includes(h)){var _="",C=$(pe(b)).find('div[name="to"]').find(".afx").length>0;_=C?$(pe(b)).find('div[name="to"]').find(".afx").find("input.agP").attr("id"):$(pe(b)).find('textarea[name="to"]').attr("id"),$(pe(_))[0].value=h,$(pe(f)).focus().click(),B(a)}}}if(t.html){for(var x=t.html,y=$(x).find("a"),F=0;F<y.length;F++){var T=y[F],k=T.outerHTML.replace(/&amp;/g,"&");if(($(T).attr("href").includes(t.customerHost+"/video/play")||$(T).attr("href").includes(t.customerHost+"/page"))&&k.includes(t.thumbnailShareUrl)){var D=t.isPage?t.pageAssetId:t.assetId,P=O(o,s,t.videoTitle,t.deliveryToken,D,a,"campaign"===i||n,("campaign"===i||n)&&!t.isPage);P=t.signatureContent?"<div><br></div>"+P:"<div><br></div>"+P+"<div><br></div>",x=x.includes(T.outerHTML)?x.replace(T.outerHTML,P):x.includes(k)?x.replace(k,P):x.replace(T.outerHTML,P)}}if(t.signatureContent&&!x.includes(t.signatureContent)&&(x+=t.signatureContent),x="<div>"+x+"</div>",$(pe(f)).empty().append($(x)),"sales"===i&&!n&&!t.isPage&&!t.customPageDetails){var E=t.customerHost+"/video/track/mail_open/gmail/"+t.deliveryToken+"?utm_source=gmail&utm_content="+t.utm_content+".gif",S='<img src="'+E+'" width="1" height="1" class="hippovideo component open_tracking" border="0">';$(pe(f)).find("#hippo-video-compose-box-"+t.deliveryToken).append($(S))}w(f),("campaign"===i||n)&&($(pe(a+"_hvVideoEditAction")).attr("pop-id",e),$(pe(a+"_hvVideoDeleteAction")).attr("pop-id",e),me($(pe(a+"_hvVideoEditAction")),"click",J),me($(pe(a+"_hvVideoDeleteAction")),"click",K))}if(void 0!=t.subject){var M=$(pe(g)).find("input[name=subjectbox]").attr("id");$(pe(g)).find("input[name=subject]").val(t.subject),$(pe(M)).val(t.subject)}if($("#"+e).find(".hv-wf-pop-body .hv-wf-pop-loading").fadeOut(10),$("#"+e).hide(),"campaign"===i||n){var b=le(g),C=$(pe(b)).find('div[name="to"]').find(".afx").length>0;if(C&&$(pe(b)).find('textarea[name="cc"]').closest("td").find(".vR").remove(),t.toEmails&&t.toEmails.length>0){var _="";C?(_=$(pe(b)).find('div[name="to"]').find(".afx").find("input.agP").attr("id"),$(pe(_)).parent().find(".agh").remove()):(_=$(pe(b)).find('textarea[name="to"]').attr("id"),$(pe(_)).closest("td").find(".vR").remove());var V=t.toEmails.join(",");$(pe(_))[0].value=V,$(pe(f)).focus().click()}B(a),q(a,e);var G=t.toEmails&&t.toEmails.length>0?Fe.editContacts:Fe.ImportContacts;A(a,G,t.toEmails&&t.toEmails.length>0,i),setTimeout(function(e){$(pe(a)).click()},500)}else Y(a);var N=t.templateId?Fe.changeTemplate:Fe.chooseTemplate;I(a,N,i),p(a,!("campaign"===i||n))}else{var R=v(a);t.isPage?R.asset_id=t.pageAssetId:R.token=t.deliveryToken,oe(e,t,R)}}function A(e,t,i,n){var a=$(pe(e)).find("form").attr("id"),o=$(pe(a)).find(".aoD.hl").attr("id"),s=le(a),r=$(pe(s)).find(".o1 .gO.aQY").attr("id");$(pe(r)).css("pointer-events","none"),$(pe(o)).find(pe(e+"_hvICBtnRecipientBox")).remove(),i?($(pe(s)).css("display","flex"),$(pe(o)).hide()):($(pe(s)).hide(),$(pe(o)).css("display","flex")),setTimeout(function(e){$(pe(s)).find('textarea[name="to"]').attr("disabled",!0),$(pe(s)).find('textarea[name="to"]').closest("td").find(".vR").css("pointer-events","none")},1e3);var d=$(pe(s)).find('div[name="to"]').find(".afx").length>0;$(pe(s)).find('textarea[name="cc"]').val("").trigger("change"),$(pe(s)).find('textarea[name="cc"]').closest("tr").hide(),0==$(pe(s)).find(pe(e+"_hvICBtnToBox")).length&&$(pe(s)).find('textarea[name="to"]').parent().prepend($('<div id="'+e+'_hvICBtnToBox" compose-id="'+e+'" pop-type="'+n+'" class="import-contacts-outer-btn to-box-ic-btn"></div>')),0==$(pe(o)).find(pe(e+"_hvICBtnRecipientBox")).length&&(i?($(pe(o)).css("justify-content","flex-start"),d?($(pe(o)).prepend($('<div id="'+e+'_hvICBtnRecipientBox" compose-id="'+e+'" pop-type="'+n+'" class="import-contacts-outer-btn ic-to-mail-view-pre inner-recipient-box"> '+t+" </div>")),$(pe(o)).closest("form.bAs").before($('<div id="'+e+'_hvICBtnRecipientBox" compose-id="'+e+'" pop-type="'+n+'" class="import-contacts-outer-btn ic-to-mail-view-pre outer-recipient-box"> '+t+" </div>")),F(d,s)):$(pe(o)).prepend($('<div id="'+e+'_hvICBtnRecipientBox" compose-id="'+e+'" pop-type="'+n+'" class="import-contacts-outer-btn ic-to-mail-view-pre"> '+t+" </div>"))):($(pe(o)).css("justify-content","flex-start"),$('<div id="'+e+'_hvICBtnRecipientBox" compose-id="'+e+'" class="import-contacts-outer-btn ic-to-mail-view"></div>').insertAfter($(pe(o)).find(".oL.aDm")))),$(pe(s)).find(pe(e+"_hvICBtnToBox")).text(t),me($(pe(s)).find(pe(e+"_hvICBtnToBox")),"click",T),d?me($(pe(o)).closest("form.bAs").siblings(pe(e+"_hvICBtnRecipientBox")),"click",T):me($(pe(o)).find(pe(e+"_hvICBtnRecipientBox")),"click",T)}function F(e,t){$(pe(t)).find('div[name="to"]').find(".afx").find("input.agP").focusin(function(e){$(e.target).closest("form.bAs").siblings(".outer-recipient-box").hide()}),$(pe(t)).find('div[name="to"]').find(".afx").find("input.agP").focusout(function(e){$(e.target).closest("form.bAs").siblings(".outer-recipient-box").show()})}function T(e){ge("Import/Edit Contacts Btn in Compose Clicked");var t=$(e.currentTarget).attr("compose-id"),i=$(pe(t)).data("workflowConfig");0==$("#"+i.popId).length||$("#"+i.popId).attr("compose-id")!==t?ee(i):"sales"==i.popType?(i.openMfForm=!0,te(i,"hv-templates","templates")):te(i,"hv-contacts","contacts")}function I(e,t,i){var n=$(pe(e)).find("form").attr("id"),a=$(pe(n)).find('input[name="subjectbox"]').attr("id"),o=$(pe(a)).parent();0==$(o).find(pe(e+"_hvSubTemplateBtn")).length&&($(o).css("display","flex"),$('<div id="'+e+'_hvSubTemplateBtn" class="hv-subject-template-btn" compose-id="'+e+'" pop-type="'+i+'"></div>').insertAfter($(o).find("input")),me($(pe(e+"_hvSubTemplateBtn")),"click",k)),$(pe(e+"_hvSubTemplateBtn")).text(t)}function k(e){ge("Choose Template Btn in Compose Clicked");var t=$(e.currentTarget).attr("compose-id"),i=$(pe(t)).data("workflowConfig");0==$("#"+i.popId).length||$("#"+i.popId).attr("compose-id")!==t?ee(i):te(i,"hv-templates","templates")}function B(e){var t=$(pe(e)).find("form").attr("id"),i=le(t),n=U(i,"cc"),a=U(i,"bcc"),o=U(i,"to");(n.length>0||a.length>0||o.length>0)&&me($(pe(e)),"click",function(t){setTimeout(function(t){var i=$(pe(e)).find("form").attr("id");if(i){var n=le(i),a=$(pe(i)).find(".aoD.hl").attr("id"),o=$(pe(a)).find(".oL.aDm").attr("id"),s=U(n,"to");0==s.length?$(ele).empty().text("Recipients"):($(pe(o)).empty().append('<span email="'+s[0]+'" data-hovercard-id="'+s[0]+'">'+s[0]+"</span>"),s.length>1&&$(pe(o)).append('<span class="aDp aDq">'+(s.length-1)+" more</span>"))}},100)})}function D(e){if(!$(e.currentTarget).hasClass("disable-click")){$(e.currentTarget).addClass("disable-click");P($(e.currentTarget).attr("compose-id"))}}function P(e){var i=t();i.fetchGmailAccounts=!0,i.messageFromContentScript1234=!0,i.messageType="gmail",i.composeId=e,i.screenName=be.screenName,be.port.postMessage(i)}function E(e){var t,i=e.response,n=i.accounts||[],a=!1,o=$(document).find("title").first().text(),s=o.split(" - ");console.log("Gmail Integration - titleArray :: ",s);var r=s[s.length-2].replace(/ /g,"");if(!r.includes("@"))for(var d=s.length-1;d>0;d--){var c=s[d].replace(/ /g,"");if(c.includes("@")){r=c;break}}if(0==n.length)a=!0,ge("Grant Gmail Access Pop Called - No Accounts");else{for(var l=0;l<n.length;l++)if(n[l].email==r){t=n[l].user_id,userAccountEmail=n[l].email;break}t||(console.log("Gmail Integration - Accounts :: ",n),console.log("Gmail Integration - Different Account :: ",r),ge("Grant Gmail Access Pop Called - Different Account"),a=!0)}a?j(r,e.composeId):S(e.composeId,t)}function S(e,i){var n=$(pe(e)).find(".iN tbody").first(),a=$(n).find(".ZyRVue").find(".Ar.Au").find(".Am.Al.editable.LW-avf").attr("id"),o=$(pe(a)).find(".hippo-video");if($(o).length>0){var s=$(o).attr("asset-id"),r=$(pe(e)+"_asset_content");if($(r).length>0&&$(r).attr("asset-id")==s){var d=M(r,"importType");if(d&&""!=d){var c=$(pe(e)).find("form").attr("id"),l=le(c),p=U(l,"to");if(p.length>0){var m=V(p);$(o).find(".hv-video-actions").remove();var u={};u.to_mails=m.valid,u.invalid_mails=m.invalid,u.cc_mails=U(l,"cc").join(","),u.bcc_mails=U(l,"bcc").join(","),u.imported_from=d,u.subject=$(pe(c)).find("input[name=subject]").val();var f=N(u.subject);u.referer="hv-ext";var v=M(r,"customPageDetails");!M(r,"isPage")&&v?(u.assets=[Number(v.pageAssetId)],u.customAsset=Number(s),$(o).replaceWith('<span class="hv-merge-field">${asset-'+v.pageAssetId+"}</span>")):(u.assets=[Number(s)],$(o).replaceWith('<span class="hv-merge-field">${asset-'+s+"}</span>"));var g=$(pe(a))[0].innerHTML,h=R(f,g);if(f=h.usedMergeFields,u.content=h.contents,u.merge_field_infos=f,"1"==d)u.gdrive_user_id=M(r,"unique_id"),u.gdrive_file_id=M(r,"file_id");else if("4"==d){u.manualContacts=M(r,"manualcontacts");var b=M(r,"vidAndThumbMfs");0===b.length?u.mergeFieldData=["Email","First Name"]:u.mergeFieldData=b}u.template_id=M(r,"templateId"),u.gmail_user_id=i;var _=M(r,"popType"),w=M(r,"mfInVideo"),C="sales"===_&&w&&w.length>0;u.context=C?"sales":"campaign",u.list_name=M(r,"listName");var x=t();x.messageFromContentScript1234=!0,x.sendVideoCampaign=!0,x.messageType="gmail",x.composeId=e,x.params=u,x.screenName=be.screenName,be.port.postMessage(x)}else $(pe(e+"hvSendBtn")).removeClass("disable-click"),$e({message:Fe.fillToMails,isError:!1})}else $(pe(e+"hvSendBtn")).removeClass("disable-click"),$e({message:Fe.importContactsMsg,isError:!1})}else $(pe(e+"hvSendBtn")).removeClass("disable-click"),$e({message:Fe.videoNotPresent,isError:!1})}else $(pe(e+"hvSendBtn")).removeClass("disable-click"),$e({message:Fe.videoNotPresent,isError:!1})}function M(e,t){var i=$(e).find('input[name="'+t+'"]');if($(i).length>0){var n=$(i).val();if(n)return JSON.parse(n)}}function V(e){for(var t={valid:[],invalid:[]},i=0;i<e.length;i++){var n=e[i];G(n)?t.valid.push(n):t.invalid.push(n)}return t}function G(e){return!!e&&Ae.test(e.trim())}function N(e){for(var t,i=[],n=0,a=e.indexOf("${",0);-1!==a&&-1!==n;)-1!==(n=e.indexOf("}",a))&&(t=e.substring(a,n+1),i.includes(t)||i.push(t),a=e.indexOf("${",n));return i}function R(e,t){for(var i,n=0,a=t.indexOf("${",0);-1!==a&&-1!==n;)-1!==(n=t.indexOf("}",a))&&(i=t.substring(a,n+1),e.includes(i)||e.push(i),a=t.indexOf("${",n),hasMergeField=!0);for(var o=0;o<e.length;o++){var s=e[o];-1!==t.indexOf(s)&&(t=t.replace(new RegExp("\\${"+s.substring(2,s.length-1)+"}","g"),'<span class="hv-merge-field">'+s+"</span>"))}return{usedMergeFields:e,contents:t}}function O(e,t,i,n,a,o,s,r){var d='<div id="hippo-video-compose-box-'+n+'" class="hippo-video" asset-id="'+a+'"  style="width: 100%; max-width: 360px; max-height: '+outerHeight+';" contenteditable="false" ><a href="'+e+'" style="text-decoration: none; pointer-events: none;"><div style="width: 100%; max-width: 360px; max-height: 200px; display: flex; background: #f6f6f6; border-top-left-radius: 5px; border-top-right-radius: 5px; border: 1px solid rgba(117, 117, 117, 0.1);"><span style="width: 100%; min-height: 200px; max-height: 200px;"><img src="'+t+'"  style="max-width : 360px; max-height: 200px ;text-align: center; display: table-cell; margin: auto;"><span style="width: 100%; height: 100%;"></span></span></div><div style="width: 100%; height: 50px; background: #fafafa; border-bottom-left-radius: 5px; border-bottom-right-radius: 5px; border: 1px solid rgba(117, 117, 117, 0.1); border-top: none;"><div style="padding-left: 10px; padding-top: 3px; font-size: 16px; font-weight: bold; letter-spacing: 0.3px; font-family: Open Sans; color: #212121; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">'+i+'</div><div style="padding-left: 10px; letter-spacing: 0.3px; font-family: Open Sans; font-size: 13px; color: #52a8be;">Click to watch video</div></div></a>';return(s||r)&&(d+='<div class="hv-video-actions" style="display:flex;justify-content:center;align-items:center;height:40px;">'+(r?'<div id="'+o+'_hvVideoEditAction" style="width:30px;border-radius:50%;height:30px;background:#2bc5c3;display:flex;justify-content:center;align-items:center;cursor:pointer;margin:0px 10px;" compose-id="'+o+'" pop-type="campaign"><img src="'+chrome.extension.getURL("/images/injected/edit-icon-white.png")+'" style="width:15px;height:15px;pointer-events:none;"></div>':"")+(s?'<div id="'+o+'_hvVideoDeleteAction" style="width:30px;border-radius:50%;height:30px;background:#a6b6c4;display:flex;justify-content:center;align-items:center;cursor:pointer;margin:0px 10px;" compose-id="'+o+'" pop-type="campaign"><img src="'+chrome.extension.getURL("/images/injected/delete-icon-white.png")+'" style="width:13px;height:13px;pointer-events:none;"></div>':"")+"</div>"),d+="</div><br>"}function U(e,t){var i="",n=[],a=[],o=$(pe(e)).find("div[name="+t+"]").find(".afx").length>0;o?(n=$(pe(e)).find("div[name="+t+"]").find(".afx").find('div[draggable="true"]'),i=$(pe(e)).find("div[name="+t+"]").find(".afx").find("input.agP").val()):(n=$(pe(e)).find("textarea[name="+t+"]").parent().find(".vR"),i=$(pe(e)).find("textarea[name="+t+"]").val()),i&&(i=i.trim(),a=i.split(","));for(var s=[],r=0;r<$(n).length;r++){var d=$(n)[r],c=o?$(d).find(".afV").attr("data-hovercard-id"):$(d).find(".vN").attr("data-hovercard-id");a.includes(c)||s.push(c)}return a.length>0&&(s=s.concat(a)),s}function j(e,t){$("#hvGmailGrantAccessPop").length>0&&$("#hvGmailGrantAccessPop").remove(),L("hvGmailGrantAccessPop",!0,[{name:Fe.grantAccess,id:"hvGmailGrantAccessBtn",type:"primary"}]),setTimeout(function(){$("#hvGmailGrantAccessPop").attr("user-email",e),$("#hvGmailGrantAccessPop").attr("compose-id",t),$("#hvGmailGrantAccessPop").find(".hv-wf-pop-body .hv-wf-pop-content").append($(Te.gmailAccessRequest)),$("#hvGmailGrantAccessPop").find(".hv-wf-pop-body .hv-wf-pop-loading").fadeOut(50),me($("#hvGmailGrantAccessPopCancelBtn"),"click",function(e){var t=$("#hvGmailGrantAccessPop").attr("compose-id");$("#hvGmailGrantAccessPop").hide(),$(pe(t+"hvSendBtn")).removeClass("disable-click")}),me($("#hvGmailGrantAccessBtn"),"click",function(e){var t=$("#hvGmailGrantAccessPop").attr("compose-id");H("hvGmailPersonalizationPop","gmail",$("#hvGmailGrantAccessPop").attr("user-email"),{composeId:t}),$("#hvGmailGrantAccessPop").hide(),$(pe(t+"hvSendBtn")).removeClass("disable-click")})},1e3),$(pe(t+"hvSendBtn")).removeClass("disable-click"),$("#hvGmailGrantAccessPop").show()}function L(e,i,n){var a=t();a.createAccessPop=!0,a.messageFromContentScript1234=!0,a.msgType="workflow",a.hasCancelBtn=i,a.buttons=n,a.popId=e,a.screenName=be.screenName,be.port.postMessage(a)}function z(){var e=t();e.createSigninPop=!0,e.messageFromContentScript1234=!0,e.msgType="workflow",e.screenName=be.screenName,be.port.postMessage(e)}function H(e,i,n,a){var o,s;"gmail"===i&&(o="https://www.googleapis.com/auth/gmail.send https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/userinfo.profile",s="gmail");var r,d=ye+"/video/oauth";r=ye.includes("local")?"545792173243-j7c0qsehnht1ncch7hdjpdhh8oqmkitt.apps.googleusercontent.com":ye.includes("stage")?"545792173243-j7c0qsehnht1ncch7hdjpdhh8oqmkitt.apps.googleusercontent.com":"989612280692-8vs3vmbppgd16ijvnk7uf4nrg3404tqv.apps.googleusercontent.com";var c=t();c.messageFromContentScript1234=!0,c.requestGoogleAccess=!0,c.popId=e,c.url="https://accounts.google.com/o/oauth2/auth?access_type=offline&scope="+o+"&client_id="+r+"&redirect_uri="+d+"&response_type=code&state="+s+"&approval_prompt=force&login_hint="+n,c.screenName=be.screenName,c.service=i,c.optionalData=a,be.port.postMessage(c)}function W(e){var i=t();i.messageFromContentScript1234=!0,i.messageType="gmail",i.serviceName=be.serviceName,i.configureGmailAccount=!0,i.authcode=e.authcode,i.scopes=["send","profile"],i.optionalData=e.optionalData,be.port.postMessage(i)}function q(e,t){if(0==$(pe(e+"hvSendBtn")).length){var i=$(pe(e)).find(".iN tbody").first(),n=$(i).find(".aDh"),a=$(n).find("table").find(".btC");$(a).find(".outreach-everywhere").hide();var o,s,r=$(a).find(".gU.Up").length>0;r&&(o=$(i).find(".aDh").find(".gU.Up"),$(o).show(),s=$(o).find(".btA").attr("id"),$(pe(s)).hide()),o=$(i).find(".aDh").find(".gU.Up");var d=$(o).parent(),c=$(d).find('[aria-label*="Discard draft"]').length>0?$(d).find('[aria-label*="Discard draft"]'):$(d).find('[data-tooltip*="Discard draft"]').length>0?$(d).find('[data-tooltip*="Discard draft"]'):$(d).find(".oh.J-Z-I.J-J5-Ji.T-I-ax7"),l=$(c).attr("id"),p=$('<div id="'+e+'hvSendBtn"><div class="T-I-atl hv-send-btn" role="button" tabindex="1" data-tooltip="Mails will be sent separately to all contacts" aria-label="Mails will be sent separately to all contacts" data-tooltip-delay="200" style="user-select: none;">Send via Hippo Video</div></div>');if($(p).attr("close-btn-id",l),$(p).attr("compose-id",e),r)$(o).append($(p));else{var m=$('<div class="gU Up"></div>');$(m).append($(p)),$(a).prepend($(m))}$(pe(e+"hvSendBtn")).attr("pop-id",t),s&&$(pe(e+"hvSendBtn")).attr("gmail-send-btn",s),me($(pe(e+"hvSendBtn")),"click",function(e){e.stopPropagation(),e.preventDefault(),D(e)})}}function J(e){ge("Video Edit Btn in Compose Clicked");var t=$(e.currentTarget).attr("compose-id");Z($(e.currentTarget).attr("pop-id"),t)}function Z(e,t){var i=$("#"+e).data("workflowConfig");0==$("#"+e).length||$("#"+e).attr("compose-id")!==t?ee(i):te(i,"hv-create-video","edit")}function K(e){ge("Video Delete Btn in Compose Clicked"),X($(e.currentTarget).attr("pop-id"),$(e.currentTarget).attr("compose-id"))}function X(e,t){$(pe(t)+"_asset_content").remove();var i=$(pe(t)).find(".iN tbody").first(),n=$(i).find(".ZyRVue").find(".Ar.Au").find(".Am.Al.editable.LW-avf").attr("id");$(pe(n)).find(".hippo-video").remove(),p(t,!0),Q(t),$("#"+e).remove();var a=$(pe(t)).find("form").attr("id"),o=le(a);$(pe(o)).find(pe(t+"_hvICBtnToBox")).remove();var s=$(pe(a)).find(".aoD.hl").attr("id");if($(pe(s)).find(pe(t+"_hvICBtnRecipientBox")).remove(),$(pe(t+"_hvSubTemplateBtn")).remove(),$(pe(t)).removeData("workflowConfig"),$(pe(t+"hvSendBtn")).length>0){var r=$(pe(t+"hvSendBtn")).attr("gmail-send-btn"),d=$(pe(r)).closest("tr");$(d).find(".outreach-everywhere").length>0?$(d).find(".outreach-everywhere").show():$(pe(r)).show(),$(pe(t+"hvSendBtn")).remove()}}function Y(e){var t=$(pe(e)).find('.hv-bottom-menu .hv-bottom-menu-option[action="sales"]'),i=$(pe(e)).find('.hv-bottom-menu .hv-bottom-menu-option[action="campaign"]');$(t).attr("action","edit"),$(i).attr("action","delete"),$(t).find("span").text(Fe.editVideo),$(i).find("span").text(Fe.deleteVideo)}function Q(e){var t=$(pe(e)).find('.hv-bottom-menu .hv-bottom-menu-option[action="edit"]'),i=$(pe(e)).find('.hv-bottom-menu .hv-bottom-menu-option[action="delete"]');$(t).attr("action","sales"),$(i).attr("action","campaign"),$(t).find("span").text(Fe.createOneToOneVideo),$(i).find("span").text(Fe.createPersonalizedVideo)}function ee(e){te(e,"hv-create-video","edit")}function te(e,i,n){e.openPopConfig={targetScreen:i,targetMode:n};var a=t();a.messageFromContentScript1234=!0,a.msgType="workflow",a.payload=e,a.openWorkflowPop=!0,be.port.postMessage(a)}function ie(e,t){0===$(pe(e)+"_asset_content").length?$(pe(e)).append('<div id="'+e+'_asset_content"></div>'):$(pe(e)+"_asset_content").empty(),$(pe(e)+"_asset_content").attr("asset-id",t.isPage?t.pageAssetId:t.assetId);for(var i in t)"html"!==i&&($(pe(e)+"_asset_content").append('<input type="hidden" name="'+i+'">'),$(pe(e)+"_asset_content").find('input[name="'+i+'"]').val(JSON.stringify(t[i])))}function ne(e,t){var i=$(pe(e)).data("workflowConfig"),n=i.assetContent;return n.isPage?ye+"/video-page/view/"+n.pageId+"?tag=campaign_reports&campaign_id="+t:"sales"===n.popType&&n.mfInVideo&&n.mfInVideo.length>0?ye+"/people/home":ye+"/video/view/"+n.assetId+"?tag=campaign_reports&campaign_id="+t}function ae(e){var t=e.composeId,i=$(pe(t)).data("workflowConfig"),n=i.assetContent,a=n.popType,o="sales"===a&&n.mfInVideo&&n.mfInVideo.length>0,s=n.videoShareUrl,r=n.thumbnailShareUrl;n.utm_content&&(s+=s.includes("?")?"&utm_source=gmail&utm_content="+n.utm_content:"?utm_source=gmail&utm_content="+n.utm_content,n.thumbnailPersonalised||n.isPage?r+=r.includes("?")?"&utm_source=gmail&utm_content="+n.utm_content:"?utm_source=gmail&utm_content="+n.utm_content:n.isPage||n.customPageDetails?r+=r.includes("?")?"&utm_source=gmail&utm_content="+n.utm_content:"?utm_source=gmail&utm_content="+n.utm_content:r=n.thumbnail_url);var d,c=$(pe(t)).find(".iN tbody").first(),l=$(c).find(".ZyRVue").find(".Ar.Au").find(".Am.Al.editable.LW-avf").attr("id"),p=$(pe(l)).clone(),m=$(p)[0].innerHTML,u=n.customPageDetails,f=n.isPage;d=!f&&u?u.pageAssetId:f?n.pageAssetId:n.assetId;var v=O(s,r,n.videoTitle,n.deliveryToken,d,t,"campaign"===a||o,("campaign"===a||o)&&!n.isPage);m=m.replace(new RegExp("\\${asset-"+d+"}"),v),$(pe(l))[0].innerHTML=m}function oe(e,i,n){var a=t();a.messageFromContentScript1234=!0,a.messageType="gmail",a.getUTMToken=!0,a.popId=e,a.content=i,a.params=n,a.serviceName=be.serviceName,be.port.postMessage(a)}function se(e){var t=$(e.currentTarget).attr("compose-id"),i=$(pe(t)).find(".iN tbody").first(),n=$(i).find(".ZyRVue").find(".Ar.Au").find(".Am.Al.editable.LW-avf").attr("id"),a=$(pe(n)).find(".hippo-video");$(a).find(".hv-video-actions").remove();var o=$(pe(t)).find("form").attr("id"),s=le(o),r=U(s,"to");if(r.length>0){var d,c,l,p=$(pe(t)).attr("compose-type");if($(a).length>0&&!$(a).hasClass("hv-mail-via-gmail-addon")){var m=$(a).attr("asset-id");if(l=$(pe(t)+"_asset_content"),$(l).length>0&&$(l).attr("asset-id")==m){M(l,"utm_content")&&(d=m)}}else for(var u=$(pe(n)).find("div"),f=0;f<$(u).length;f++){var v=$(u)[f],g=$(v).attr("id");if(g&&g.match(/hippo-video-compose-box/)){var h=$(v).attr("class").includes("hv-mail-via-gmail-addon");if(h){p="hv-gmail-addon";var b=$(v).attr("id"),_=b.indexOf("hippo")+24,w=b.substring(_,b.length);c=w}}}if(d||c){var C={};if(d){C.thread_id=M(l,"thread_id"),C.message_id=M(l,"message_id"),C.legacy_thread_id=M(l,"legacy_thread_id"),C.template_id=M(l,"templateId");var x=M(l,"customPageDetails");!M(l,"isPage")&&x?(C.assets=[Number(x.pageAssetId)],C.customAsset=Number(d),C.customPageAssetId=x.pageAssetId,C.customPageId=x.pageId):C.assets=[Number(d)]}else c&&(C.thread_id=$(pe(t)+" input[name=rt]").val(),C.message_id=$(pe(t)+" input[name=draft]").val(),C.legacy_thread_id=$(pe(t)+" input[name=lts]").val(),C.delivery_tokens=[c]);C.compose_type=p,C.to_mails=r.join(","),C.cc_mails=U(s,"cc").join(","),C.bcc_mails=U(s,"bcc").join(","),C.subject=$(pe(o)).find("input[name=subject]").val(),re(C)}}}function re(e){var i=t();i.messageFromContentScript1234=!0,i.messageType="gmail",i.saveMailMetaData=!0,i.params=e,i.serviceName=be.serviceName,be.port.postMessage(i)}function de(){var e=new MouseEvent("mousedown"),t=new MouseEvent("mouseup"),i=document.getElementsByClassName("T-I-KE")[0];i.dispatchEvent(e),i.dispatchEvent(t)}function ce(){$(".nr.wR span").click()}function le(e){return $(pe(e)).find(".fX.aiL").length>0?$(pe(e)).find(".fX.aiL").attr("id"):$(pe(e)).find(".fX.aXjCH").attr("id")}function pe(e){
return":"==e.charAt(0)?"#\\"+e:"#"+e}function me(e,t,i){$(e).off(t).on(t,function(e){try{i(e)}catch(e){ue(e)}})}function ue(e){"Extension context invalidated."==e.message?fe():console.log(e)}function fe(){ve(Fe.refreshPage,!0,Fe.refresh,1e4,!0)}function ve(e,t,i,n,a,o){var s=$(Te.gmailAlertMsgEle);$(s).find(".bAq").text(e),$(s).find("#hvGmailAlertActionBtn").text(i),$(s).find("#hvGmailAlertActionBtn").attr("is-refresh",t),$(s).find("#hvGmailAlertActionBtn").attr("link-url",a),o&&$(s).find(".bAo").append($('<span class="ag a8k" id="hvGmailAlertCloseBtn" tabindex="0" role="link">'+Fe.close+"</span>")),$(".b8.UC .vh").empty().append($(s)),$(".b8.UC").addClass("bAp"),setTimeout(function(e){$(".b8.UC").removeClass("bAp");var t=$(".b8.UC").attr("style")||"";t+="position: relative; top: -10000px;",$(".b8.UC").attr("style",t)},n),$("#hvGmailAlertActionBtn").off("click").on("click",function(e){if("true"==$("#hvGmailAlertActionBtn").attr("is-refresh"))window.location.reload();else{var t=$("#hvGmailAlertActionBtn").attr("link-url");t&&window.open(t)}}),o&&$("#hvGmailAlertCloseBtn").off("click").on("click",function(e){$(".b8.UC").removeClass("bAp");var t=$(".b8.UC").attr("style")||"";t+="position: relative; top: -10000px;",$(".b8.UC").attr("style",t)})}function ge(e){e=be.logPrefix+" "+e,be.port.postMessage({trackDynamicIntegActivity:!0,integType:"gmail",serviceName:be.serviceName,actionName:e,messageFromContentScript1234:!0})}function he(e,i,n){var a=t();a.messageFromContentScript1234=!0,a.flashAlertInWorkflowPop=!0,a.msgType="workflow",a.popId=e,a.msg=i,a.alertType=n,be.port.postMessage(a)}function $e(e){0==$("#hvBannerAlert").length&&$("body").append($(Te.bannerEle)),e.isError?$("#hvBannerAlert").removeClass("hv-banner-success").addClass("hv-banner-failure"):$("#hvBannerAlert").removeClass("hv-banner-failure").addClass("hv-banner-success"),$("#hvBannerAlert")[0].innerHTML=e.message,$("#hvBannerAlert").slideDown("ease"),setTimeout(function(){$("#hvBannerAlert").slideUp("ease")},4e3)}var be=function(){var t={};return t.serviceName=e("hvIntegName"),t.windowId=Number(e("hvWindowId")),t.tabId=Number(e("hvTabId")),t.logPrefix=" GP :: ",t.port=chrome.extension.connect({name:t.serviceName+"::"+t.windowId+"::"+t.tabId}),t}();!function(){var e=t();e.messageFromContentScript1234=!0,e.injectHvWorkflowScripts=!0,be.port.postMessage(e)}();var _e,we=!1,Ce=!1,xe=!1,ye="cijidiollmnkegoghpfobabpecdkeiah"===chrome.runtime.id?"https://www.hippovideo.io":"dnebjjdbjiikcmihpkcanphpbibhofkh"===chrome.runtime.id?"https://stage.hippowiz.com":"http://localhost:3000",Ae=/(?!.*\.{2})^([a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+(\.[a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+)*|"((([ \t]*\r\n)?[ \t]+)?([\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|\\[\x01-\x09\x0b\x0c\x0d-\x7f\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))*(([ \t]*\r\n)?[ \t]+)?")@(([a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.)+([a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.?$/i,Fe={leftMenuSalesBtn:"1-1 Sales Video",leftMenuVidCampBtn:"Video Campaign",leftMenuSalesBtnTooltip:"Send 1-1 Sales Video",leftMenuVidCampBtnTooltip:"Send a video email campaign",createOneToOneVideo:"SEND 1-1 VIDEO",createPersonalizedVideo:"SEND VIDEO CAMPAIGN",childCampaignErrMsg:"Unable to initiate campaign from selected group",wentWrong:"Something went wrong! Please contact support@hippovideo.io",fillToMails:"Uh oh! Your ‘To’ field looks empty. Please add your contacts email addresses to continue.",videoNotPresent:"No video present in the mail.",gmailAccessRequestContent:"Before we get started, allow Hippo Video to access your Mail account to send emails on behalf of you.",changeTemplate:"Change Template",chooseTemplate:"Choose Template",ImportContacts:"Import Contacts",editContacts:"Edit Contacts",importContactsMsg:"Click Import Contacts to add/import to mails",refreshPage:"We've released cool new updates. Please reload the page to view them.",refresh:"REFRESH",grantAccess:"GRANT ACCESS",editVideo:"EDIT VIDEO",deleteVideo:"DELETE VIDEO",close:"CLOSE"},Te={leftMenuDropDownEle:'<div class="hv-left-menu-drop-down" id="hvLeftMenuDropDown"><img src="'+chrome.extension.getURL("/images/injected/drop-down-arrow-grey.svg")+'"></div>',salesDropDownBtn:'<div id="hvSendOneToOneVideo" class="hv-sales-option hv-left-menu-option" data-tooltip="'+Fe.leftMenuSalesBtnTooltip+'"><img src="'+chrome.runtime.getURL("/images/injected/video-icon-orange.svg")+'" /><span>'+Fe.leftMenuSalesBtn+"</span></div>",videoCampaignDropDownBtn:'<div id="hvSendVideoCampaign" class="hv-vid-camp-option hv-left-menu-option" data-tooltip="'+Fe.leftMenuVidCampBtnTooltip+'"><img src="'+chrome.runtime.getURL("/images/injected/campaigns-icon-orange.svg")+'" /><span>'+Fe.leftMenuVidCampBtn+"</span></div>",bottomMenuTypeOne:'<div class="hv-bottom-menu hv-menu-type-one"><div class="hv-bottom-menu-option hv-menu-option-type-one" action="sales"><span>'+Fe.createOneToOneVideo+'</span></div><div class="hv-bottom-menu-option hv-menu-option-type-one" action="campaign"><span>'+Fe.createPersonalizedVideo+"</span></div></div>",bottomMenuTypeTwo:'<td class="inboxsdk__compose_actionToolbar gU "><div class="hv-bottom-menu" style="display:flex;"><div class="inboxsdk__composeButton hv-bottom-menu-option" style="display:inline-flex;" action="sales" aria-label="'+Fe.createOneToOneVideo+'" role="button" tabindex="1" data-tooltip="'+Fe.createOneToOneVideo+'" data-order-hint="0"><div class="inboxsdk__button_icon"><img class="inboxsdk__button_iconImg" src="https://hippolms-wiz-static.s3.amazonaws.com/images/gmail_add_on/video-icon-orange.svg"></div></div><div class="inboxsdk__composeButton  hv-bottom-menu-option" style="display:inline-flex;" action="campaign" aria-label="'+Fe.createPersonalizedVideo+'" role="button" tabindex="1" data-tooltip="'+Fe.createPersonalizedVideo+'" data-order-hint="0"><div class="inboxsdk__button_icon hippo-compose-button"><img class="inboxsdk__button_iconImg" src="'+chrome.extension.getURL("/images/injected/campaign-flow-option.svg")+'"></div></div></div></td>',bannerEle:'<div id="hvBannerAlert" class="hv-banner-alert"></div>',gmailAccessRequest:'<div class="gmail-access-pop-content"><div class="img-container"><img src="'+chrome.extension.getURL("/images/injected/gmail_icon.png")+'"></div><div class="text">'+Fe.gmailAccessRequestContent+"</div></div>",gmailAlertMsgEle:'<span class="aT"><span class="bAq"></span><span class="bAo">&nbsp;&nbsp;<span class="ag a8k" id="hvGmailAlertActionBtn" tabindex="0" role="link"></span></span></span>'};MutationObserver=window.MutationObserver||window.WebKitMutationObserver,new MutationObserver(function(e,t){for(var i in e){var n=e[i];"1"!=$(".D.E.G-atb").css("z-index")&&$(".D.E.G-atb").css("z-index",1),$(n.target).hasClass("bvY")&&"Hippo Video"==$(n.target).find(".brC-brG-K7-LJ").first().text()&&a(n),$(n.target).hasClass("aoP")&&$(n.target).hasClass("HM")&&s(n),$(n.target).hasClass("aoP")&&$(n.target).hasClass("aoC")&&o(n)}}).observe(document,{subtree:!0,childlist:!0,attributes:!0}),setTimeout(function(){var e=t();e.getVideoToBeAttached=!0,e.messageFromContentScript1234=!0,e.messageType="gmail",be.port.postMessage(e)},3e3),setTimeout(function(){var e=t();e.checkToOpenSalesFlow=!0,e.messageFromContentScript1234=!0,e.messageType="gmail",be.port.postMessage(e)},3e3),$(document).on("click",function(e){try{$(e.target).hasClass("notification-view")||($(".recent-notifications-container").remove(),$(".hv-notifications-right-arrow").remove(),$("#hv-notification").parent().css("background-color","#ffffff"),$("#hv-notification-icon").attr("src",chrome.extension.getURL("/images/injected/bell-icon.svg")))}catch(e){}});var Ie=0,ke=setInterval(function(){++Ie;var e=$(document).find("div[data-ogsr-up]");1===$(e).length&&($(document).find("div[data-ogsr-up]").attr("hippo-user-profile-dom",!0),i($(e)[0]));var t=$(document).find(".nH.oy8Mbf.nn.aeN");(Ie>100||1===$(e).length&&1==$(t).length&&1==$(".T-I-KE").length)&&clearInterval(ke)},500);be.port.onMessage.addListener(function(e,t,i){if(e){var a=e.backgroundRecordingMessage,o=e.data,s=e.data?e.data.payload||{}:{};if("openGmailReplyBox"==a&&s.tabId==be.tabId&&(o.isVideoToBeAttached&&(_e=o.videoToBeAttached),ce()),"openSalesFlow"==a&&o.tabId==be.tabId&&(we=!0,de()),"openGmailComposeBox"==a&&s.tabId==be.tabId&&(o.isVideoToBeAttached&&(_e=o.videoToBeAttached),de()),s&&s.windowId==be.windowId&&s.tabId==be.tabId){if("showSignUpPop"==a&&z(),"showGmailBannerAlert"==a&&$e(s),"openVideoCampaignCompose"==a)if(o.status&&o.response.status){var r=o.response;composeOpenedFromVideoCampaigns=!0,mailsToFillComposeBox={mails:r.mails,parent_camapign_id:r.id,campaign_triggered_from:r.triggered_from},$("#hvSendVidCampBtnContainer").mouseup()}else $e({isError:!0,message:Fe.childCampaignErrMsg});"askToRefreshGmail"==a&&fe()}if("currentRecordingStatus"==a&&(xe=e.data.isRecording),n(e)&&("insertFromWorkflowPop"==a&&x(e.data),"fetchGmailAccountsResponse"==a&&o.screenName==be.screenName&&(o.status?E(o):($(pe(o.composeId+"hvSendBtn")).removeClass("disable-click"),$e({isError:!0,message:"Error while fetching gmail account info"})))),"insertVideoInComposeBox"==a&&(o.status?y(o.popId,o.content):($("#"+o.popId).find(".hv-wf-pop-body .hv-wf-pop-loading").fadeOut(10),he(o.popId,Fe.wentWrong,"error"))),"googleAccessResponse"==a&&o.serviceName==be.serviceName&&(o.status?"gmail"===o.service&&W(o):($(pe(o.optionalData.composeId+"hvSendBtn")).removeClass("disable-click"),$e({isError:!0,message:"Access denied"}))),"configureGmailAppResponse"==a&&o.serviceName==be.serviceName&&(o.status&&o.response.status?P(o.optionalData.composeId):($(pe(o.optionalData.composeId+"hvSendBtn")).removeClass("disable-click"),$e({isError:!0,message:"Error while configuring Gmail account."}))),"sendMailResponse"===a)if(o.status){var d=o.response;if(d.status){var c=ne(o.composeId,d.campaign_id),l=$(pe(o.composeId+"hvSendBtn")).attr("close-btn-id");$(pe(l)).click(),setTimeout(function(e){d.fromBackgroundJob?ve("Campaign initiated successfully for "+d.to_mails_count+" contacts.",!1,"VIEW REPORTS",1e4,c,!0):ve("Campaign launched successfully for "+d.to_mails_count+" contacts.",!1,"VIEW REPORTS",1e4,c,!0)},200)}else"limit_exceeded"==d.msg?d.already_sent>0?ve("You have already sent "+d.already_sent+" personalized video emails. Limit exceeded!",!1,"UPGRADE",1e4,"https://www.hippovideo.io/settings/subscription",!0):ve("Upgrade your account to send personalized video emails.",!1,"UPGRADE",1e4,"https://www.hippovideo.io/settings/subscription",!0):"upgrade"==d.msg?ve("Upgrade your account to send personalized video emails.",!1,"UPGRADE",1e4,"https://www.hippovideo.io/settings/subscription",!0):$e({message:d.msg||Fe.wentWrong,isError:!1}),$(pe(o.composeId+"hvSendBtn")).removeClass("disable-click"),ae(o)}else $e({message:Fe.wentWrong,isError:!0}),$(pe(o.composeId+"hvSendBtn")).removeClass("disable-click"),ae(o);"video-to-be-attached"==a&&(_e=o.videoToBeAttached)&&("compose"==_e.composeType?de():"reply"===_e.composeType&&ce())}}),function(){var e=t();e.messageFromContentScript1234=!0,e.getRecordingStatus=!0,be.port.postMessage(e)}()}));