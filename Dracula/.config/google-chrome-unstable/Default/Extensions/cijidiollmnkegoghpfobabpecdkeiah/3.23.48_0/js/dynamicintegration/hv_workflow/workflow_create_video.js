document.getElementById("hv-workflow-create-video-injected")||($('<input type=hidden id="hv-workflow-create-video-injected" value=true />').appendTo("body"),$(document).ready(function(){function e(e){var t=document.getElementById(e);if(t&&t.getAttribute("value"))return t.getAttribute("value")}function t(){return{serviceName:ot.serviceName,windowId:ot.windowId,tabId:ot.tabId}}function i(){var e=t();e.messageFromContentScript1234=!0,e.startCountDownGeneral=!0,ot.port.postMessage(e)}function o(e){var i=t();i.messageFromContentScript1234=!0,i.msgType="workflow",i.markRecordingStatus=!0,i.isRecording=e,ot.port.postMessage(i)}function n(e,t,i){var o=new RegExp("([?&])"+t+"=.*?(&|$)","i"),n=-1!==e.indexOf("?")?"&":"?";return e.match(o)?e.replace(o,"$1"+t+"="+i+"$2"):e+n+t+"="+i}function a(e,t,i,o){var n=e.project_json,a=e.record_configuration||{};if($("#"+t.popId).find(".hv-wf-pop-body .hv-wf-pop-loading").fadeOut(50),m(t.popId),a.projectJson=n,t.recordConfiguration=a,p(t.popId),i)d({action:t.logPrefix+" Video Created"}),c(t.popId),s(t.popId,"New Recording"),t.recordConfiguration=o.record_configuration,n=o.project_json,messageEmbeddedFrame("hv_record_completed",{recording_configuration:t.recordConfiguration,asset_id:t.assetContent.assetId,from:"dynamic_integ",thumbnailUrl:rt+"/video/thumbnail/"+t.assetContent.deliveryToken+"?is_play=false"}),messageEmbeddedFrame("hv_preprocess_complete",{project_json:n,from:"dynamic_integ"}),messageEmbeddedFrame("dynamic_integ_data",{initiator:t.recordConfiguration.initiator,share_url:t.recordConfiguration.recordedURL}),messageEmbeddedFrame("hv_wf_personalization",{isNewVideo:i,assetId:t.assetContent.assetId}),v(t.popId),f(n)?($(".hv-virtual-bg-btn-container").attr("vbg-enabled","true"),g(t.popId)):$(".hv-virtual-bg-btn-container").attr("vbg-enabled","false"),t.savedSimpleEdit=!1;else{G(t.popId);var h=e.is_image,u=!1;if(h||!n||n.advancedEdit||n.slideshow||(u=!0),u){c(t.popId),s(t.popId,e.title),messageEmbeddedFrame("show_dynamic_integ_loading",{});var w=e.footage_urls||{};messageEmbeddedFrame("hv_show_asset_preview",{recordConfiguration:t.recordConfiguration,assetId:t.assetContent.assetId,authoringId:e.authoring_id,integrationType:"workflow",projectJson:n,shareUrl:e.share_url,mediaId:e.media_id,duration:e.duration,footageUrls:w,isPersonalisationEnabled:e.is_personalisation_enabled,thumbnailUrl:rt+"/video/thumbnail/"+t.assetContent.deliveryToken+"?is_play=false"}),v(t.popId),f(n)?($(".hv-virtual-bg-btn-container").attr("vbg-enabled","true"),g(t.popId)):$(".hv-virtual-bg-btn-container").attr("vbg-enabled","false"),t.savedSimpleEdit=!1}else l(t.popId),m(t.popId),$("#"+t.popId).find(".create-video-content").hide(),$("#"+t.popId).find(".hv-edit-video-container").show(),$("#"+t.popId).find(".hv-edit-video-container .hv-video-preview-outer-container .left-container").hide(),0==$("#"+t.popId).find(".hv-edit-video-container .hv-video-preview-outer-container .edit-not-allowed-screen").length&&($(ct.proEditNotAllowedScreen).insertBefore($("#"+t.popId).find(".hv-edit-video-container .hv-video-preview-outer-container .right-container")),$("#"+t.popId).find(".hv-edit-video-container .edit-not-allowed-screen .goto-pro-edit-btn").attr("asset-id",t.assetContent.assetId).attr("log-prefix",t.logPrefix),$("#"+t.popId).find(".hv-edit-video-container .goto-pro-edit-btn").off("click").on("click",function(e){var t=$(e.currentTarget).attr("asset-id"),i=$(e.currentTarget).attr("log-prefix");r(t),Ge(i,"Go-To-ProEdit Button In Simple Edit Clicked")}),l(t.popId),m(t.popId)),$("#"+t.popId).find(".hv-edit-video-container .edit-not-allowed-screen").show()}$("#"+t.popId).find(".hv-wf-pop-body .hv-wf-pop-loading").fadeOut(10),We(t)}function r(e){var i=t();i.messageFromContentScript1234=!0,i.openUrl=!0,i.url=rt+"/video/edit/"+e,ot.port.postMessage(i)}function d(e){var i=t();i.msgType="workflow",i.messageFromContentScript1234=!0,i.trackAction=!0,i.actionPerformed=e.action,ot.port.postMessage(i)}function s(e,t){$("#"+e).find("#hvVideoTitleContainer input").attr("pop-id",e),$("#"+e).find("#hvVideoTitleContainer input").val(t)}function c(e){$("#"+e).find("#hvVideoTitleContainer").show(),$("#"+e).find("#hv-wf-embed-iframe").css("height","70%")}function p(e){$("#"+e).find("#editInsertVideoBtn").show(),$("#"+e).find("#editContinueBtn").show()}function l(e){$("#"+e).find(".hv-edit-and-personalize-btn").hide(),$("#"+e).find("#hv-wf-embed-iframe").css("height","90%")}function v(e){$("#"+e).find(".hv-edit-and-personalize-btn").show(),$("#"+e).find("#hv-wf-embed-iframe").css("height","70%")}function f(e){var t=!1,i=!1;if(e&&e.clips)for(var o=0;o<e.clips.length;o++)"webcam"==e.clips[o].footage.type&&e.clips[o].footage.containsVideo?t=!0:"screenrecord"==e.clips[o].footage.type&&(i=!0);return t&&!i}function g(e){$("#"+e).find(".hv-virtual-bg-btn-container").show(),$("#"+e).find(".hv-virtual-bg-btn-container").css("margin-left","-45%")}function m(e){$("#"+e).find(".hv-virtual-bg-btn-container").hide()}function h(e){0==$("#"+e.popId).find(".customize-component").length&&k(e.popId),e.assetContent.modes?e.assetContent.modes.includes("edit")||e.assetContent.modes.push("edit"):e.assetContent.modes=["edit"],G(e.popId),Re(e.popId),l(e.popId),m(e.popId);var t=$("#"+e.popId);t.find(".create-video-content").hide(),t.find(".hv-wf-pop-header .hv-pop-topbar-ele").removeClass("tp-selected"),t.find(".hv-wf-pop-header .hv-edit-video").addClass("tp-selected"),t.find(".hv-wf-pop-header .hv-edit-video").removeClass("click-not-allowed"),t.find(".hv-create-video-container .hv-edit-video-container").show(),t.find(".hv-create-video-container .hv-edit-video-container").attr("data-enabled",!0),t.show()}function u(e){var t=$("#"+e.popId).data("workflowConfig");if("create"===e.mode){$("#"+t.popId).find(".hv-wf-pop-header .hv-pop-topbar-ele").removeClass("tp-selected"),$("#"+t.popId).find(".hv-wf-pop-header .hv-create-video").addClass("tp-selected");var i=!1;if(0==$("#"+t.popId).find(".hv-wf-pop-body .hv-wf-pop-content .hv-create-video-container").length&&(b(t),i=!0),G(t.popId),$("#"+t.popId).find(".hv-wf-pop-body .hv-wf-pop-content").find(".hv-pop-content-container").hide(),$("#"+t.popId).find(".hv-wf-pop-body .hv-wf-pop-content").find(".hv-create-video-container").show(),i)"sales"==t.popType?R(t.popId,t.logPrefix,t.planParams.isVideoPagesEnabled&&t.popConfig.showVideoPageLibrary,t.popConfig.showTemplatesOption):C(t.popId,"personalized-video-library",t.planParams.isVideoPagesEnabled&&t.popConfig.showVideoPageLibrary,t.logPrefix,t.popConfig.showTemplatesOption);else{var o=$("#"+t.popId).find(".hv-create-video-container .library-view").length>0;$("#"+t.popId).find(".hv-create-video-container .create-video-content").hide(),o?($("#"+t.popId).find(".hv-create-video-container .library-view").show(),Re(t.popId),Ee(t.popId),Be(t.popId)):($("#"+t.popId).find(".hv-create-video-container .record-preview-screen").show(),$("#"+t.popId).find(".hv-create-video-container").find(".vid-preview-container iframe").attr("src",at),Re(t.popId))}}else"edit"==e.mode&&(_(t.popId),0===$("#"+t.popId).find(".hv-wf-pop-body .hv-wf-pop-content").find(".hv-create-video-container").length&&(b(t),G(t.popId)),$("#"+t.popId).find(".hv-wf-pop-body .hv-wf-pop-content").find(".hv-pop-content-container").hide(),$("#"+t.popId).find(".hv-wf-pop-body .hv-wf-pop-content").find(".hv-create-video-container").show(),$("#"+t.popId).find(".hv-wf-pop-body .hv-wf-pop-loading").fadeIn(10),w(t,!1),Re(t.popId),p(t.popId))}function w(e,i,o){var n=t();n.msgType="workflow",n.messageFromContentScript1234=!0,n.fetchVideoDetails=!0,n.workflowConfig=e,n.isNewVideo=i,n.optionalData=o,ot.port.postMessage(n)}function b(e){$("#"+e.popId).find(".hv-wf-pop-body .hv-wf-pop-content").append($(ct.createVideoContainer)),$("#"+e.popId).find(".hv-create-video-container").append($(ct.editVideoContainer)).append($(ct.screenRecContainer)),l(e.popId),m(e.popId),$("#"+e.popId).find("#hvRecordScreenGoToLibBtn").attr("pop-id",e.popId).attr("log-prefix",e.logPrefix),$("#"+e.popId).find("#hvRecordScreenGoToLibBtn").off("click").on("click",function(t){var i=$(t.currentTarget).attr("pop-id");$("#"+i).find(".create-video-content").hide();var o=$(t.currentTarget).attr("log-prefix");C(i,"video-library",e.planParams.isVideoPagesEnabled&&e.popConfig.showVideoPageLibrary,e.logPrefix,e.popConfig.showTemplatesOption),Ge(o,"Choose From Library Clicked in Advanced Record Screen")}),$("#"+e.popId).find("#hvVideoTitleContainer input").attr("pop-id",e.popId),$("#"+e.popId).find("#hvVideoTitleContainer input").off("change").on("change",me),oe(e.popId,e.logPrefix,e.popConfig.showTemplatesOption)}function C(e,t,i,o,n){var a="all";if(Re(e),0==$("#"+e).find(".hv-create-video-container .library-view").length){$("#"+e).find(".hv-create-video-container").append($(ct.libraryViewScreen));var r=$("#"+e).find(".hv-create-video-container .library-view");r.append($(ct.libraryView)).append($(ct.videoCategoryDiv)).append($(ct.emptyVideoListingContainer)).append($(ct.libraryLoading)),i&&r.find(".library-menu").append($(ct.videoLandingPageLib)),ze(e),Le(r,e,o,n),Pe(e),Te(e,o,i,n),z(e),xe(e),$("#"+e).find("#libraryInsertVideoBtn span").attr("pop-id",e),$("#"+e).find("#libraryInsertVideoBtn span").off("click").on("click",he),$("#"+e).find("#videoLibraryContinueBtn span").attr("pop-id",e).attr("log-prefix",o),$("#"+e).find("#videoLibraryContinueBtn span").off("click").on("click",ye)}else a=$("#"+e).find("#hvPopVidCategorySelect").val(),$("#"+e).find("#hvPopVidCategorySelect").empty(),$("#"+e).find("#hvPopVidCategorySelect").append('<option value="all">All Videos</option>'),$("#"+e).find(".hv-create-video-container .library-view").find(".lib-vid-list-container").empty(),t=$("#"+e).find(".library-menu").find(".selectable-menu-item-selected").attr("library-type");$("#"+e).find("#videoSearchBar").attr("pop-id",e),$("#"+e).find("#hvSearchIcon").attr("pop-id",e),$("#"+e).find("#videoSearchBar").keypress(function(e){13==e.keyCode&&y(e)}),$("#"+e).find("#hvSearchIcon").off("click").on("click",function(e){y(e)}),I(e,a),$("#"+e).find(".lib-menu-item").removeClass("selectable-menu-item-selected"),$("#"+e).find(".hv-create-video-container .create-video-content").hide(),$("#"+e).find(".hv-create-video-container .library-view").show(),$("#"+e).find(".lib-menu-item[library-type="+t+"]").click(),Ee(e)}function y(e){var t=$(e.currentTarget).attr("pop-id"),i=$("#"+t).find("#videoSearchBar").val(),o=$("#hvPopVidCategorySelect").val(),n=$(".selectable-menu-item-selected").attr("library-type");if(i&&i.length>0)Ye(t,i,o,0,n);else{var a=$("#"+t).find(".hv-create-video-container .library-view");$(a).find(".lib-vid-list-container").empty(),$(a).find(".empty-vid-list-container").removeClass("display-flex");var r=$("#"+t).find(".library-menu .selectable-menu-item-selected").attr("library-type");Ae(t,$("#"+t).find("#hvPopVidCategorySelect").val(),0,r)}}function I(e,i){var o=t();o.messageFromContentScript1234=!0,o.msgType="workflow",o.fetchVideoCategories=!0,o.popId=e,o.category=i,ot.port.postMessage(o)}function k(e){var t=$("#"+e).data("workflowConfig");$("#"+t.popId).find(".hv-edit-video-container .hv-video-preview-outer-container .left-container").show(),$("#"+t.popId).find(".hv-edit-video-container .hv-video-preview-outer-container .edit-not-allowed-screen").hide(),t.popConfig.showCustomizeComponent?($("#"+e).find(".hv-create-video-container .hv-video-preview-outer-container .right-container").append($(ct.customizeComponent)),t.popConfig.showLandingPageComponent?V(e):($("#"+e).find('.customize-component .headers .header[target="landingPageComponent"]').remove(),$("#"+e).find('.customize-component .headers .header[target="customizeThumbnailComponent"]').addClass("active-header"),$("#"+e).find("#landingPageComponent").remove(),$("#"+e).find("#customizeThumbnailComponent").show(),T(e)),$("#"+e).find(".customize-component").attr("pop-id",e),$("#"+e).find(".customize-component .headers .header").unbind("click").bind("click",function(e){if(!$(e.currentTarget).hasClass("active-header")){var t=$(e.currentTarget).parent().parent().attr("pop-id"),i=$(e.currentTarget).attr("target");$(e.currentTarget).parent().find(".active-header").removeClass("active-header"),$(e.currentTarget).parent().parent().find(".component-area .active-component").removeClass("active-component"),$(e.currentTarget).addClass("active-header"),$(e.currentTarget).parent().parent().find(".component-area #"+i).addClass("active-component"),"landingPageComponent"==i?V(t):"customizeThumbnailComponent"==i&&T(t)}})):$("#"+e).find(".hv-create-video-container .hv-video-preview-outer-container .right-container").empty().hide()}function _(e){$("#"+e).find(".hv-create-video-container .hv-video-preview-outer-container .right-container").empty()}function T(e){if(0==$("#"+e).find("#customizeThumbnailComponent").find(".thumbnail-component").length){$("#"+e).find(".customize-component .customize-component-loading").show();var t=$("#"+e).data("workflowConfig");$("#"+e).find("#customizeThumbnailComponent").append($(ct.customizeThumbnailComponent)),x(e,t.assetContent.assetId)}}function P(e,t,i,o){if($("#"+t).find("#customizeThumbnailComponent").find(".thumbnail-component").removeAttr("disabled").empty(),$("#"+t).find("#customizeThumbnailComponent").find(".thumbnail-component").attr("asset-id",o).attr("pop-id",t),e)i.thumbnail_data.default_thumbnail&&S(t,"DEFAULT",i.thumbnail_data.default_thumbnail,1),i.thumbnail_data.frame_thumbnail&&S(t,"CHOSEN FROM FRAME",i.thumbnail_data.frame_thumbnail,2),i.thumbnail_data.uploaded_thumbnail&&S(t,"UPLOADED THUMBNAIL",i.thumbnail_data.uploaded_thumbnail,3),(4==i.current_thumbnail||i.is_gif_preview_enabled)&&i.thumbnail_data.animated_gif&&S(t,"GIF THUMBNAIL",i.thumbnail_data.animated_gif,4);else{var n=$("#"+t).data("workflowConfig"),a=n.assetContent;S(t,"DEFAULT",a.customerHost+"/video/thumbnail/"+a.deliveryToken,1)}-1==i.current_thumbnail&&(i.current_thumbnail=1),$("#"+t).find("#customizeThumbnailComponent").find('.thumbnail-component-ele[thumbnail-type="'+i.current_thumbnail+'"]').addClass("selected-thumbnail"),$("#"+t).find(".customize-component .customize-component-loading").hide(),$("#"+t).find("#customizeThumbnailComponent").find(".thumbnail-component .thumbnail-component-ele").unbind("click").bind("click",function(e){if(!$(e.currentTarget).hasClass("selected-thumbnail")){$(e.currentTarget).parent().attr("disabled","disabled");var t=$(e.currentTarget).parent().attr("pop-id");$("#"+t).find(".customize-component .customize-component-loading").show();var i=$(e.currentTarget).parent().attr("asset-id"),o=$(e.currentTarget).attr("thumbnail-type");E(t,i,o);He($("#"+t).data("workflowConfig").logPrefix,"Thumbnail Selected In Edit Video",o)}})}function S(e,t,i,o){var n=$(ct.thumbnailComponentEle);$(n).find(".thumbnail-name").text(t),$(n).find(".thumbnail-img img").attr("src",i),$(n).attr("thumbnail-type",o),$("#"+e).find("#customizeThumbnailComponent").find(".thumbnail-component").append($(n))}function M(e){x(e.popId,e.assetId)}function V(e){var t=$("#"+e).data("workflowConfig");if(t.popConfig.showLandingPageComponent){0==$("#"+e).find("#landingPageComponent").find(".landing-page-component").length&&($("#"+e).find("#landingPageComponent").append($(ct.landingPageComponent)),$("#"+e).find("#landingPageComponent #landingPageSearchBox").attr("pop-id",e),$("#"+e).find("#landingPageComponent #landingPageSearchBox").keypress(function(e){if(13==e.keyCode){B($(e.currentTarget).attr("pop-id"),0)}}),$("#"+e).find("#landingPageComponent #landingPageSearchBtn").attr("pop-id",e),$("#"+e).find("#landingPageComponent #landingPageSearchBtn").unbind("click").bind("click",function(e){B($(e.currentTarget).attr("pop-id"),0)}),$("#"+e).find(".salespage-refresh-button").attr("pop-id",e),$("#"+e).find(".salespage-refresh-button").off("click").on("click",function(e){t.assetContent.customPageDetails=void 0,We(t),B($(e.currentTarget).attr("pop-id"),0)}),$("#"+e).find("#setAsDefaultLandingPageBtn").attr("pop-id",e),$("#"+e).find("#setAsDefaultLandingPageBtn").unbind("change").bind("change",function(e){var t=$(e.currentTarget).attr("pop-id");if($("#"+t).find("#setAsDefaultLandingPageBtn").is(":checked")){var i=$("#"+t).find(".page-library-container .landing-page-selected");$(i).length>0?($("#"+t).find("#landingPageComponent .page-library-container .landing-page-default-tag").remove(),$(i).find(".thumbnail").append($(ct.landingPageDefaultTagEle)),$("#"+t).find("#setAsDefaultLandingPageBtn").parent().hide(),F($(i).attr("page-id"))):$("#"+t).find("#setAsDefaultLandingPageBtn").prop("checked",!1)}}));$("#"+e).find("#landingPageComponent .page-library-container .page-list").attr("lib-loaded")||B(e,0)}else $("#"+e).find('.customize-component div[target="landingPageComponent"]').hide()}function B(e,i,o){void 0==o&&(o=!1),$("#"+e).find(".customize-component .customize-component-loading").show();var n=$("#"+e).find(".page-library-container .page-list").attr("default-page-id"),a=t();a.messageFromContentScript1234=!0,a.msgType="workflow",a.fetchPageComponentData=!0,a.popId=e,a.pageOffset=i,a.loadMore=o,n&&(a.defaultPageId=[n]),a.searchToken=$("#"+e).find("#landingPageSearchBox").val(),a.screenName=ot.screenName,ot.port.postMessage(a)}function x(e,i){var o=$("#"+e).find(".hv-edit-video-container .left-container #hvVideoTitleContainer").is(":visible");if(o=o||$("#"+e).find(".hv-edit-video-container .goto-pro-edit-btn").is(":visible")){var n=t();n.messageFromContentScript1234=!0,n.msgType="workflow",n.fetchThumbnails=!0,n.popId=e,n.assetId=i,n.screenName=ot.screenName,ot.port.postMessage(n)}else setTimeout(function(){x(e,i)},1e3)}function E(e,i,o){var n=t();n.messageFromContentScript1234=!0,n.msgType="workflow",n.switchThumbnail=!0,n.popId=e,n.assetId=i,n.thumbnailType=o,n.screenName=ot.screenName,ot.port.postMessage(n)}function F(e){var i=t();i.messageFromContentScript1234=!0,i.msgType="workflow",i.setDefaultPageAPI=!0,i.pageId=e,i.screenName=ot.screenName,ot.port.postMessage(i)}function L(e){var i=t();i.messageFromContentScript1234=!0,i.openUrl=!0,i.url=rt+e,i.screenName=ot.screenName,ot.port.postMessage(i)}function D(e,t){var i=e.landingPages,o=$("#"+t).find("#landingPageComponent .page-library-container .page-list");if($(o).attr("pop-id",t),$(o).attr("next-offset",e.next_offset),$(o).attr("page-has-more",e.has_more),e.loadMore||$(o).empty(),Ze(t,o),0==i.length)$(o).append($(ct.emptyLandingPageComponent)),$(o).find(".landing-page-empty-state .action").unbind("click").bind("click",function(e){L("/video-page/home")});else{for(var n=$("#"+t).data("workflowConfig"),a=!1,r=0;r<i.length;r++){var d=$(ct.landingPageEle);$(d).find(".thumbnail img").attr("src",i[r].thumbnail),$(d).find(".title").text(i[r].page_name),!n.assetContent.customPageDetails&&i[r].is_default&&($(d).find(".thumbnail").append($(ct.landingPageDefaultTagEle)),a=!0,$(d).addClass("landing-page-selected"),$("#"+t).find("#setAsDefaultLandingPageBtn").parent().hide(),N(t,i[r].page_id,i[r].hub_link,i[r].page_asset_id)),$(d).attr("page-link",i[r].hub_link),$(d).attr("page-id",i[r].page_id),$(d).attr("page-asset-id",i[r].page_asset_id),i[r].is_default&&$(o).attr("default-page-id",i[r].page_id),$(o).append($(d))}if(n.assetContent.customPageDetails){var s=$(o).find('.landing-page-ele[page-id="'+n.assetContent.customPageDetails.pageId+'"]');$(s).addClass("landing-page-selected"),A(s,t)}a&&$("#"+t).find(".landing-page-component .default-page-setting").hide(),$(o).find(".landing-page-ele").unbind("click").bind("click",function(e){var t=$(e.currentTarget).parent().attr("pop-id");$(e.currentTarget).parent().find(".landing-page-selected").removeClass("landing-page-selected"),$(e.currentTarget).addClass("landing-page-selected"),A(e.currentTarget,t);var i=$(e.currentTarget).attr("page-id"),o=$(e.currentTarget).attr("page-link"),n=$(e.currentTarget).attr("page-asset-id");N(t,i,o,n),He($("#"+t).data("workflowConfig").logPrefix,"Sales Page Selected In Edit Video",n)}),$(o).attr("lib-loaded",!0);var c=!1;$("#"+t).find(".page-library-container").off("scroll").on("scroll",function(){var e=$("#"+t).find(".page-library-container").scrollTop()+$("#"+t).find(".page-library-container").height(),i=$("#"+t).find(".page-list").height();if(!isNaN(i)&&(i-=2,e>=i&&!c)){c=!0;if("true"==$(o).attr("page-has-more")){var n=Number($(o).attr("next-offset"));B(t,n,!0)}}})}$("#"+t).find(".customize-component .customize-component-loading").hide()}function A(e,t){0==$(e).find(".landing-page-default-tag").length?($("#"+t).find("#setAsDefaultLandingPageBtn").prop("checked",!1),$("#"+t).find("#setAsDefaultLandingPageBtn").parent().show()):$("#"+t).find("#setAsDefaultLandingPageBtn").parent().hide()}function N(e,t,i,o){var n=$("#"+e).data("workflowConfig");if(!n.assetContent.customPageDetails||n.assetContent.customPageDetails.pageId!=t){var a=i.split("/");n.assetContent.customPageDetails={pageId:t,pageLink:i,pageAssetId:o,customerHost:a[0]+"//"+a[2],pageDeliveryToken:a[a.length-1]},n.assetContent.mfInVideo=void 0,We(n),$("#"+e).find(".hv-wf-pop-body .hv-wf-pop-content").find(".hv-contacts-container").attr("reset-contacts",!0)}}function z(e){for(var t=Qe(e),i=[{name:t,id:"libraryInsertVideoBtn",type:"secondary"},{name:st.continue,id:"videoLibraryContinueBtn",type:"primary"}],o=0;o<i.length;o++){var n=$(ct.buttonEle);$(n).attr("id",i[o].id),$(n).find("span").text(i[o].name),$("#"+e).find(".hv-wf-pop-footer .right-btn-container").append($(n)),$("#"+e).find(".hv-wf-pop-footer .right-btn-container").find("#"+i[o].id).addClass(i[o].type+"-btn")}$("#"+e).find(".hv-wf-pop-footer .right-btn-container").find("#libraryInsertVideoBtn").addClass("disp-none")}function R(e,t,i,o){Re(e),0===$("#"+e).find(".hv-create-video-container .record-preview-screen").length&&($("#"+e).find(".hv-create-video-container").append($(ct.recordPreviewScreen)),$("#"+e).find(".hv-create-video-container .record-preview-screen").append($(ct.recordPreview)),$("#"+e).find("#hvStartWebcamRecBtn").attr("pop-id",e).attr("log-prefix",t),$("#"+e).find("#hvStartWebcamRecBtn").off("click").on("click",ee),$("#"+e).find(".hv-create-video-container .record-option").attr("pop-id",e).attr("log-prefix",t).attr("show-video-pages",i).attr("show-templates",o),$("#"+e).find(".hv-create-video-container .record-option").off("click").on("click",ie)),$("#"+e).find(".hv-create-video-container").find(".vid-preview-container iframe").attr("src",at),$("#"+e).find(".hv-wf-pop-body .hv-wf-pop-loading").fadeOut(50),$("#"+e).find(".hv-create-video-container .create-video-content").hide(),$("#"+e).find(".hv-create-video-container .record-preview-screen").show()}function O(e,t,i,o){$("#"+e).find(".hv-wf-pop-body .hv-wf-pop-loading").fadeOut(50),$("#"+e).find(".create-video-content").hide(),0===$("#"+e).find(".hv-create-video-container .import-video-screen").length&&($("#"+e).find(".hv-create-video-container").append($(ct.importVideoScreen)),$("#"+e).find(".import-video-screen").append($(ct.importMenu)),$("#"+e).find(".import-video-screen").append($(ct.importVideoContentScreen)),j(e),U(e,t,i,o),$("#"+e).find('.import-video-screen .import-menu-item[import-type="local"]').click()),$("#"+e).find(".import-video-screen").show()}function U(e,t,i,o){$("#"+e).find(".import-video-screen .import-menu-back-option").attr("pop-id",e).attr("show-video-pages",i),$("#"+e).find(".import-video-screen .import-menu-back-option").off("click").on("click",function(e){var i=$(e.currentTarget).attr("pop-id"),n="true"==$(e.currentTarget).attr("show-video-pages"),a=$(e.currentTarget).attr("option-type");if("record-video"===a)R(i,t,n,o);else if("library"===a){var r=$("#"+i).data("workflowConfig");C(i,"video-library",r.planParams.isVideoPagesEnabled&&r.popConfig.showVideoPageLibrary,r.logPrefix,o)}})}function j(e){$("#"+e).find(".import-video-screen .import-menu-item").attr("pop-id",e),$("#"+e).find(".import-video-screen .import-menu-item").off("click").on("click",function(e){var t=$(e.currentTarget).attr("pop-id");$("#"+t).find(".import-video-screen .import-menu-item").removeClass("selectable-menu-item-selected"),$(e.currentTarget).addClass("selectable-menu-item-selected");var i=$(e.currentTarget).attr("import-type");"local"===i?H(t):"gdrive"===i&&q(t)})}function W(e){for(var t=e.response.categories||[],i=[],o=0;o<t.length;o++){var n=t[o];i.push(n.id),$("#"+e.popId).find("#hvPopVidCategorySelect").append($('<option value="'+n.id+'">'+n.name+"</option>"))}i.includes(e.category)?$("#"+e.popId).find("#hvPopVidCategorySelect").val(e.category):$("#"+e.popId).find("#hvPopVidCategorySelect").val("all")}function G(e){$("#"+e).find("#hvVideoTitleContainer").hide(),$("#"+e).find("#hv-wf-embed-iframe").css("height","88%")}function H(e){var t=$("#"+e);0==t.find(".import-video-screen .import-video-content-container .local-import").length&&t.find(".import-video-screen .import-video-content-container").append($(ct.localImportScreen)),t.find(".import-video-screen .import-video-content").hide(),t.find(".import-video-screen .local-import").show(),t.find("#hvFileDragDropContainer").on("change",function(e){var t=e.target.files,i=t[0];console.log(i)}),t.find("#hvFileDragDropContainer").off("dragover").on("dragover",function(e){e.preventDefault(),e.stopPropagation()}),t.find("#hvFileDragDropContainer").off("drag").on("drop",function(e){e.preventDefault()})}function q(e){var t=$("#"+e);0==t.find(".import-video-screen .import-video-content-container .gdrive-import").length&&(t.find(".import-video-screen .import-video-content-container").append($(ct.gdriveImportScreen)),J(e),t.find("#hvGdriveImportAccessBtn").attr("pop-id",e),t.find("#hvGdriveImportAccessBtn").off("click").on("click",function(e){var t=$(e.currentTarget).attr("pop-id");$("#"+t).find(".hv-wf-pop-body .hv-wf-pop-loading").fadeIn(10),K(t,"drive")})),t.find(".import-video-screen .import-video-content").hide(),t.find(".import-video-screen .gdrive-import").show()}function J(e){$("#"+e).find(".hv-wf-pop-body .hv-wf-pop-loading").fadeIn(10);var i=t();i.messageFromContentScript1234=!0,i.msgType="workflow",i.fetchGdriveAccounts=!0,i.popId=e,i.screenName=ot.screenName,ot.port.postMessage(i)}function Q(e,t){var i=$("#"+e);i.find(".import-video-screen .gdrive-import").find(".gdrive-import-content").hide();var o=t.accounts;if(0===o.length)i.find(".import-video-screen .gdrive-import").find(".wf-account-access-screen").show();else{i.find(".import-video-screen .gdrive-import").find(".gdrive-container").show(),i.find("#gdriveVidImportAccountSelect").empty();for(var n=0;n<o.length;n++){var a=o[n];i.find("#gdriveVidImportAccountSelect").append('<option value="'+a.user_id+'" email="'+a.email+'">'+a.email+"</option>")}i.find("#gdriveVidImportAccountSelect").append('<option value="-1">'+st.addAccount+"</option>"),i.find("#gdriveVidImportAccountSelect").attr("pop-id",e),i.find("#gdriveVidImportAccountSelect").off("change").on("change",function(e){var t=$(e.currentTarget).val(),i=$(e.currentTarget).attr("pop-id"),o=$(e.currentTarget).find("option:selected").attr("email");"-1"===t?($("#"+i).find(".hv-wf-pop-body .hv-wf-pop-loading").fadeIn(10),K(i,"drive")):($("#"+i).find(".import-video-screen .gdrive-import").find(".gdrive-vid-lib-container").empty(),$("#"+i).find(".import-video-screen .gdrive-import").find(".gdrive-empty-videos-message").removeClass("display-flex"),Z(i,o,t))}),i.find("#gdriveVidImportAccountSelect").val(o[0].user_id).trigger("change")}}function Z(e,i,o,n){$("#"+e).find(".import-video-screen .gdrive-import").find(".gdrive-vid-loading").show();var a=t();a.messageFromContentScript1234=!0,a.msgType="workflow",a.listDriveFiles=!0,a.popId=e,a.screenName=ot.screenName,a.params={account_email:i,unique_id:o,file_type:"video",page_token:n},ot.port.postMessage(a)}function Y(e){$("#"+e.popId).find(".import-video-screen .gdrive-import").find(".gdrive-vid-loading").hide();var t=$("#"+e.popId).find(".import-video-screen .gdrive-vid-lib-container");t.find(".load-more-videos").remove();var i=e.response;if(e.page_token||0!==i.files.length){if(i.files.length>0){for(var o=0;o<i.files.length;o++){var n=i.files[o],a=$(ct.libVideoElement);$(a).attr("file-id",n.id),$(a).attr("unique-id",payload.unique_id),$(a).find("img").attr("src",n.url);var r="00:00";n.duration&&(r=n.duration.replace(/[a-z]/g,"")),$(a).find("span").text(r),$(a).find(".title").text(n.name),t.append($(a))}t.find(".lib-video-container").off("click").on("click",function(e){t.find(".video-selected").removeClass("video-selected"),$(e.currentTarget).find(".img-container").addClass("video-selected")}),i.page_token&&(t.append($(ct.loadMoreVideos)),t.find("#hvLoadMoreVideosBtn").attr({"unique-id":payload.unique_id,"page-token":i.page_token,email:payload.email,"pop-id":e.popId}),t.find("#hvLoadMoreVideosBtn").off("click").on("click",function(e){var t=$(e.currentTarget);Z($(t).attr("pop-id"),$(t).attr("email"),$(t).attr("unique-id"),$(t).attr("page-token"))}))}}else t.find(".import-video-screen .gdrive-import").find(".gdrive-empty-videos-message").addClass("display-flex")}function K(e,i){var o,n;"drive"===i&&(o="https://www.googleapis.com/auth/drive.file https://www.googleapis.com/auth/drive.readonly https://www.googleapis.com/auth/userinfo.email",n="gdrive");var a,r=rt+"/video/oauth";a=rt.includes("local")?"545792173243-j7c0qsehnht1ncch7hdjpdhh8oqmkitt.apps.googleusercontent.com":rt.includes("stage")?"545792173243-j7c0qsehnht1ncch7hdjpdhh8oqmkitt.apps.googleusercontent.com":"989612280692-8vs3vmbppgd16ijvnk7uf4nrg3404tqv.apps.googleusercontent.com";var d=t();d.messageFromContentScript1234=!0,d.requestGoogleAccess=!0,d.popId=e,d.url="https://accounts.google.com/o/oauth2/auth?access_type=offline&scope="+o+"&client_id="+a+"&redirect_uri="+r+"&response_type=code&state="+n+"&approval_prompt=force",d.screenName=ot.screenName,d.service=i,ot.port.postMessage(d)}function X(e,i){var o=t();o.messageFromContentScript1234=!0,o.configureGDriveAccount=!0,o.msgType="workflow",o.screenName=ot.screenName,o.authcode=i,o.popId=e,ot.port.postMessage(o)}function ee(e){var i=$(e.currentTarget).attr("pop-id"),n=$(e.currentTarget).attr("log-prefix");$("#"+i).find(".hv-wf-pop-body .hv-wf-pop-loading").fadeIn(50);var a={};void 0!=nt?a=nt:a.systemAudio=!0,a.fromPopup=!0,a.initiator=ot.serviceName,a.tabRecording=!1,a.separateLayer=!1,a.screenRecord=!1,a.webCam=!0,a.audio=!0,a.workflowPopId=i;var r=t();r.messageFromContentScript1234=!0,r.config=a,r.doBackgroundRecording=!0,ot.port.postMessage(r),o(!0);var d=$("#"+i).data("workflowConfig");d.recordConfiguration=a,We(d),Ge(n,"Start Webcam Recording Button Clicked")}function te(e){var i=$(e.currentTarget).attr("pop-id"),n=$(e.currentTarget).attr("log-prefix");$("#"+i).find(".hv-wf-pop-body .hv-wf-pop-loading").fadeIn(10);var a={};void 0!=nt?a=nt:a.systemAudio=!0,a.screenRecord=$("#"+i).find(".hv-embed-widget .hv-embed-screen-box-live:visible").length>0,a.webCam=$("#"+i).find(".hv-embed-widget .hv-embed-webcam-box-live:visible").length>0,a.audio=$("#"+i).find(".hv-embed-widget .hv-embed-audio-box-live:visible").length>0,a.fromPopup=!0,a.initiator=ot.serviceName,a.tabRecording=!1,a.separateLayer=!1,a.workflowPopId=i;var r=t();r.messageFromContentScript1234=!0,r.config=a,r.doBackgroundRecording=!0,ot.port.postMessage(r),o(!0);var d=$("#"+i).data("workflowConfig");d.recordConfiguration=a,We(d),Ge(n,"Start Recording Button Clicked")}function ie(e){var t=$(e.currentTarget).attr("data-action"),i=$(e.currentTarget).attr("pop-id"),o=$(e.currentTarget).attr("log-prefix"),n="true"==$(e.currentTarget).attr("show-templates"),a="true"==$(e.currentTarget).attr("show-video-pages");"library"==t?($("#"+i).find(".create-video-content").hide(),C(i,"video-library",a,o,n),Ge(i,"Choose From Library Card Clicked")):($("#"+i).find(".create-video-content").hide(),$("#"+i).find(".hv-wf-pop-body .hv-wf-pop-loading").show(),$("#"+i).find(".hv-screen-record-container .hv-recording-widget").empty().load(chrome.extension.getURL("html/injected/recordwidget.html"),function(){checkIfUserSignedIn()
;for(var e=$("#"+i).find(".hv-screen-record-container .hv-recording-widget"),t=0;t<e.length;t++){var n=e[t],a=n.innerHTML.toString(),r=a.replace(/__MSG_(\w+)__/g,function(e,t){return t?chrome.i18n.getMessage(t):""});r!=a&&(n.innerHTML=r)}$(this).find(".hv-embed-record-button").off("click"),$(this).find(".hv-embed-record-button").attr("pop-id",i).attr("log-prefix",o),$(this).find(".hv-embed-record-button").on("click",te),$(this).find(".hv-embed-widget").show(),$("#"+i).find(".hv-wf-pop-body .hv-wf-pop-loading").fadeOut(function(){$("#"+i).find(".hv-create-video-container .hv-screen-record-container").fadeIn()})}),Ge(o,"Record with Screen Record Card Clicked")),$("#"+i).find(".hv-create-video-container").find(".vid-preview-container iframe").removeAttr("src")}function oe(e,t,i){var o,n=Qe(e);o=i?[{name:n,id:"editInsertVideoBtn",type:"secondary"},{name:st.continue,id:"editContinueBtn",type:"primary"}]:[{name:n,id:"editInsertVideoBtn",type:"primary"}];for(var a=0;a<o.length;a++)if(0==$("#"+e).find(".hv-wf-pop-footer .right-btn-container").find("#"+o[a].id).length&&0==$("#"+e).find(".hv-wf-pop-footer .right-btn-container").find("#"+o[a].id).length){var r=$(ct.buttonEle);$(r).attr("id",o[a].id),$(r).find("span").text(o[a].name),$("#"+e).find(".hv-wf-pop-footer .right-btn-container").append($(r)),$("#"+e).find(".hv-wf-pop-footer .right-btn-container").find("#"+o[a].id).addClass(o[a].type+"-btn")}ne(e,t),ae(e,t),se(e,"simple"),le(e),$("#"+e).find("#editInsertVideoBtn").attr("pop-id",e).attr("log-prefix",t),$("#"+e).find("#editInsertVideoBtn").off("click").on("click",function(e){messageEmbeddedFrame("hv_pause_video");var t,i=$(e.currentTarget).attr("pop-id"),o=$(e.currentTarget).attr("log-prefix");if(fe(i)){t=$("#"+i).data("workflowConfig"),$("#"+i).find("#hvVideoEditBtn").is(":visible")?t.savedSimpleEdit&&(messageEmbeddedFrame("hv_save_simple_edit",{}),t.savedSimpleEdit=!0,We(t)):Je(i,"Please cancel/save edits","error");var n=t.assetContent.mfInTemplates||[];if(t.popConfig&&(t.popConfig.fetchMfInVideo||t.popConfig.showMfForm)&&!t.assetContent.mfInVideo)return void setTimeout(function(){ue(t)},1e3);var a=t.assetContent.mfInVideo||[];if("sales"==t.popType&&t.popConfig.showMfForm&&(n.length>0||a.length>0||t.popConfig.mandatoryEmailMf||t.popConfig.askDefaultMergeFields)&&!t.assetContent.mfFormFilled)return void we(t);if("sales"==t.popType&&t.popConfig.showMfSelection&&!t.popConfig.mfSelectionSelected)return void Ke(t);Ie(i)}Ge(o,"Insert Video Button In Simple Edit Clicked")}),$("#"+e).find("#editContinueBtn").attr("pop-id",e).attr("log-prefix",t),$("#"+e).find("#editContinueBtn").off("click").on("click",function(e){messageEmbeddedFrame("hv_pause_video");var t,i=$(e.currentTarget).attr("pop-id"),o=$(e.currentTarget).attr("log-prefix");fe(i)&&(t=$("#"+i).data("workflowConfig"),$("#"+i).find("#hvVideoEditBtn").is(":visible")?t.savedSimpleEdit&&(messageEmbeddedFrame("hv_save_simple_edit",{}),t.savedSimpleEdit=!0,We(t)):Je(i,"Please cancel/save edits","error"),ge(i)),Ge(o,"Continue Button In Simple Edit Clicked")})}function ne(e,t){$("#"+e).find("#hvVideoEditBtn").off("click").on("click",function(e){0==dt?(dt=!0,$("#hvVideoEditBtn").addClass("btn-selected"),$(".hv-menu-list-container").show(),$(".hv-arrow").css({transform:"rotate(90deg)",transition:"transform 0.3s ease-in-out 0s"})):(dt=!1,$("#hvVideoEditBtn").removeClass("btn-selected"),$(".hv-menu-list-container").hide(),$(".hv-arrow").css("transform","rotate(-90deg)"))})}function ae(e,t){var i=$("#"+e).data("workflowConfig");$("#"+e).find("#hvQuickEdit").attr("pop-id",e).attr("log-prefix",t),$("#"+e).find("#hvPersonalizeEdit").attr("pop-id",e).attr("log-prefix",t),$("#"+e).find("#hvQuickEdit").off("click").on("click",function(e){dt=!1,$("#hvVideoEditBtn").removeClass("btn-selected"),$(".hv-menu-list-container").hide();var t=$(e.currentTarget).attr("pop-id"),i=$(e.currentTarget).attr("log-prefix");$(".left-container").css("overflow-y","scroll"),l(t),$("#"+t).find("#hvSaveEditBtn").show(),$("#"+t).find("#hvCancelEditBtn").show(),re(t,"Edit Video"),"true"==$(".hv-virtual-bg-btn-container").attr("vbg-enabled")&&m(t),messageEmbeddedFrame("show_video_edit_mode_in_dynamic_integration",{}),Ge(i,"Edit Video Button In Simple Edit Clicked"),He(i,"Edit Video Button In Simple Edit Clicked",$("#"+t).data("workflowConfig").assetContent.assetId)}),i.planParams.isPersonalizationEnabled?$("#"+e).find("#hvPersonalizeEdit").off("click").on("click",function(e){dt=!1,$("#hvVideoEditBtn").removeClass("btn-selected"),$(".hv-menu-list-container").hide();var t=$(e.currentTarget).attr("pop-id"),i=$(e.currentTarget).attr("log-prefix");$(".left-container").css("overflow-y","scroll"),$("#"+t).find("#hvVirtualBgBtn").hide(),l(t),$("#"+t).find("#hvSaveEditBtn").show(),$("#"+t).find("#hvCancelEditBtn").show(),re(t,"Personalize Video"),"true"==$(".hv-virtual-bg-btn-container").attr("vbg-enabled")&&m(t),messageEmbeddedFrame("show_personalize_edit_mode",{}),se(t,"personalize"),Ge(i,"Edit Video Button In Personalize Edit Clicked"),He(i,"Edit Video Button In Personalize Edit Clicked",$("#"+t).data("workflowConfig").assetContent.assetId)}):($("#"+e).find("#hvPersonalizeEdit").addClass("hv-btn-negative"),$("#"+e).find("#hvPersonalizeEdit").attr("hv-btn-tooltip","To personalize video upgrade to our premium plan"),$("#"+e).find("#hvPersonalizeEdit").off("click").on("click",function(e){dt=!1,$(".hv-menu-list-container").hide(),window.open("https://www.hippovideo.io/pricing")}))}function re(e,t){$("#"+e).find(".right-container").hide(),$("#"+e).find(".video-title-container").hide(),$("#"+e).find(".hv-wf-pop-footer").hide(),ce(e,t)}function de(e){$("#"+e).find(".right-container").show(),$("#"+e).find(".video-title-container").show(),$("#"+e).find(".hv-wf-pop-footer").show(),pe(e)}function se(e,t){var i=$("#"+e).data("workflowConfig");$("#"+e).find("#hvCancelEditBtn").off("click").on("click",function(i){$(".hv-arrow").css("transform","rotate(-90deg)"),$("#"+e).find("#hvSaveEditBtn").hide(),$("#"+e).find("#hvCancelEditBtn").hide(),$("#"+e).find("#hvVirtualBgBtn").show(),v(e),"true"==$(".hv-virtual-bg-btn-container").attr("vbg-enabled")&&g(e),$(".left-container").css("overflow-y","hidden"),de(e),"simple"==t?messageEmbeddedFrame("hv_cancel_simple_edit",{}):messageEmbeddedFrame("hv_cancel_personalize_edit",{})}),$("#"+e).find("#hvSaveEditBtn").off("click").on("click",function(o){$(".hv-arrow").css("transform","rotate(-90deg)"),$("#"+e).find("#hvSaveEditBtn").hide(),$("#"+e).find("#hvCancelEditBtn").hide(),$("#"+e).find("#hvVirtualBgBtn").show(),v(e),$(".left-container").css("overflow-y","hidden"),de(e),"true"==$(".hv-virtual-bg-btn-container").attr("vbg-enabled")&&g(e),i.savedSimpleEdit=!0,"simple"==t?messageEmbeddedFrame("hv_save_simple_edit_in_dynamicInteg",{}):messageEmbeddedFrame("hv_save_personalize_edit",{})})}function ce(e,t){$("#"+e).find(".hv-wf-pop-header").hide(),$("#"+e).find(".hv-wf-edit-mode-header").show(),$("#"+e).find(".hv-edit-mode-title").text(t)}function pe(e){$("#"+e).find(".hv-wf-pop-header").show(),$("#"+e).find(".hv-wf-edit-mode-header").hide()}function le(e){$("#"+e).data("workflowConfig").planParams.isVirtualBgEnabled?$("#"+e).find("#hvVirtualBgBtn").off("click").on("click",function(t){var i=$("#"+e).data("workflowConfig");chrome.runtime.sendMessage({showVBG:!0,assetId:i.assetContent.assetId,json:i.recordConfiguration.projectJson,popId:e,popupDetails:ot}),$("#"+e).find("#virtual-bg-sidebar").show()}):($("#"+e).find(".hv-virtual-bg-btn-container").attr("hv-btn-tooltip","To apply virtual background upgrade to our premium plan"),$("#"+e).find("#hvVirtualBgBtn").addClass("hv-btn-negative"),$("#"+e).find("#hvVirtualBgBtn").off("click").on("click",function(){window.open("https://www.hippovideo.io/pricing")}))}function ve(e,t){var i=$("#"+e).data("workflowConfig");_(i.popId),0===$("#"+i.popId).find(".hv-wf-pop-body .hv-wf-pop-content").find(".hv-create-video-container").length&&(b(i),G(i.popId)),w(i,!1),$("#"+i.popId).find(".hv-wf-pop-body .hv-wf-pop-content").find(".hv-pop-content-container").hide(),$("#"+i.popId).find(".hv-wf-pop-body .hv-wf-pop-content").find(".hv-create-video-container").show(),$("#"+i.popId).find(".hv-wf-pop-body .hv-wf-pop-loading").fadeIn(10),Re(i.popId),p(i.popId),$("#"+i.popId).find("#playerThumbnail").src(t)}function fe(e){var t=$("#"+e).data("workflowConfig");return t.assetContent.videoTitle?""!=t.assetContent.videoTitle.trim()||(Je(e,"Please enter the video title","error"),!1):(Je(e,"Please enter the video title","error"),!1)}function ge(e){var i=$("#"+e).data("workflowConfig"),o=t();o.messageFromContentScript1234=!0,o.msgType="workflow",o.screenName="hv-templates",o.mode="templates",o.popScreenSwitch=!0,o.workflowConfig=i,ot.port.postMessage(o)}function me(e){var t=$(e.currentTarget).attr("pop-id"),i=$("#"+t).find("#hvVideoTitleContainer input").val(),o=$("#"+t).data("workflowConfig");o.assetContent.videoTitle=i,messageEmbeddedFrame("hv_save_video_title",{videoTitle:i}),We(o)}function he(e){var t=$(e.currentTarget).attr("pop-id"),i=$("#"+t).data("workflowConfig"),o=i.logPrefix;xe(t),$("#"+t).find(".hv-wf-pop-body .hv-wf-pop-loading").fadeIn(10);var n=$("#"+t).find(".hv-create-video-container .lib-vid-list-container").find(".video-selected").parent();if("sales"==i.popType&&i.assetContent){var a=i.assetContent.isPage,r=i.assetContent.isPage?i.assetContent.pageId:i.assetContent.assetId;i=$e(i,n);var d=i.assetContent.isPage?i.assetContent.pageId:i.assetContent.assetId;(a&&!i.assetContent.isPage||!a&&i.assetContent.isPage||r!=d)&&(i.assetContent.mfInVideo=void 0,i.assetContent.mfFormFilled=!1)}else i=$e(i,n);if(We(i),i.popConfig&&(i.popConfig.fetchMfInVideo||i.popConfig.showMfForm)&&!i.assetContent.mfInVideo)return Be(t),void ue(i);var s=i.assetContent.mfInTemplates||[],c=i.assetContent.mfInVideo||[];if("sales"==i.popType&&i.popConfig.showMfForm&&(s.length>0||c.length>0||i.popConfig.mandatoryEmailMf||i.popConfig.askDefaultMergeFields)&&!i.assetContent.mfFormFilled)return Be(t),void we(i);Ie(t),Ge(o,"Insert Video In Library Clicked")}function ue(e){var i=t();i.fetchMergeFields=!0,i.msgType="workflow",i.screenName=ot.screenName,i.messageFromContentScript1234=!0,i.workflowConfig=e,i.params={is_page:e.assetContent.isPage,asset_id:e.assetContent.assetId,page_id:e.assetContent.pageId},!e.assetContent.isPage&&e.assetContent.customPageDetails&&(i.params.is_custom_asset=!0,i.params.custom_page_id=e.assetContent.customPageDetails.pageId,i.params.custom_asset_id=e.assetContent.assetId),ot.port.postMessage(i)}function $e(e,t){var i=$(t).attr("page-id"),o=e.assetContent||{},n=$(t).find(".title").text();if(i){o.isPage=!0,o.pageId=i;var a=$(t).attr("hub-link"),r=a.split("/");o.deliveryToken=r[r.length-1],o.customerHost=r[0]+"//"+r[2],o.urlParam="/page/",o.thumbnailParam="/page/thumbnail/",o.pageAssetId=$(t).attr("page-asset-id");var d=$(t).attr("primary-asset-title");d&&""!=d&&(n=d)}else o.isPage=!1,o.assetId=$(t).attr("asset-id"),o.deliveryToken=$(t).attr("delivery-token"),o.customerHost=$("#"+e.popId).find(".hv-create-video-container .lib-vid-list-container").attr("customer-host"),o.urlParam="/video/play/",o.thumbnailParam="/video/thumbnail/";return o.videoTitle=n,o.isPersonalized=$(t).find(".personalisation-tag").length>0,e.assetContent=o,e}function we(e){$("#"+e.popId).find(".hv-wf-pop-body .hv-wf-pop-loading").fadeOut(10);for(var t=[],i=e.assetContent.mfInVideo||[],o=0;o<i.length;o++)t.includes(i[o])||t.push(i[o]);var n=e.popConfig.mandatoryEmailMf;n&&!t.includes("Email")&&t.push("Email");var a=e.popConfig.defaultMergeFields;a&&(t=t.concat(a)),0==$("#"+e.popId).find(".hv-wf-pop .hv-template-mf-form").length&&$("#"+e.popId).find(".hv-wf-pop").append($(ct.hvTemplateMfForm)),$("#"+e.popId).find(".hv-wf-pop .hv-template-mf-form").show("slide",{direction:"right"},500),$("#"+e.popId).find(".hv-wf-pop .hv-template-mf-form").empty();var r=Qe(e.popId),d=ct.hvTemplateMfFormContent;d=d.replace("{insertText}",r),$("#"+e.popId).find(".hv-wf-pop .hv-template-mf-form").append($(d)),$("#"+e.popId).find(".hv-wf-pop .hv-template-mf-form-desc").text(st.mfFormDesc);var s=e.assetContent.mfFormValues||{},c=[];for(o=0;o<t.length;o++)if(!c.includes(t[o])){c.push(t[o]);var p=$(ct.hvTemplateMfFormInputEle);$(p).find(".input-label").text(t[o]),$(p).find(".input-ele input").attr({placeholder:chrome.i18n.getMessage("enter")+" "+t[o],"hv-key":t[o]}),n&&"Email"==t[o]&&$(p).find(".input-label").append("<span>*</span>"),s[t[o]]&&$(p).find(".input-ele input").val(s[t[o]]),$("#"+e.popId).find(".hv-wf-pop .hv-template-mf-form-input-container").append($(p))}be(e.popId,e.logPrefix)}function be(e,t){$("#"+e).find("#templateMfSaveBtn").attr("pop-id",e),$("#"+e).find("#templateMfSaveBtn").off("click").on("click",function(e){for(var t=$(e.currentTarget).attr("pop-id"),i=$("#"+t).data("workflowConfig"),o=i.assetContent.mfFormValues||{},n=$("#"+t).find(".hv-template-mf-form-input-container input"),a=0;a<$(n).length;a++){var r=$(n)[a],d=$(r).val();o[$(r).attr("hv-key")]=d}i.popConfig.mandatoryEmailMf?o.Email&&""!=o.Email.trim()?i.assetContent.mfFormFilled=!0:i.assetContent.mfFormFilled=!1:i.assetContent.mfFormFilled=!0,i.assetContent.mfFormValues=o,We(i),Ce(t);var s=$("#"+i.popId).find(".hv-wf-topbar .tp-selected");$(s).hasClass("hv-edit-video")?$("#"+t).find("#editInsertVideoBtn span").click():(Be(t),i.assetContent.mfFormFilled?$("#"+t).find("#libraryInsertVideoBtn span").click():i.assetContent.isPage&&!i.popConfig.showTemplatesOption&&$("#"+t).find("#libraryInsertVideoBtn span").click()),Ge(i.logPrefix,"Merge Field Form Save Button Clicked")}),$("#"+e).find("#templateMfCancelBtn").attr("pop-id",e).attr("log-prefix",t),$("#"+e).find("#templateMfCancelBtn").off("click").on("click",function(e){var t=$(e.currentTarget).attr("pop-id"),i=$(e.currentTarget).attr("log-prefix");Ce(t),Be(t),Ge(i,"Merge Field Form Cancel Button Clicked")})}function Ce(e){$("#"+e).find(".hv-wf-pop .hv-template-mf-form").hide("slide",{direction:"right"},500)}function ye(e){var t=$(e.currentTarget).attr("pop-id"),i=$(e.currentTarget).attr("log-prefix");xe(t),$("#"+t).find(".hv-wf-pop-body .hv-wf-pop-loading").fadeIn(10);var o=$("#"+t).find(".hv-create-video-container .lib-vid-list-container").find(".video-selected").parent(),n=$("#"+t).data("workflowConfig");n=$e(n,o),We(n),n.assetContent.isPage?ge(n.popId):(_(n.popId),w(n,!1,{})),Ge(i,"Continue Button In Library Clicked");var a;n.assetContent.assetId?a=n.assetContent.assetId:n.assetContent.pageAssetId&&(a=n.assetContent.pageAssetId),He(i,"Continue Button In Library Clicked",a)}function Ie(e){if(!$("#"+e).hasClass("video-inserted")){$("#"+e).addClass("video-inserted");var i=$("#"+e).data("workflowConfig"),o=i.assetContent,n=ke(o),a=i.popConfig&&i.popConfig.defaultHtmlContent;if(!o.html){var r='<div><a href="'+n.video+'" target="_blank"><img style="max-height: 200px; max-width: 360px;" alt="'+n.video+'" src="'+n.thumbnail+'"></a></div>';o.html=a?_e(r,a):r,o.html=o.html.replace(new RegExp("<p>","g"),"<div>"),o.html=o.html.replace(new RegExp("<p ","g"),"<div "),o.html=o.html.replace(new RegExp("</p>","g"),"</div>")}i.assetContent.videoShareUrl=n.video,i.assetContent.thumbnailShareUrl=n.thumbnail,We(i);var d=t();d.insertFromWorkflowPop=!0,d.messageFromContentScript1234=!0,d.msgType="workflow",d.workflowConfig=i,ot.port.postMessage(d),$("#"+i.popId).find(".hv-wf-pop-body .hv-wf-pop-loading").fadeOut(100)}}function ke(e){var t={};return!e.isPage&&e.customPageDetails?(t.video=e.customPageDetails.customerHost+"/page/"+e.customPageDetails.pageDeliveryToken+"?custom_asset_token="+e.deliveryToken+"&org_tok="+e.orgTok,t.thumbnail=e.customPageDetails.customerHost+"/page/thumbnail/"+e.customPageDetails.pageDeliveryToken+"?custom_asset_token="+e.deliveryToken+"&org_tok="+e.orgTok):e.isPage&&e.pageId?(t.video=e.customerHost+e.urlParam+e.deliveryToken+"?org_tok="+e.orgTok,t.thumbnail=e.customerHost+e.thumbnailParam+e.deliveryToken+"?org_tok="+e.orgTok):(t.video=e.customerHost+e.urlParam+e.deliveryToken,t.thumbnail=e.customerHost+e.thumbnailParam+e.deliveryToken),t.thumbnail+=t.thumbnail.includes("?")?"&is_play_time=true":"?is_play_time=true",t}function _e(e,t){var i=t.indexOf("hv-current-cursor");if(-1!=i){var o=t.indexOf(">",i+1),n=t.indexOf(">",o+1);return"<p>"+[t.slice(0,n+1),e,t.slice(n+1)].join("")+"</p>"}return"<p>"+e+t+"</p>"}function Te(e,t,i,o){$("#"+e).find(".lib-recording-option").attr("pop-id",e).attr("log-prefix",t).attr("show-video-pages",i).attr("show-templates",o),$("#"+e).find(".lib-recording-option").off("click").on("click",function(e){var t=$(e.currentTarget).attr("pop-id"),i=$(e.currentTarget).attr("log-prefix"),o="true"==$(e.currentTarget).attr("show-templates"),n="true"==$(e.currentTarget).attr("show-video-pages");"record-video"===$(e.currentTarget).attr("option-type")?(R(t,i,n,o),Ge(i,"Record Video Button In Library Clicked"),qe(t)):O(t,i,n,o)})}function Pe(e){$("#"+e).find("#hvPopVidCategorySelect").attr("pop-id",e),$("#"+e).find("#hvPopVidCategorySelect").off("change").on("change",function(e){$("#videoSearchBar").val("");var t=$(e.currentTarget).attr("pop-id"),i=$(e.currentTarget).val();if(i){var o=$("#"+t).find(".hv-create-video-container .library-view");$(o).find(".lib-vid-list-container").empty(),$(o).find(".empty-vid-list-container").removeClass("display-flex");Ae(t,i,0,$("#"+t).find(".library-menu .selectable-menu-item-selected").attr("library-type"))}})}function Se(e){var t=e.response,i=t.libraries||[],o=Fe(e.popId);0==e.offset&&(o.attr("no-videos",t.num_videos),o.attr("customer-host",t.customer_host),xe(e.popId)),o.find(".load-more-videos").remove();var n="video-library"===e.libraryType;if(0==e.offset&&0==i.length){var a=$("#"+e.popId).find(".hv-create-video-container .library-view");$(a).find(".empty-vid-list-container").addClass("display-flex")}else if(0!=i.length){for(var r=0;r<i.length;r++){var d=i[r],s=$(ct.libVideoElement);$(s).attr("asset-id",d.id),$(s).find("img").attr("src",d.thumb);var c="00:00";d.duration&&(c=d.duration.replace(/[a-z]/g,"")),$(s).find("span").text(c),$(s).find(".title").text(d.title),$(s).attr("delivery-token",d.token),n&&d.is_personalized&&$(s).find(".img-container").append($(ct.personalizedTagEle)),o.append($(s))}Ve(e.popId,o),Number(e.offset)+20<Number(o.attr("no-videos"))&&(o.append($(ct.loadMoreVideos)),o.find("#hvLoadMoreVideosBtn").attr("category-id",e.categoryId?e.categoryId:"all"),o.find("#hvLoadMoreVideosBtn").attr("offset",e.offset),o.find("#hvLoadMoreVideosBtn").attr("next-offset",Number(e.offset)+20),o.find("#hvLoadMoreVideosBtn").attr("library-type",e.libraryType),o.find("#hvLoadMoreVideosBtn").attr("pop-id",e.popId),o.find("#hvLoadMoreVideosBtn").off("click").on("click",function(t){var i=$(t.currentTarget),o=$("#"+e.popId).find("#videoSearchBar").val();o.length>0?Ye($(i).attr("pop-id"),o,$(i).attr("category-id"),$(i).attr("next-offset"),$(i).attr("library-type")):Ae($(i).attr("pop-id"),$(i).attr("category-id"),$(i).attr("next-offset"),$(i).attr("library-type"))}))}}function Me(e){var t=e.response,i=t.landingPages||[],o=Fe(e.popId);if(o.attr("no-pages",i.length),o.find(".load-more-videos").remove(),xe(e.popId),o.attr("no-videos",i.length),0==i.length){var n=$("#"+e.popId).find(".hv-create-video-container .library-view");$(n).find(".empty-vid-list-container").addClass("display-flex"),$(n).find(".empty-vid-list-action").text(st.createPage),$(n).find(".empty-vid-list-action").attr("link-url",rt+"/video-page/templates")}else for(var a=0;a<i.length;a++){var r=i[a],d=$(ct.libVideoElement);$(d).attr("page-id",r.page_id),$(d).attr("page-asset-id",r.page_asset_id),r.primary_asset_title&&$(d).attr("primary-asset-title",r.primary_asset_title),$(d).find("img").attr("src",r.thumbnail),$(d).find("span").hide(),$(d).find(".title").text(r.page_name),$(d).attr("hub-link",r.hub_link),r.is_personalized&&$(d).find(".img-container").append($(ct.personalizedTagEle)),o.append($(d))}Ve(e.popId,o)}function Ve(e,t){t.attr("pop-id",e),t.find(".lib-video-container").off("click").on("click",function(e){var t=$(e.currentTarget).closest(".lib-vid-list-container").attr("pop-id");$(e.currentTarget).find(".img-container").hasClass("video-selected")?($(e.currentTarget).find(".img-container").removeClass("video-selected"),xe(t)):($(e.currentTarget).parent().find(".video-selected").removeClass("video-selected"),$(e.currentTarget).find(".img-container").addClass("video-selected"),Be(t))})}function Be(e){$("#"+e).find("#libraryInsertVideoBtn").removeClass("disabled-btn"),$("#"+e).find("#videoLibraryContinueBtn").removeClass("disabled-btn")}function xe(e){$("#"+e).find("#libraryInsertVideoBtn").addClass("disabled-btn"),$("#"+e).find("#videoLibraryContinueBtn").addClass("disabled-btn")}function Ee(e){$("#"+e).find("#libraryInsertVideoBtn").show(),$("#"+e).find("#videoLibraryContinueBtn").show()}function Fe(e){$("#"+e).find(".hv-wf-pop-body .hv-wf-pop-loading").fadeOut(100);var t=$("#"+e).find(".hv-create-video-container .library-view");return 0==$(t).find(".lib-vid-list-container").length&&$(t).append($(ct.libraryVideoListingContainer)),$("#"+e).find(".hv-create-video-container .lib-vid-list-container")}function Le(e,t,i,o){e.find(".library-menu").attr("pop-id",t).attr("log-prefix",i).attr("show-templates",o),e.find(".lib-menu-item").off("click").on("click",function(e){if(!$(e.currentTarget).hasClass("selectable-menu-item-selected")){$("#videoSearchBar").val("");var t=$(e.currentTarget).parent().attr("log-prefix"),i=$(e.currentTarget).parent().attr("pop-id"),o="true"==$(e.currentTarget).parent().attr("show-templates");$("#"+i).find(".lib-menu-item").removeClass("selectable-menu-item-selected"),$(e.currentTarget).addClass("selectable-menu-item-selected");var n=$("#"+i).find(".hv-create-video-container .library-view");$(n).find(".lib-vid-list-container").empty(),$(n).find(".empty-vid-list-container").removeClass("display-flex");"video-page-library"==$(e.currentTarget).attr("library-type")?(Ne(i,!0,o),De(i),Ge(t,"Video Page Library Clicked")):(Ne(i,!1,o),Ae(i,$("#"+i).find("#hvPopVidCategorySelect").val(),0,$(e.currentTarget).attr("library-type")))}})}function De(e){$("#"+e).find(".hv-wf-pop-body .hv-wf-pop-loading").fadeIn(10);var i=t();i.messageFromContentScript1234=!0,i.msgType="workflow",i.paramData={list_only_undeleted_primary_video:!0},i.fetchPages=!0,i.popId=e,ot.port.postMessage(i)}function Ae(e,i,o,n){$("#"+e).find(".hv-wf-pop-body .hv-wf-pop-loading").fadeIn(10);var a=t();a.messageFromContentScript1234=!0,a.msgType="workflow",a.fetchVideos=!0,a.offset=o,a.fetchCategories=!1,a.libraryType=n,a.popId=e,a.fetchType="all","all"!=i&&(a.categoryId=i),ot.port.postMessage(a)}function Ne(e,t,i){var o=$("#"+e);if(t){o.find(".vid-category-select-container").removeClass("display-flex"),o.find(".hv-vid-select-note").attr("tool-tip",st.pageSelectNote),o.find(".hv-create-video-container .no-lib-ele-found").text(st.noPagesFound),o.find(".hv-create-video-container .empty-vid-list-action").show();var n=Qe(e);n="COPY TO CLIPBOARD"==n?"COPY TO CLIPBOARD":st.insertPage,o.find("#libraryInsertVideoBtn span").text(n),i||(o.find("#videoLibraryContinueBtn").hide(),o.find("#libraryInsertVideoBtn").removeClass("disp-none"))}else{o.find(".vid-category-select-container").addClass("display-flex"),o.find(".hv-vid-select-note").attr("tool-tip",st.videoSelectNote),o.find(".hv-create-video-container .empty-vid-list-action").hide(),o.find(".hv-create-video-container .no-lib-ele-found").text(st.noVideosFound);var a=Qe(e);o.find("#libraryInsertVideoBtn span").text(a),o.find("#videoLibraryContinueBtn").show(),o.find("#libraryInsertVideoBtn").addClass("disp-none")}}function ze(e){$("#"+e).find(".hv-create-video-container .empty-vid-list-action").off("click").on("click",function(e){var t=$(e.currentTarget).attr("link-url");t&&window.open(t)})}function Re(e){$("#"+e).find(".hv-wf-pop-footer .right-btn-container").find(".pop-btn-ele").hide(),$("#"+e).find(".hv-wf-pop-footer .hv-alert-msg-ele").hide()}function Oe(e){return e&&e.serviceName==ot.serviceName&&e.tabId==ot.tabId&&e.windowId==ot.windowId}function Ue(e,i){var o=t();o.messageFromContentScript1234=!0,o.msgType="workflow",o.popScreenSwitch=!0,o.screenName=i.targetScreen,o.mode=i.targetMode,o.popId=e,o.workflowConfig=$("#"+e).data("workflowConfig"),ot.port.postMessage(o)}function je(e){var t=e.workflowConfig.assetContent||{},i=e.mode;t.modes?("create"!=i||t.modes.includes("create")||t.modes.push("create"),"edit"!=i||t.modes.includes("edit")||t.modes.push("edit")):"create"==i?t.modes=["create"]:"edit"==i&&(t.modes=["edit"]);var o=e.workflowConfig.popId;$("#"+o).find(".hv-wf-pop-header .hv-pop-topbar-ele").removeClass("click-not-allowed").removeAttr("data-tooltip"),!e.disableCreate&&t.modes.includes("create")||$("#"+o).find(".hv-wf-pop-header .hv-create-video").addClass("click-not-allowed").attr("data-tooltip",st.createNotAllowed),t.modes.includes("edit")&&!t.isPage||$("#"+o).find(".hv-wf-pop-header .hv-edit-video").addClass("click-not-allowed").attr("data-tooltip",st.editDisableContent),t.modes.includes("templates")||$("#"+o).find(".hv-wf-pop-header .hv-templates").addClass("click-not-allowed").attr("data-tooltip",st.templateDisableContent),t.modes.includes("contacts")||$("#"+o).find(".hv-wf-pop-header .hv-contacts").addClass("click-not-allowed").attr("data-tooltip",st.contactDisableContent);var n=e.workflowConfig;n.assetContent=t,We(n)}function We(e){$("#"+e.popId).data("workflowConfig",e)}function Ge(e,i){var o=t();o.messageFromContentScript1234=!0,o.trackWorkflowActivity=!0,o.msgType="workflow",o.actionName=e+" "+i,ot.port.postMessage(o)}function He(e,t,i){var o={};o.messageFromContentScript1234=!0,o.trackUserActivity=!0,o.actionName=e+" "+t,o.assetId=i,ot.port.postMessage(o)}function qe(e){var i=$("#"+e).data("workflowConfig"),o=t();o.messageFromContentScript1234=!0,o.initTeleprompter=!0,o.msgType="workflow",o.popId=e,o.workflowConfig=i,o.screenName="hv-teleprompter",ot.port.postMessage(o)}function Je(e,i,o){var n=t();n.messageFromContentScript1234=!0,n.flashAlertInWorkflowPop=!0,n.msgType="workflow",n.popId=e,n.msg=i,n.alertType=o,ot.port.postMessage(n)}function Qe(e){var t=$("#"+e).data("workflowConfig");return t.popConfig&&t.popConfig.insertVideoText?t.popConfig.insertVideoText:st.insertVideo}function Ze(e,t){var i=$("#"+e).data("workflowConfig");if(0==$(t).find(".create-sales-page-btn").length){$(t).prepend(ct.createSalesPage);var o=$(".create-sales-page-btn");i.planParams.isFreeUser?(o.addClass("hv-btn-negative"),o.off("click").on("click",function(){window.open("https://www.hippovideo.io/pricing")})):o.off("click").on("click",function(){window.open(rt+"/video-page/templates")})}}function Ye(e,i,o,n,a){0===n&&$("#"+e).find(".lib-vid-list-container").empty(),$("#"+e).find(".hv-wf-pop-body .hv-wf-pop-loading").fadeIn(10);var r=t();r.messageFromContentScript1234=!0,r.msgType="workflow",r.fetchSearchVideos=!0,r.searchToken=i,r.offset=n,r.libraryType=a,r.popId=e,r.fetchType="all","all"!=o&&(r.categoryId=o),ot.port.postMessage(r)}function Ke(e){$("#"+e.popId).find(".hv-wf-pop-body .hv-wf-pop-loading").fadeOut(10),0==$("#"+e.popId).find(".hv-wf-pop .hv-mf-selection-form").length&&$("#"+e.popId).find(".hv-wf-pop").append($(ct.hvMfSelection)),$("#"+e.popId).find(".hv-wf-pop .hv-mf-selection-form").show("slide",{direction:"right"},500),$("#"+e.popId).find(".hv-wf-pop .hv-mf-selection-form").empty();var t=ct.hvMfSelectionContent,i=Qe(e.popId);t=t.replace("{insertText}",i),$("#"+e.popId).find(".hv-wf-pop .hv-mf-selection-form").append($(t)),$("#"+e.popId).find(".hv-selection-dropdowm-list").hide(),Xe(e),tt(e.popId,e.logPrefix)}function Xe(e){var t=!1,i=$("#hvMfTypeSelected"),o=$(".hv-selection-dropdown-option");$(".hv-selection-dropdown").off("click").on("click",function(n){if(i.attr("value"))for(var a=0;a<=o.length;a++)$(o[a]).attr("value")==i.attr("value")?$(o[a]).css("color","rgb(244, 122, 88)"):$(o[a]).css("color","black");et(e,t),t=!t}),$(".hv-selection-dropdown-option").off("click").on("click",function(o){var n=$(o.target).attr("value"),a=$(o.target).text();i.text(a).attr("value",n),et(e,t),t=!0})}function et(e,t){var i=$("#"+e.popId).find(".hv-selection-dropdowm-list");t?(i.hide(),$("#"+e.popId).find(".hv-dropdown-arrow").css("transform","rotate(90deg)")):(i.show(),$("#"+e.popId).find(".hv-dropdown-arrow").css("transform","rotate(-90deg)"))}function tt(e,t){$("#"+e).find("#mfSelectionSaveBtn").attr("pop-id",e),$("#"+e).find("#mfSelectionSaveBtn").off("click").on("click",function(e){var t=$(e.currentTarget).attr("pop-id"),i=$("#"+t).data("workflowConfig"),o=$("#hvMfTypeSelected").attr("value");o?(i.popConfig.mfSelectionSelected=!0,i.assetContent.mfSelectionType=o):i.popConfig.mfSelectionSelected=!1,We(i),it(t);var n=$("#"+i.popId).find(".hv-wf-topbar .tp-selected");$(n).hasClass("hv-edit-video")?$("#"+t).find("#editInsertVideoBtn span").click():(Be(t),i.assetContent.mfSelectionType?$("#"+t).find("#libraryInsertVideoBtn span").click():i.assetContent.isPage&&!i.popConfig.showTemplatesOption&&$("#"+t).find("#libraryInsertVideoBtn span").click()),Ge(i.logPrefix,"Merge Field Selection Form Save Button Clicked")}),$("#"+e).find("#templateMfCancelBtn").attr("pop-id",e).attr("log-prefix",t),$("#"+e).find("#templateMfCancelBtn").off("click").on("click",function(e){var t=$(e.currentTarget).attr("pop-id"),i=$(e.currentTarget).attr("log-prefix");it(t),Be(t),Ge(i,"Merge Field Selection Form Cancel Button Clicked")})}function it(e){$("#"+e).find(".hv-wf-pop .hv-mf-selection-form").hide("slide",{direction:"right"},500)}var ot=function(){var t={};return t.serviceName=e("hvIntegName"),t.windowId=Number(e("hvWindowId")),t.tabId=Number(e("hvTabId")),t.screenName="hv-create-video",t.port=chrome.extension.connect({name:t.serviceName+"::"+t.windowId+"::"+t.tabId+"::"+t.screenName}),t}();!function(){var e=t();e.messageFromContentScript1234=!0,e.getUserRecordingPreferences=!0,ot.port.postMessage(e)}(),function(){var e=t();e.messageFromContentScript1234=!0,e.askToInsertRecordWidgetScript=!0,ot.port.postMessage(e)}();var nt,at=chrome.extension.getURL("/html/injected/custom-webcam-preview.html")+"?center=false&audioMeter=true&webcamWidthPercentage=90&webcamAspectRatio=1.24",rt="cijidiollmnkegoghpfobabpecdkeiah"===chrome.runtime.id?"https://www.hippovideo.io":"dnebjjdbjiikcmihpkcanphpbibhofkh"===chrome.runtime.id?"https://stage.hippowiz.com":"http://localhost:3000",dt=!1,st={editDisableContent:chrome.i18n.getMessage("create_import_video_to_enable_edit"),templateDisableContent:chrome.i18n.getMessage("get_your_video_ready_to_enable_templates"),contactDisableContent:chrome.i18n.getMessage("complete_your_video_and_email_content_to_add_contacts"),createNotAllowed:chrome.i18n.getMessage("create_not_allowed_in_edit"),chooseFromLibrary:chrome.i18n.getMessage("choose_from_library"),videoTitle:chrome.i18n.getMessage("video_title"),editVideo:chrome.i18n.getMessage("edit_video"),virtualBg:chrome.i18n.getMessage("virtual_bg"),videoPages:chrome.i18n.getMessage("video_landing_pages"),videoSelectNote:chrome.i18n.getMessage("select_video_to_continue"),pageSelectNote:chrome.i18n.getMessage("select_page_to_continue"),createPage:chrome.i18n.getMessage("create_new_page"),noPagesFound:chrome.i18n.getMessage("no_video_landing_pages_found"),insertVideo:chrome.i18n.getMessage("insert_video"),insertPage:chrome.i18n.getMessage("insert_page"),wentWrong:chrome.i18n.getMessage("contact_support"),personalized:chrome.i18n.getMessage("personalized"),recordScreen:{proTip:chrome.i18n.getMessage("pro_tip"),screenRecTitle:chrome.i18n.getMessage("record_with_screen_recording"),screenRecDesc:chrome.i18n.getMessage("onboard_your_customers"),screenRecProTip:chrome.i18n.getMessage("capture_your_webcam_audio"),screenRecActionText:chrome.i18n.getMessage("record_options"),libraryTitle:chrome.i18n.getMessage("choose_library"),libraryDesc:chrome.i18n.getMessage("import_video_files"),libraryProtip:chrome.i18n.getMessage("create_videos_beforehand"),libraryActionText:chrome.i18n.getMessage("choose_library")},
importFromLocal:chrome.i18n.getMessage("import_from_local"),importFromGDrive:chrome.i18n.getMessage("import_from_gdrive"),recordVideo:chrome.i18n.getMessage("record_video_text"),continue:chrome.i18n.getMessage("continue"),videoLibarary:chrome.i18n.getMessage("video_library"),personalizedVideos:chrome.i18n.getMessage("personalized_videos"),importVideo:chrome.i18n.getMessage("import_video"),videoCategories:chrome.i18n.getMessage("video_categories"),noVideosFound:chrome.i18n.getMessage("no_videos_found"),editNotAllowed:chrome.i18n.getMessage("quick_edit_not_supported"),goToProEdit:chrome.i18n.getMessage("go_to_pro_edit"),dragAndDrop:chrome.i18n.getMessage("drag_drop"),yourFilesHere:chrome.i18n.getMessage("your_files_here"),browse:chrome.i18n.getMessage("browser_text"),gdriveAccessTxt:chrome.i18n.getMessage("grant_access_to_gdrive_account"),grantAccess:chrome.i18n.getMessage("grant_access"),account:chrome.i18n.getMessage("account_text"),addAccount:chrome.i18n.getMessage("add_account"),mfFormDesc:chrome.i18n.getMessage("fill_in_the_placeholder_value"),save:chrome.i18n.getMessage("save"),cancel:chrome.i18n.getMessage("cancel"),landingPage:chrome.i18n.getMessage("landing_page"),thumbnail:chrome.i18n.getMessage("thumbnail"),meetingLink:chrome.i18n.getMessage("meeting_link"),pageDefaultSetting:chrome.i18n.getMessage("set_selected_page_as_default"),noLandingPage:chrome.i18n.getMessage("no_landing_page_found"),createNewLandingPage:chrome.i18n.getMessage("create_new_landing_page"),defaultLandingPage:chrome.i18n.getMessage("default"),importFromLocal:"IMPORT FROM LOCAL",importFromGDrive:"IMPORT FROM GDRIVE",recordVideo:"RECORD VIDEO",continue:"CONTINUE",videoLibarary:"VIDEO LIBRARY",personalizedVideos:"PERSONALIZED VIDEOS",importVideo:"IMPORT VIDEO",videoCategories:"Video Categories",videoFolders:"Video Folders",noVideosFound:"NO VIDEOS FOUND",editNotAllowed:"Uh Oh! Quick Edit is not supported for this video. Click the button below to proceed with Pro Edit. If you do not wish to edit, click 'CONTINUE.'",goToProEdit:"GO TO PRO EDIT",dragAndDrop:"Drag and drop",yourFilesHere:"your files here, or ",browse:"browse",gdriveAccessTxt:"Grant access to your Google Drive account to import media directly into Hippo Video",grantAccess:"GRANT ACCESS",account:"Account",addAccount:"Add Account",mfFormDesc:"Fill in the placeholder value here to personalize your email",save:"Save",cancel:"Cancel",apply:"Apply",landingPage:"SALES PAGE",thumbnail:"THUMBNAIL",meetingLink:"MEETING LINK",pageDefaultSetting:"Set selected page as default",noLandingPage:"No sales page found",createNewLandingPage:"Create New Sales Page",defaultLandingPage:"DEFAULT",createSalesPage:"Create Sales Page",editAndPersonalize:"EDIT AND PERSONALIZE",quickEdit:"Quick Edit",personalizeVideo:"Personalize Video",userType:"User type:",mfSelectionTooltip:"Choose 'leads' or 'contacts' depending on whom this video is going to be shared with"},ct={createVideoContainer:'<div class="hv-pop-content-container hv-create-video-container"></div>',editVideoContainer:'<div class="create-video-content hv-edit-video-container"><div class="hv-video-preview-outer-container"><div class="left-container"><div id="hvVideoTitleContainer" class="video-title-container" style="display:none;"><div class="inner-container"><div class="video-title">'+st.videoTitle+'<span>*</span></div><div class="input-ele"><input type="text" placeholder= "Enter Video Title"></div></div></div><div class="hv-pop-btn-wrapper"><div class="hv-virtual-bg-btn-container" vbg-enabled = "false"><img id="hvVirtualBgBtn" src="'+chrome.runtime.getURL("/images/extension/vbg-icon.svg")+'"/></div><div class="hv-video-edit-btn-container"><div class="hv-edit-and-personalize-btn" id="hvVideoEditBtn" type="button"><svg xmlns="http://www.w3.org/2000/svg" width="23.168" height="15.362" viewBox="0 0 23.168 15.362"><g id="Icon_feather-video" data-name="Icon feather-video" transform="translate(-0.65 -6.65)"><path id="Path_1116" data-name="Path 1116" d="M30.831,10.5,24,15.379l6.831,4.879Z" transform="translate(-7.863 -1.048)" fill="none" stroke="#f47a58" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.7"/><path id="Path_1117" data-name="Path 1117" d="M3.452,7.5H14.186a1.952,1.952,0,0,1,1.952,1.952V19.21a1.952,1.952,0,0,1-1.952,1.952H3.452A1.952,1.952,0,0,1,1.5,19.21V9.452A1.952,1.952,0,0,1,3.452,7.5Z" transform="translate(0)" fill="none" stroke="#f47a58" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.7"/> </g></svg><span class="edit-btn-text">'+st.editAndPersonalize+'</span><svg class="hv-arrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><path fill="#f47a58" d="M24.707 38.101L4.908 57.899c-4.686 4.686-4.686 12.284 0 16.971L185.607 256 4.908 437.13c-4.686 4.686-4.686 12.284 0 16.971L24.707 473.9c4.686 4.686 12.284 4.686 16.971 0l209.414-209.414c4.686-4.686 4.686-12.284 0-16.971L41.678 38.101c-4.687-4.687-12.285-4.687-16.971 0z"></path></svg></div > <div class="hv-menu-list-container" style="display:none"><div id="hvQuickEdit"><span class="hv-menu-item__icon"><svg xmlns="http://www.w3.org/2000/svg" width="16.172" height="12.539" class="hv-icon"><g data-name="cut-with-scissors (1)"><path data-name="Path 723" d="M16.171 2.375s-1-.858-1.836-.379c-.647.372-4.755 2.433-6.588 3.351l-2.6-1.484a2.14 2.14 0 00.182-1.633A3.04 3.04 0 003.88.43a2.612 2.612 0 00-3.612.656 2.14 2.14 0 00-.183 1.643 3.051 3.051 0 001.449 1.8 3.3 3.3 0 001.019.375h.008c.027 0 .058.01.088.014a7.778 7.778 0 013.76 1.346 7.769 7.769 0 01-3.76 1.347l-.088.013h-.008a3.3 3.3 0 00-1.019.375 3.052 3.052 0 00-1.449 1.8 2.143 2.143 0 00.184 1.645 2.615 2.615 0 003.612.655 3.048 3.048 0 001.449-1.8 2.141 2.141 0 00-.177-1.632l2.6-1.483c1.832.917 5.941 2.981 6.588 3.351.84.478 1.836-.379 1.836-.379L9.36 6.269zm-12.125.87a1.4 1.4 0 01-1.881.183A1.794 1.794 0 011.309 2.4a.89.89 0 01.061-.682 1.4 1.4 0 011.88-.183 1.761 1.761 0 01.85 1.028.9.9 0 01-.054.682zM4.1 9.973A1.762 1.762 0 013.25 11a1.394 1.394 0 01-1.88-.183.891.891 0 01-.061-.68 1.8 1.8 0 01.856-1.033 1.4 1.4 0 011.881.184.893.893 0 01.054.685z" fill="#475867"></path></g></svg></span><span>'+st.quickEdit+'</span></div><div id="hvPersonalizeEdit"><span class="hv-menu-item__icon"><svg xmlns="http://www.w3.org/2000/svg" width="18.672" height="13.034" class="hv-icon"><path data-name="Union 15" d="M1.629 12.284a.953.953 0 01-.879-1.008V1.757A.955.955 0 011.629.75h15.412a.953.953 0 01.881 1.007v9.519a.952.952 0 01-.881 1.008zm6.006-8.857a.4.4 0 00-.221.361v5.459a.407.407 0 00.221.36.394.394 0 00.189.05.381.381 0 00.23-.08c.967-.681 3.857-2.727 3.857-2.727a.412.412 0 00.172-.331.418.418 0 00-.172-.335L8.054 3.456a.394.394 0 00-.234-.076.39.39 0 00-.185.047z" fill="none" stroke="#475867" stroke-width="1.5"></path></svg></span><span>'+st.personalizeVideo+'</span></div></div></div><div class="hv-post-edit-btn-wrapper"><div class="hv-close-edit-btn-container"><button style="display:none" id="hvCancelEditBtn">'+st.cancel+'</button></div><div class="hv-save-edit-btn-container primary-btn"><button style="display:none" id="hvSaveEditBtn">'+st.apply+'</button></div></div></div></div><div class="right-container"></div></div></div>',customizeComponent:'<div class="customize-component"><div class="headers"><div class="header active-header" target="landingPageComponent">'+st.landingPage+'</div><div class="header" target="customizeThumbnailComponent">'+st.thumbnail+'</div></div><div class="component-area"><div class="component-ele active-component" id="landingPageComponent"></div><div class="component-ele" id="customizeThumbnailComponent"></div><div class="component-ele" id="meetingLinkComponent"></div></div><div class="customize-component-loading"><div class="component-loading"><div class="pop-loading"><div></div><div></div><div></div><div></div></div></div></div></div>',emptyLandingPageComponent:'<div class="landing-page-empty-state"><div class="text">'+st.noLandingPage+'</div><div class="action">'+st.createNewLandingPage+"</div></div>",landingPageComponent:'<div class="landing-page-component"><div class="action-container"><div class="search-container"><input placeholder= "Search" type="text" id="landingPageSearchBox"><img title="search" src="'+chrome.extension.getURL("/images/injected/search-icon.png")+'" id="landingPageSearchBtn"></div><svg class="salespage-refresh-button" enable-background="new 0 0 491.236 491.236" viewBox="0 0 491.236 491.236" xmlns="http://www.w3.org/2000/svg" fill="#9f9e9e"><path d="m55.89 262.818c-3-26-.5-51.1 6.3-74.3 22.6-77.1 93.5-133.8 177.6-134.8v-50.4c0-2.8 3.5-4.3 5.8-2.6l103.7 76.2c1.7 1.3 1.7 3.9 0 5.1l-103.6 76.2c-2.4 1.7-5.8.2-5.8-2.6v-50.3c-55.3.9-102.5 35-122.8 83.2-7.7 18.2-11.6 38.3-10.5 59.4 1.5 29 12.4 55.7 29.6 77.3 9.2 11.5 7 28.3-4.9 37-11.3 8.3-27.1 6-35.8-5-21.3-26.6-35.5-59-39.6-94.4zm299.4-96.8c17.3 21.5 28.2 48.3 29.6 77.3 1.1 21.2-2.9 41.3-10.5 59.4-20.3 48.2-67.5 82.4-122.8 83.2v-50.3c0-2.8-3.5-4.3-5.8-2.6l-103.7 76.2c-1.7 1.3-1.7 3.9 0 5.1l103.6 76.2c2.4 1.7 5.8.2 5.8-2.6v-50.4c84.1-.9 155.1-57.6 177.6-134.8 6.8-23.2 9.2-48.3 6.3-74.3-4-35.4-18.2-67.8-39.5-94.4-8.8-11-24.5-13.3-35.8-5-11.8 8.7-14 25.5-4.8 37z"/></svg><div class="default-page-setting"><input type="checkbox" id="setAsDefaultLandingPageBtn"><span>'+st.pageDefaultSetting+'</span></div></div><div class="page-library-container"><div class="page-list"></div></div></div>',landingPageEle:'<div class="landing-page-ele"><div class="thumbnail"><img></div><div class="title"></div></div>',landingPageDefaultTagEle:'<span class="landing-page-default-tag">'+st.defaultLandingPage+"</span>",customizeThumbnailComponent:'<div class="thumbnail-component"></div>',thumbnailComponentEle:'<div class="thumbnail-component-ele"><div class="thumbnail-name"></div><div class="thumbnail-img"><img crossorigin="anonymous"></div></div>',gifThumbnailComponentEle:'<div class="thumbnail-component-ele"><div class="thumbnail-name"></div><div class="thumbnail-img"><video crossorigin="anonymous" autoplay="" muted="" loop=""></div></div>',screenRecContainer:'<div class="create-video-content hv-screen-record-container" style="display:none;"><div class="choose-from-library"><div class="goto-library-btn gradient-btn" id="hvRecordScreenGoToLibBtn"><span>'+st.chooseFromLibrary+'</span></div></div><div class="hv-recording-widget"></div></div>',libraryView:'<div class="library-menu selectable-menu"><div class="lib-menu-item selectable-menu-item" library-type="video-library">'+st.videoLibarary+'</div><div class="lib-menu-item selectable-menu-item" library-type="personalized-video-library">'+st.personalizedVideos+'</div><div class="lib-recording-options selectable-menu-options"><div class="lib-recording-option selectable-menu-option" option-type="record-video"><span>'+st.recordVideo+"</span></div></div></div>",videoCategoryDiv:'<div class="vid-category-select"><div class="vid-category-select-container display-flex"><div class="vid-category-label">'+st.videoFolders+'</div><select id="hvPopVidCategorySelect"><option value="all" selected>All Videos</option></select></div><div class="vid-category-div-right-container"><div class="vid-category-search-container"><input id="videoSearchBar" type="text" placeholder="Search"/><img id="hvSearchIcon" src="'+chrome.runtime.getURL("/images/injected/search-icon.png")+'"/></div><div class="hv-vid-select-note" tool-tip ="'+st.videoSelectNote+'"><img src="'+chrome.extension.getURL("/images/extension/icon-info-grey.svg")+'"/></div></div></div>',emptyVideoListingContainer:'<div class="empty-vid-list-container library-empty-message"><div class="no-lib-ele-found">'+st.noVideosFound+'</div><div class="empty-vid-list-action"></div></div>',libraryLoading:'<div class="video-lib-loading library-loading"><div class="pop-loading"><div></div><div></div><div></div><div></div></div></div>',videoLandingPageLib:'<div class="lib-menu-item selectable-menu-item" library-type="video-page-library">'+st.videoPages+"</div>",libraryVideoListingContainer:'<div class="lib-vid-list-container library-list-container hv-custom-scroll"></div>',libVideoElement:'<div class="lib-video-container library-container"><div class="img-container"><div class="inner-image-container"><img crossorigin="anonymous"></div><span class="duration"></span></div><div class="title"></div></div>',personalizedTagEle:'<span class="personalisation-tag">'+st.personalized+"</span>",loadMoreVideos:'<div class="load-more-videos"><div id="hvLoadMoreVideosBtn" class="gradient-btn"><span>LOAD MORE</span></div></div>',recordPreviewScreen:'<div class="create-video-content record-preview-screen"></div>',recordPreview:'<div class="inner-container"><div class="left-container"><div class="vid-preview-container"><div class="webcam-container"><iframe allow="microphone; camera"></iframe></div></div><div class="start-recording-btn"><div id="hvStartWebcamRecBtn" class="gradient-btn"><span>START RECORDING</span></div></div></div><div class="right-container"><div class="record-option" data-action="screen_record"><div class="record-option-container"><div class="title">'+st.recordScreen.screenRecTitle+'</div><div class="desc">'+st.recordScreen.screenRecDesc+'</div><div class="desc pro-tip">'+st.recordScreen.proTip+": "+st.recordScreen.screenRecProTip+'</div><div class="action-text"><img src="'+chrome.extension.getURL("/images/injected/settings.svg")+'"><span>'+st.recordScreen.screenRecActionText+'</span></div></div></div><div class="record-option" data-action="library"><div class="record-option-container"><div class="title">'+st.recordScreen.libraryTitle+'</div><div class="desc">'+st.recordScreen.libraryDesc+'</div><div class="desc pro-tip">'+st.recordScreen.proTip+": "+st.recordScreen.libraryProtip+'</div><div class="action-text"><span>'+st.recordScreen.libraryActionText+"</span></div></div></div></div></div>",importVideoScreen:'<div class="create-video-content import-video-screen"></div>',importMenu:'<div class="import-menu selectable-menu"><div class="import-menu-item selectable-menu-item" import-type="local">'+st.importFromLocal+'</div><div class="import-menu-item selectable-menu-item" import-type="gdrive">'+st.importFromGDrive+'</div><div class="import-menu-back-options selectable-menu-options"><div class="import-menu-back-option selectable-menu-option" option-type="record-video"><span>'+st.recordVideo+'</span></div><div class="import-menu-back-option selectable-menu-option" option-type="library"><span>'+st.chooseFromLibrary+"</span></div></div></div>",importVideoContentScreen:'<div class="import-video-content-container"></div>',buttonEle:'<div class="pop-btn-ele"><span></span></div>',proEditNotAllowedScreen:'<div class="create-video-content edit-not-allowed-screen"><div class="empty-container"><div class="text">'+st.editNotAllowed+'</div><div class="goto-pro-edit-btn gradient-btn"><span>'+st.goToProEdit+"</span></div></div></div>",localImportScreen:'<div class="import-video-content local-import"><div class="drag-drop-container" id="hvFileDragDropContainer"><div class="img-container"><img src="'+chrome.extension.getURL("/images/injected/upload.svg")+'"></div><div class="text-container"><span class="highlighted-text">'+st.dragAndDrop+"</span> "+st.yourFilesHere+'<span class="link-text">'+st.browse+'</span><input type="file" id="hvImportFileUpload" name="hvfiles" accept="video/quicktime, video/mp4, video/x-flv, video/*, "></div></div></div>',gdriveImportScreen:'<div class="import-video-content gdrive-import"><div class="gdrive-import-content wf-account-access-screen"><div class="wf-account-access-container"><div class="img-container"><img src="'+chrome.extension.getURL("/images/injected/drive.png")+'"></div><div class="text-container">'+st.gdriveAccessTxt+'</div><div class="btn-container"><span id="hvGdriveImportAccessBtn">'+st.grantAccess+'</span></div></div></div><div class="gdrive-import-content gdrive-container"><div class="gdrive-accounts"><div class="text">'+st.account+'</div><div class="select-container"><select id="gdriveVidImportAccountSelect"></select></div></div><div class="gdrive-videos"><div class="gdrive-vid-loading"><div class="library-loading"><div class="pop-loading"><div></div><div></div><div></div><div></div></div></div></div><div class="gdrive-empty-videos-message library-empty-message"><div>'+st.noVideosFound+'</div></div><div class="gdrive-vid-lib-container library-list-container"></div></div></div></div>',hvTemplateMfForm:'<div class="hv-template-mf-form"></div>',hvTemplateMfFormContent:'<div class="hv-template-mf-form-content"><div class="hv-template-mf-form-desc"></div><div class="hv-template-mf-form-input-container"></div><div class="hv-template-mf-form-footer"><div class="footer-save-btn" data-tooltip="Save" id="templateMfSaveBtn"><span>{insertText}</span></div><div class="footer-cancel-btn" data-tooltip="Cancel" id="templateMfCancelBtn"><span>'+st.cancel+"</span></div></div></div>",hvTemplateMfFormInputEle:'<div class="hv-template-mf-form-input-ele"><div class="input-label"></div><div class="input-ele"><input></input></div></div>',libraryViewScreen:'<div class="create-video-content library-view"></div>',createSalesPage:'<div class="create-sales-page-btn"><div><span>+</span></div><span>'+st.createSalesPage+"</span></div>",hvMfSelection:'<div class="hv-mf-selection-form"></div>',hvMfSelectionContent:'<div class="hv-mf-selection-form-content"><div><div class="hv-mf-selection-title">'+st.userType+'</div><div class="hv-mf-selection-options"><div class="hv-selection-dropdown"><span value="" id="hvMfTypeSelected">Select the user type</span><svg class="hv-dropdown-arrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><path fill="" d="M24.707 38.101L4.908 57.899c-4.686 4.686-4.686 12.284 0 16.971L185.607 256 4.908 437.13c-4.686 4.686-4.686 12.284 0 16.971L24.707 473.9c4.686 4.686 12.284 4.686 16.971 0l209.414-209.414c4.686-4.686 4.686-12.284 0-16.971L41.678 38.101c-4.687-4.687-12.285-4.687-16.971 0z"></path></svg><div class="hv-selection-dropdowm-list"><span class="hv-selection-dropdown-option" value="leads">Leads</span><span class="hv-selection-dropdown-option" value="contacts">Contacts</span></div></div><div hv-mf-selection-tooltip = "'+st.mfSelectionTooltip+'" class="hv-selection-tooltip"><img src="'+chrome.extension.getURL("/images/extension/how-tip.png")+'"/></div></div></div><div class="hv-mf-selection-footer"><div class="footer-save-btn" data-tooltip="Save" id="mfSelectionSaveBtn"><span>{insertText}</span></div><div class="footer-cancel-btn" data-tooltip="Cancel" id="templateMfCancelBtn"><span>'+st.cancel+"</span></div></div></div>"};ot.port.onMessage.addListener(function(e,t,r){if(e){var d=e.backgroundRecordingMessage,s=e.data||{};if("authcheckResponse"==d&&s&&s.response&&s.response.feature_params&&!s.response.feature_params.mirror_video&&(void 0!=nt?nt.isMirrorWebCam=!0:(nt={},nt.isMirrorWebCam=!0),at=n(at,"isMirrorWebCam",!0),chrome.storage.sync.get(["userPreferences","recordingDefaults"],function(e){var t=e.userPreferences;void 0==t&&(t={}),t.isMirrorWebCam=!0,chrome.storage.sync.set({userPreferences:t},function(){})})),"user_recording_preferences"==d&&(void 0==s.preference&&s.preference=={}||(nt=s.preference)&&(nt.webcamSource&&(at=n(at,"webcamDeviceId",nt.webcamSource)),nt.audioSource&&(at=n(at,"audioDeviceId",nt.audioSource)),void 0!=nt.isMirrorWebCam&&(at=n(at,"isMirrorWebCam",nt.isMirrorWebCam)))),"updated_user_preferences"==d&&(void 0==s.recordConfiguration&&s.recordConfiguration=={}||(nt=s.recordConfiguration,nt.webcamSource&&(at=n(at,"webcamDeviceId",nt.webcamSource)),nt.audioSource&&(at=n(at,"audioDeviceId",nt.audioSource)),void 0!=nt.isMirrorWebCam&&(at=n(at,"isMirrorWebCam",nt.isMirrorWebCam)))),e.popupTabId==ot.tabId){if("currentstate"==d){o(!(!s.isRecording&&!s.isPaused))}if("recording_cancelled"==d&&(o(!1),$("#"+s.workflowPopId).find(".hv-wf-pop-body .hv-wf-pop-loading").fadeOut(10)),"record_aborted"==d&&s&&s.initiator==ot.serviceName&&(o(!1),$("#"+s.recordConfiguration.workflowPopId).find(".hv-create-video-container").find(".vid-preview-container iframe").removeAttr("src"),$("#"+s.recordConfiguration.workflowPopId).find(".hv-wf-pop-body .hv-wf-pop-loading").fadeOut(10)),"stopped_recording"==d){if(s&&s.initiator==ot.serviceName){var c=s.recordConfiguration.workflowPopId;$("#"+c).find(".hv-wf-pop-body .hv-wf-pop-loading").fadeOut(10);var p=$("#"+c).data("workflowConfig");p.recordConfiguration=s.recordConfiguration,p.assetContent.assetId=s.recordConfiguration.assetId,$("#"+c).find(".hv-create-video-container").find(".vid-preview-container iframe").removeAttr("src"),_(p.popId),We(p),h(p)}messageEmbeddedFrame("show_dynamic_integ_loading",{}),o(!1)}if("preprocess_complete"==d){var l=s.workflowPopId;$("#"+l).find(".hv-wf-pop-body .hv-wf-pop-loading").fadeOut(10);var v=$("#"+l).data("workflowConfig");if(v.recordConfiguration&&v.assetContent.assetId){v.recordConfiguration.projectJson=s.projectJson;w(v,!0,{project_json:s.projectJson,record_configuration:v.recordConfiguration}),We(v)}$("#"+l).find(".hv-create-video-container").find(".vid-preview-container iframe").removeAttr("src")}d=="bothstarted-"+ot.serviceName&&(o(!0),i(),$("#"+s.workflowPopId).hide())}if(Oe(s)){if("handleTopMenuClick"==d&&s.menuClickMetadata.previousSelection==ot.screenName&&Ue(s.popId,s.menuClickMetadata),"popScreenSwitch"==d&&s.screenName==ot.screenName&&(je(s),u(s)),"fetchVideosResponse"==d&&Se(s),"fetchPagesResponse"==d)if($("#"+s.popId).find(".hv-wf-pop-body .hv-wf-pop-loading").fadeOut(10),s.status){var p=$("#"+s.popId).data("workflowConfig");void 0==p.assetContent.orgTok?chrome.storage.sync.get(["orgToken"],function(e){p.assetContent.orgTok=e.orgToken,We(p),Me(s)}):Me(s)}else Je(s.popId,st.wentWrong,"error");if("fetchVideoCategoriesResponse"==d&&(s.status?W(s):Je(s.popId,st.wentWrong,"error")),"fetchSearchVideosResponse"==d&&(s.status?(Se(s),$("#"+s.popId).find(".hv-wf-pop-body .hv-wf-pop-loading").fadeOut(10)):Je(s.popId,st.wentWrong,"error")),"videoDetailsResponse"==d)if(s.status&&s.response.status){var f=s.workflowConfig.assetContent;f.videoTitle=s.response.title,f.deliveryToken=s.response.token,f.isPersonalized=s.response.is_personalized,f.customerHost=s.response.customer_host,f.isPage=!1,f.urlParam="/video/play/",f.thumbnailParam="/video/thumbnail/",h(s.workflowConfig),We(s.workflowConfig),a(s.response,s.workflowConfig,s.isNewVideo,s.optionalData)}else Je(s.workflowConfig.popId,st.wentWrong,"error"),$("#"+s.workflowConfig.popId).find(".hv-wf-pop-body .hv-wf-pop-loading").fadeOut(10);if("fetchGdriveAccountsResponse"==d&&s.screenName===ot.screenName&&($("#"+s.popId).find(".hv-wf-pop-body .hv-wf-pop-loading").fadeOut(10),s.status?Q(s.popId,s.response):Je(s.popId,st.wentWrong,"error")),"listDriveFilesResponse"==d&&s.screenName===ot.screenName&&(s.status?Y(s):($("#"+s.popId).find(".import-video-screen .gdrive-import").find(".gdrive-vid-loading").hide(),Je(s.popId,st.wentWrong,"error"))),"googleAccessResponse"==d&&s.screenName===ot.screenName&&(s.status?"drive"===s.service&&X(s.popId,s.authcode):($("#"+s.popId).find(".hv-wf-pop-body .hv-wf-pop-loading").fadeOut(10),Je(s.popId,st.wentWrong,"error"))),"configureGDriveAccountResponse"==d&&s.screenName==ot.screenName&&(s.status?J(s.popId):($("#"+s.popId).find(".hv-wf-pop-body .hv-wf-pop-loading").fadeOut(10),Je(s.popId,st.wentWrong,"error"))),"fetchMergeFieldsResponse"===d&&s.screenName==ot.screenName){var g=s.workflowConfig;if(s.status){g.assetContent.mfInVideo=s.response.merge_fields||[],We(g);var m=$("#"+g.popId).find(".hv-wf-topbar .tp-selected");$(m).hasClass("hv-edit-video")?$("#"+g.popId).find("#editInsertVideoBtn span").click():$("#"+g.popId).find("#libraryInsertVideoBtn span").click()}else $("#"+g.popId).find(".hv-wf-pop-body .hv-wf-pop-loading").fadeOut(10),Je(g.popId,st.wentWrong,"error")}if("fetchPageComponentDataResponse"===d&&s.screenName==ot.screenName){s.response.loadMore=s.loadMore;var p=$("#"+s.popId).data("workflowConfig");void 0==p.assetContent.orgTok?chrome.storage.sync.get(["orgToken"],function(e){p.assetContent.orgTok=e.orgToken,We(p),D(s.response,s.popId)}):D(s.response,s.popId)}"fetchThumbnailsResponse"===d&&s.screenName==ot.screenName&&P(s.status,s.popId,s.response,s.assetId),"switchThumbnailResponse"===d&&s.screenName==ot.screenName&&M(s),"vbgApplied"===d&&($("#"+s.workflowPopId).find("#virtual-bg-sidebar").hide(),ve(s.workflowPopId,s.vbgThumbURL)),"closeVBGSidebar"===d&&$("#"+s.workflowPopId).find("#virtual-bg-sidebar").hide()}}})}));