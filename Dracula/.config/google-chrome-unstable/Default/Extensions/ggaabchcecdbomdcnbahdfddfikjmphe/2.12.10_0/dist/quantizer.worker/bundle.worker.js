(()=>{var t={625:function(t){(function(){function i(t){if(t=t||{},this.method=t.method||2,this.colors=t.colors||256,this.initColors=t.initColors||4096,this.initDist=t.initDist||.01,this.distIncr=t.distIncr||.005,this.hueGroups=t.hueGroups||10,this.satGroups=t.satGroups||10,this.lumGroups=t.lumGroups||10,this.minHueCols=t.minHueCols||0,this.hueStats=this.minHueCols?new r(this.hueGroups,this.minHueCols):null,this.boxSize=t.boxSize||[64,64],this.boxPxls=t.boxPxls||2,this.palLocked=!1,this.dithKern=t.dithKern||null,this.dithSerp=t.dithSerp||!1,this.dithDelta=t.dithDelta||0,this.histogram={},this.idxrgb=t.palette?t.palette.slice(0):[],this.idxi32=[],this.i32idx={},this.i32rgb={},this.useCache=!1!==t.useCache,this.cacheFreq=t.cacheFreq||10,this.reIndex=t.reIndex||0==this.idxrgb.length,this.colorDist="manhattan"==t.colorDist?u:o,this.idxrgb.length>0){var i=this;this.idxrgb.forEach((function(t,r){var e=(255<<24|t[2]<<16|t[1]<<8|t[0])>>>0;i.idxi32[r]=e,i.i32idx[e]=r,i.i32rgb[e]=t}))}}function r(t,i){this.numGroups=t,this.minCols=i,this.stats={};for(var r=-1;r<t;r++)this.stats[r]={num:0,cols:[]};this.groupsFull=0}i.prototype.sample=function(t,i){if(this.palLocked)throw"Cannot sample additional images, palette already assembled.";var r=g(t,i);switch(this.method){case 1:this.colorStats1D(r.buf32);break;case 2:this.colorStats2D(r.buf32,r.width)}},i.prototype.reduce=function(t,i,r,e){if(this.palLocked||this.buildPal(),r=r||this.dithKern,e=void 0!==e?e:this.dithSerp,i=i||1,r)var s=this.dither(t,r,e);else for(var n=g(t).buf32,h=n.length,a=(s=new Uint32Array(h),0);a<h;a++){var o=n[a];s[a]=this.nearestColor(o)}if(1==i)return new Uint8Array(s.buffer);if(2==i){var u=[];for(h=s.length,a=0;a<h;a++)o=s[a],u[a]=this.i32idx[o];return u}},i.prototype.dither=function(t,i,r){var e={FloydSteinberg:[[7/16,1,0],[3/16,-1,1],[5/16,0,1],[1/16,1,1]],FalseFloydSteinberg:[[3/8,1,0],[3/8,0,1],[2/8,1,1]],Stucki:[[8/42,1,0],[4/42,2,0],[2/42,-2,1],[4/42,-1,1],[8/42,0,1],[4/42,1,1],[2/42,2,1],[1/42,-2,2],[2/42,-1,2],[4/42,0,2],[2/42,1,2],[1/42,2,2]],Atkinson:[[1/8,1,0],[1/8,2,0],[1/8,-1,1],[1/8,0,1],[1/8,1,1],[1/8,0,2]],Jarvis:[[7/48,1,0],[5/48,2,0],[3/48,-2,1],[5/48,-1,1],[7/48,0,1],[5/48,1,1],[3/48,2,1],[1/48,-2,2],[3/48,-1,2],[5/48,0,2],[3/48,1,2],[1/48,2,2]],Burkes:[[.25,1,0],[4/32,2,0],[2/32,-2,1],[4/32,-1,1],[.25,0,1],[4/32,1,1],[2/32,2,1]],Sierra:[[5/32,1,0],[3/32,2,0],[2/32,-2,1],[4/32,-1,1],[5/32,0,1],[4/32,1,1],[2/32,2,1],[2/32,-1,2],[3/32,0,2],[2/32,1,2]],TwoSierra:[[.25,1,0],[3/16,2,0],[1/16,-2,1],[2/16,-1,1],[3/16,0,1],[2/16,1,1],[1/16,2,1]],SierraLite:[[.5,1,0],[1/4,-1,1],[1/4,0,1]]};if(!i||!e[i])throw"Unknown dithering kernel: "+i;for(var s=e[i],n=g(t),h=n.buf32,a=n.width,o=n.height,u=(h.length,r?-1:1),c=0;c<o;c++){r&&(u*=-1);for(var l=c*a,f=1==u?0:a-1,d=1==u?a:0;f!==d;f+=u){var p=l+f,x=h[p],b=255&x,v=(65280&x)>>8,m=(16711680&x)>>16,y=this.nearestColor(x),w=255&y,S=(65280&y)>>8,C=(16711680&y)>>16;if(h[p]=255<<24|C<<16|S<<8|w,!(this.dithDelta&&this.colorDist([b,v,m],[w,S,C])<this.dithDelta))for(var O=b-w,P=v-S,D=m-C,j=1==u?0:s.length-1,k=1==u?s.length:0;j!==k;j+=u){var A=s[j][1]*u,M=s[j][2],I=M*a;if(A+f>=0&&A+f<a&&M+c>=0&&M+c<o){var U=s[j][0],F=p+(I+A),G=255&h[F],E=(65280&h[F])>>8,H=(16711680&h[F])>>16,q=Math.max(0,Math.min(255,G+O*U)),L=Math.max(0,Math.min(255,E+P*U)),z=Math.max(0,Math.min(255,H+D*U));h[F]=255<<24|z<<16|L<<8|q}}}}return h},i.prototype.buildPal=function(t){if(!(this.palLocked||this.idxrgb.length>0&&this.idxrgb.length<=this.colors)){var i=this.histogram,r=function(t,i){var r=[];for(var e in t)r.push(e);return p.call(r,(function(i,r){return t[r]-t[i]}))}(i);if(0==r.length)throw"Nothing has been sampled, palette cannot be built.";switch(this.method){case 1:for(var e=this.initColors,s=i[r[e-1]],n=r.slice(0,e),h=e,a=r.length;h<a&&i[r[h]]==s;)n.push(r[h++]);this.hueStats&&this.hueStats.inject(n);break;case 2:n=r}n=n.map((function(t){return+t})),this.reducePal(n),!t&&this.reIndex&&this.sortPal(),this.useCache&&this.cacheHistogram(n),this.palLocked=!0}},i.prototype.palette=function(t,i){return this.buildPal(i),t?this.idxrgb:new Uint8Array(new Uint32Array(this.idxi32).buffer)},i.prototype.prunePal=function(t){for(var i,r=0;r<this.idxrgb.length;r++)t[r]||(i=this.idxi32[r],this.idxrgb[r]=null,this.idxi32[r]=null,delete this.i32idx[i]);if(this.reIndex){for(var e=[],s=[],n={},h=(r=0,0);r<this.idxrgb.length;r++)this.idxrgb[r]&&(i=this.idxi32[r],e[h]=this.idxrgb[r],n[i]=h,s[h]=i,h++);this.idxrgb=e,this.idxi32=s,this.i32idx=n}},i.prototype.reducePal=function(t){if(this.idxrgb.length>this.colors){for(var i,r=t.length,e={},s=0,n=!1,h=0;h<r;h++)s!=this.colors||n||(this.prunePal(e),n=!0),i=this.nearestIndex(t[h]),s<this.colors&&!e[i]&&(e[i]=!0,s++);n||(this.prunePal(e),n=!0)}else{var a=t.map((function(t){return[255&t,(65280&t)>>8,(16711680&t)>>16]})),o=r=a.length,u=this.initDist;if(o>this.colors){for(;o>this.colors;){var c=[];for(h=0;h<r;h++){var l=a[h];if(t[h],l)for(var f=h+1;f<r;f++){var d=a[f],g=t[f];if(d){var x=this.colorDist(l,d);x<u&&(c.push([f,d,g,x]),delete a[f],o--)}}}u+=o>3*this.colors?this.initDist:this.distIncr}if(o<this.colors){p.call(c,(function(t,i){return i[3]-t[3]}));for(var b=0;o<this.colors;)a[c[b][0]]=c[b][1],o++,b++}}for(r=a.length,h=0;h<r;h++)a[h]&&(this.idxrgb.push(a[h]),this.idxi32.push(t[h]),this.i32idx[t[h]]=this.idxi32.length-1,this.i32rgb[t[h]]=a[h])}},i.prototype.colorStats1D=function(t){for(var i,r=this.histogram,e=t.length,s=0;s<e;s++)(4278190080&(i=t[s]))>>24!=0&&(this.hueStats&&this.hueStats.check(i),i in r?r[i]++:r[i]=1)},i.prototype.colorStats2D=function(t,i){var r=this.boxSize[0],e=this.boxSize[1],s=r*e,n=function(t,i,r,e){for(var s=t%r,n=i%e,h=t-s,a=i-n,o=[],u=0;u<i;u+=e)for(var c=0;c<t;c+=r)o.push({x:c,y:u,w:c==h?s:r,h:u==a?n:e});return o}(i,t.length/i,r,e),h=this.histogram,a=this;n.forEach((function(r){var e,n=Math.max(Math.round(r.w*r.h/s)*a.boxPxls,2),o={};!function(t,i,r){var e=t,s=e.y*i+e.x,n=(e.y+e.h-1)*i+(e.x+e.w-1),h=0,a=i-e.w+1,o=s;do{r.call(this,o),o+=++h%e.w==0?a:1}while(o<=n)}(r,i,(function(i){(4278190080&(e=t[i]))>>24!=0&&(a.hueStats&&a.hueStats.check(e),e in h?h[e]++:e in o?++o[e]>=n&&(h[e]=o[e]):o[e]=1)}))})),this.hueStats&&this.hueStats.inject(h)},i.prototype.sortPal=function(){var t=this;this.idxi32.sort((function(i,r){var e=t.i32idx[i],s=t.i32idx[r],n=t.idxrgb[e],h=t.idxrgb[s],a=c(n[0],n[1],n[2]),o=c(h[0],h[1],h[2]),u=n[0]==n[1]&&n[1]==n[2]?-1:l(a.h,t.hueGroups),f=(h[0]==h[1]&&h[1]==h[2]?-1:l(o.h,t.hueGroups))-u;if(f)return-f;var d=+o.l.toFixed(2)-+a.l.toFixed(2);if(d)return-d;var p=+o.s.toFixed(2)-+a.s.toFixed(2);return p?-p:void 0})),this.idxi32.forEach((function(i,r){t.idxrgb[r]=t.i32rgb[i],t.i32idx[i]=r}))},i.prototype.nearestColor=function(t){var i=this.nearestIndex(t);return null===i?0:this.idxi32[i]},i.prototype.nearestIndex=function(t){if((4278190080&t)>>24==0)return null;if(this.useCache&&""+t in this.i32idx)return this.i32idx[t];for(var i,r=1e3,e=[255&t,(65280&t)>>8,(16711680&t)>>16],s=this.idxrgb.length,n=0;n<s;n++)if(this.idxrgb[n]){var h=this.colorDist(e,this.idxrgb[n]);h<r&&(r=h,i=n)}return i},i.prototype.cacheHistogram=function(t){for(var i=0,r=t[i];i<t.length&&this.histogram[r]>=this.cacheFreq;r=t[i++])this.i32idx[r]=this.nearestIndex(r)},r.prototype.check=function(t){this.groupsFull==this.numGroups+1&&(this.check=function(){});var i=255&t,r=(65280&t)>>8,e=(16711680&t)>>16,s=i==r&&r==e?-1:l(c(i,r,e).h,this.numGroups),n=this.stats[s],h=this.minCols;n.num++,n.num>h||(n.num==h&&this.groupsFull++,n.num<=h&&this.stats[s].cols.push(t))},r.prototype.inject=function(t){for(var i=-1;i<this.numGroups;i++)if(this.stats[i].num<=this.minCols)switch(f(t)){case"Array":this.stats[i].cols.forEach((function(i){-1==t.indexOf(i)&&t.push(i)}));break;case"Object":this.stats[i].cols.forEach((function(i){t[i]?t[i]++:t[i]=1}))}};var e=.2126,s=.7152,n=.0722;function h(t,i,r){return Math.sqrt(e*t*t+s*i*i+n*r*r)}var a=Math.sqrt(65025);function o(t,i){var r=i[0]-t[0],h=i[1]-t[1],o=i[2]-t[2];return Math.sqrt(e*r*r+s*h*h+n*o*o)/a}function u(t,i){var r=Math.abs(i[0]-t[0]),h=Math.abs(i[1]-t[1]),a=Math.abs(i[2]-t[2]);return(e*r+s*h+n*a)/254.99999999999997}function c(t,i,r){var e,s,n,a,o;if(t/=255,i/=255,r/=255,(e=Math.max(t,i,r))==(s=Math.min(t,i,r)))n=a=0;else{switch(o=e-s,a=(e+s)/2>.5?o/(2-e-s):o/(e+s),e){case t:n=(i-r)/o+(i<r?6:0);break;case i:n=(r-t)/o+2;break;case r:n=(t-i)/o+4}n/=6}return{h:n,s:a,l:h(t,i,r)}}function l(t,i){var r=1/i,e=r/2;if(t>=1-e||t<=e)return 0;for(var s=1;s<i;s++){var n=s*r;if(t>=n-e&&t<=n+e)return s}}function f(t){return Object.prototype.toString.call(t).slice(8,-1)}var d,p="xyzvwtursopqmnklhijfgdeabc"==(d="abcdefghijklmnopqrstuvwxyz").split("").sort((function(t,i){return~~(d.indexOf(i)/2.3)-~~(d.indexOf(t)/2.3)})).join("")?Array.prototype.sort:function(t){var i=f(this[0]);if("Number"==i||"String"==i){for(var r,e={},s=this.length,n=0;n<s;n++)r=this[n],e[r]||0===e[r]||(e[r]=n);return this.sort((function(i,r){return t(i,r)||e[i]-e[r]}))}return e=this.map((function(t){return t})),this.sort((function(i,r){return t(i,r)||e.indexOf(i)-e.indexOf(r)}))};function g(t,i){var r,e,s,n,h,a;switch(f(t)){case"HTMLImageElement":(r=document.createElement("canvas")).width=t.naturalWidth,r.height=t.naturalHeight,(e=r.getContext("2d")).drawImage(t,0,0);case"Canvas":case"HTMLCanvasElement":r=r||t,e=e||r.getContext("2d");case"CanvasRenderingContext2D":e=e||t,r=r||e.canvas,s=e.getImageData(0,0,r.width,r.height);case"ImageData":i=(s=s||t).width,n="CanvasPixelArray"==f(s.data)?new Uint8Array(s.data):s.data;case"Array":case"CanvasPixelArray":n=n||new Uint8Array(t);case"Uint8Array":case"Uint8ClampedArray":n=n||t,h=new Uint32Array(n.buffer);case"Uint32Array":h=h||t,n=n||new Uint8Array(h.buffer),i=i||h.length,a=h.length/i}return{can:r,ctx:e,imgd:s,buf8:n,buf32:h,width:i,height:a}}this.RgbQuant=i,t.exports&&(t.exports=i)}).call(this)}},i={};function r(e){var s=i[e];if(void 0!==s)return s.exports;var n=i[e]={exports:{}};return t[e].call(n.exports,n,n.exports,r),n.exports}r.n=t=>{var i=t&&t.__esModule?()=>t.default:()=>t;return r.d(i,{a:i}),i},r.d=(t,i)=>{for(var e in i)r.o(i,e)&&!r.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:i[e]})},r.o=(t,i)=>Object.prototype.hasOwnProperty.call(t,i),(()=>{"use strict";var t=r(625),i=r.n(t);function e(t,i){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);i&&(e=e.filter((function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable}))),r.push.apply(r,e)}return r}function s(t){for(var i=1;i<arguments.length;i++){var r=null!=arguments[i]?arguments[i]:{};i%2?e(Object(r),!0).forEach((function(i){n(t,i,r[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):e(Object(r)).forEach((function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))}))}return t}function n(t,i,r){return i in t?Object.defineProperty(t,i,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[i]=r,t}let h={colors:256,method:2,boxSize:[64,64],boxPxls:2,initColors:4096,minHueCols:0,dithKern:null,dithDelta:0,dithSerp:!0,palette:[],reIndex:!1,useCache:!0,cacheFreq:10,colorDist:"manhattan"};function a(t,r,e,n){const a=r<64||e<64?1:2,o=new(i())(s(s({},h),{},{method:a}));o.sample(t,r);const u=o.palette(),c=o.reduce(t,2,n);return{data:new Uint8Array(c),palette:u}}let o=[],u={dithKern:null};self.onmessage=t=>{self.onmessage=({data:t})=>function(t){for(t&&o.push(t);t=o.pop();){const i=new Uint8Array(t.buffer),{palette:r,data:e}=a(i,t.width,t.height,u.dithKern),s=t.width*t.height,n=r.length,h=new ArrayBuffer(n+s),o=new Uint8Array(h);o.set(r),o.set(e,n),self.postMessage({paletteLength:n,buffer:h},{transfer:[h]})}}(t),u={...u,...t.data}}})()})();